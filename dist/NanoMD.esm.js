!function(){const t=window,e=document,i=String,n=Boolean,s=Array,o=Object,l=JSON,r=Math,h=URL,u=Node,c=Date,a=Blob,d=parseInt,f="video/mp4",p="video/quicktime",_=["javascript","js","ts","html","css","xml","json","sql","java","python","ruby","php","cpp","csharp","swift","typescript","kotlin","go","rust","perl","bash"],y=t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)").matches,g="abcdefghijklmnopqrstuvwxyz0123456789";let m=new Map;const T=/\.([\w_-]+)?/gi,E=/\#([\w_-]+)?/i,O=/^\w+(?=[\#\.]*)/i,A=/[\"\']{0,1}([\u0020\u00A0\u0009]*)(mailto\:)?([\u0020\u00A0\u0009]*)(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)([\u0020\u00A0\u0009]*)[\"\']{0,1}/,N=/(\s{1})\\?[\#＃]{1}([\u4e00-\u9fff\u3040-\u30ff\uac00-\ud7a3a-zA-Z0-9_]+)/,C=/[& \<\>\"\']/g,w=/\[([^\]\n]+)?\]\(([^\)\n\u0020\u00A0\u0009]+)([\u0020\u00A0\u0009]*[\"\']([^\)\n]+)[\"\'])?\)/,S=/(\n)(\>\s*\[\!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]\n)?(\>[^\n]*(\n)?)+/,$=/\`([^\n\`]*)\`/,b=/^\n|\n$/g,I=/\`{3}(\w*)([\s\S]*?)\s*\`{3}/,D=/((\n([\u0020\u00A0]{4,}|[\u0009]))[^\n]+)+/,R=/\*([^\n\*]*)\*/,F=/\_([^\n\_]*)\_/,U=/^\s|\s$/g,k=/(\n[\u0020\u00A0\u0009]*|\n[\u0020\u00A0\u0009]*>[\u0020\u00A0\u0009]*|\n[\u0020\u00A0\u0009]*([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+)\\?(\#{1,6})[\u0020\u00A0\u0009]+([^\n]+)/,v=/(\n)([^\n]+)\n\={3,}([\u0020\u00A0\u0009]*\n)/,x=/(\n)([^\n]+)\n\-{3,}([\u0020\u00A0\u0009]*\n)/,P=/([\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*)\\?(\#{1,6})[\u0020\u00A0\u0009]+([^\n\|]*)([\u0020\u00A0\u0009]*)/,L=/(\n[\u0020\u00A0\u0009]*)(\*{3,}|\-{3,})([\u0020\u00A0\u0009]*\n)/,M=/\!\[([^\]\n]+)?\]\(([^\)\n\u0020\u00A0\u0009]+)([\u0020\u00A0\u0009]*[\"\']([^\)\n]+)[\"\'])?\)(\(([0-9]+\%?)?[\u0020\u00A0\u0009\*x]+([0-9]+\%?)?([\u0020\u00A0\u0009]+(left|right))?\))?/,H=/^['"].*['"]$/,G=/\n(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+(.+)(\n.*\S.*)*)+/,K=/(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+(.+)(\n.*\S.*)*)+/,B=/^(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]*[^\n]+)/,j=/\={2}([^\n\=]*)\={2}/,V=/\~{2}([^\n\~]*)\~{2}/,W=/\*{2}([^\n\*]*)\*{2}/,q=/\_{2}([^\n\_]*)\_{2}/,z=/\~([^\n\~]*)\~/,Y=/\^([^\n\^]*)\^/,Z=/(\n(?![\{\<])[^\n]+)+/,X=/^(\n?(?![\{\<])[^\n]+)+/,J=/\.mov$/,Q=/\.mp4$/,tt=/[A-Za-z\%]/,et=/[\"\']{0,1}([\u0020\u00A0\u0009]*)(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))([\u0020\u00A0\u0009]*)[\"\']{0,1}/,it=/(\<[\u00A0\u0020\u0009\>]*\/?[\u00A0\u0020\u0009\>]*br[\u00A0\u0020\u0009\>]*\/?[\u00A0\u0020\u0009\>]*\>|\n)/,nt=/\n/,st=/\\\!/g,ot=/\\\`/g,lt=/\\\#/g,rt=/\\\*/g,ht=/\\\_/g,ut=/\\\~/g,ct=/\\\^/g,at=/\\\=/g,dt=/\\\</g,ft=/\\\>/g,pt=/\\\[/g,_t=/\\\]/g,yt=/\\\(/g,gt=/\\\)/g,mt=/\$/g,Tt=/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?/,Et="mailto:",Ot="\n",At="_blank",Nt="startsWith",Ct="keys",wt="TEXT_NODE",St="ELEMENT_NODE",$t="nodeType",bt="add",It="alt",Dt="appendChild",Rt="as",Ft="auto",Ut="baseOffset",kt="blockquote",vt="body",xt="br",Pt="button",Lt="charAt",Mt="checked",Ht="checkbox",Gt="childNodes",Kt="children",Bt="class",jt="clearTimeout",Vt="clipboardData",Wt="code",qt="Color",zt="color",Yt="content",Zt="contentEditable",Xt="controls",Jt="copy",Qt="create",te="Creator",ee="ctrlKey",ie="dark",ne="dataset",se="delay",oe="display",le="div",re="editor",he="em",ue="empty",ce="emptyContent",ae="error",de="float",fe="floor",pe="focus",_e="fontFamily",ye="forEach",ge="from",me="get",Te="has",Ee="head",Oe="height",Ae="hide",Ne="href",Ce="id",we="iframe",Se="img",$e="index",be="init",Ie="inner",De="input",Re="insert",Fe="isArray",Ue="join",ke="label",ve="language",xe="lastChild",Pe="lazy",Le="length",Me="li",He="light",Ge="link",Ke="list",Be="loading",je="map",Ve="mark",We="match",qe="metaKey",ze="min",Ye="mode",Ze="Name",Xe="name",Je="node",Qe="none",ti="number",ei="object",ii="offset",ni="ol",si="outerHTML",oi="parent",li="pd-md-editor",ri="pd-md-viewer",hi="placeholder",ui="pre",ci="props",ai="preload",di="prettyprint",fi="prevent",pi="push",_i="px",yi="querySelector",gi="random",mi="rel",Ti="remove",Ei="replace",Oi="click",Ai="script",Ni="scroll",Ci="section",wi="set",Si="slice",$i="source",bi="span",Ii="split",Di="src",Ri="string",Fi="strong",Ui="style",ki="sub",vi="success",xi="sup",Pi="table",Li="tag",Mi="target",Hi="tbody",Gi="td",Ki="temp",Bi="test",ji="textContent",Vi="th",Wi="thead",qi="title",zi="toLowerCase",Yi="toUpperCase",Zi="tr",Xi="trim",Ji="type",Qi="ul",tn="value",en="video",nn="viewer",sn="width",on="console",ln="apply",rn="void",hn="vdom",un="getElementById",cn="crossOrigin",an="preconnect",dn=bt+"EventListener",fn="background"+qt,pn=Bt+Ze,_n=Bt+"List",yn=Qt+"DocumentFragment",gn=Qt+"Element",mn=Qt+"TextNode",Tn=ge+"CharCode",En=pe+"Background"+qt,On=pe+"Offset",An=pe+"Text"+qt,Nn=me+"Data",Cn=me+"Selection",wn=Te+"OwnProperty",Sn=$e+"Of",$n=Ie+"HTML",bn=Ie+"Text",In=Re+"Before",Dn=Je+Ze,Rn=Je+"Value",Fn="onclick",Un="onwheel",kn=oi+"Element",vn=oi+"Node",xn=hi+qt,Pn=fi+"Default",Ln=fi+"Refresh",Mn=yi+"All",Hn=Ti+"AllRanges",Gn=Ni+"Height",Kn=Ni+"Sync",Bn=Ni+"Top",jn=wi+"Attribute",Vn=wi+"Data",Wn=wi+"End",qn=wi+"Start",zn=wi+"Timeout",Yn=Li+Ze,Zn=Li+"Path",Xn=Li+"Target";let Jn="";const Qn="@excl@",ts="@grave@",es="@num@",is="@ast@",ns="@lowbar@",ss="@tilde@",os="@Hat@",ls="@equal@",rs="@lt@",hs="@gt@",us="@lsqb@",cs="@rsqb@",as="@lpar@",ds="@rpar@",fs="@dollar@",ps="&lt;",_s="&gt;",ys="&amp;",gs="&nbsp;",ms="&quot;",Ts="&apos;",Es={create:"CREATE",append:"APPEND",replace:"REPLACE",text:"TEXT",prop:"PROP",remove:"REMOVE"};Array[ge]({[Le]:26},((t,e)=>i[Tn](97+e)))[ye](((e,n)=>{let s=n<10,o=n>=10&&n<20,l=n>=20,r=i(n),h=r[Lt](r[Le]-1),u=i=>{Jn+=i?e[Yi]():e,t[(i?"$":"_")+(l?"_":"")+h+(o?"_":"")]=i?e[Yi]():e};u(0),u(1),s&&(Jn+=n,t["_"+e]=n)}));t._a,t._b,t._c,t._d,t._e,t._f,t._g,t._h,t._i,t._j;const Os=t._0,As=t._1,Ns=(t._2,t._3,t._4,t._5,t._6),Cs=t._7,ws=t._8,Ss=(t._9,t._0_,t._1_,t._2_,t._3_,t._4_,t._5_,t._6_,t._7_,t._8_),$s=(t._9_,t.__0),bs=(t.__1,t.__2,t.__3,t.__4,t.__5,t.$0,t.$1,t.$2,t.$3,t.$4,t.$5,t.$6,t.$7,t.$8,t.$9,t.$0_,t.$1_,t.$2_,t.$3_,t.$4_,t.$5_,t.$6_,t.$7_,t.$8_,t.$9_,t.$_0,t.$_1,t.$_2,t.$_3,t.$_4,t.$_5,"https://fonts.googleapis.com"),Is=bs+"/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0&display=swap",Ds="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js",Rs="https://cdn.jsdelivr.net/npm/@pardnchiu/nanomd@latest/dist/NanoMD.css",Fs="NanoMD\nGitHub: https://github.com/pardnchiu/NanoMD\nCreator: Pardn Chiu\nLicense: MIT";let Us;for(let t of[ks(Ge,{[mi]:an,[Ne]:"https://fonts.gstatic.com",[cn]:""}),ks(Ge,{[mi]:an,[Ne]:bs,[cn]:""}),ks(Ge,{[mi]:ai,[Ne]:Is,[Rt]:Ui,[cn]:"anonymous"}),ks(Ge,{[mi]:"stylesheet",[Ne]:Is}),ks(Ge,{[mi]:"preconnect",[Ne]:"https://cdn.jsdelivr.net"}),ks(Ge,{[mi]:ai,[Ne]:Ds,[Rt]:Ai}),ks(Ai,{[Di]:Ds}),ks(Ge,{[mi]:ai,[Ne]:Rs,[Rt]:Ui}),ks(Ge,{[mi]:"stylesheet",[Ne]:Rs})])e[Ee][Dt](t);function ks(t="",i,n){const s=((t[We](O)||[])[0]||"")[Xi](),o=((t[We](E)||[])[1]||"")[Xi](),l=(T[Bi](t)?t[We](T):[])[je]((t=>t[Ei](/^\./,"")));e[be],e[te];if(s[Le]<1)return;let r,h,u,c=!1;if(t===Ki?(c=!0,r=e[yn]()):r=e[gn](s),83!=Fs[Le])return r;o[Le]&&(r.id=o);for(let t of l)r[_n][bt](t);if(null==i&&null!=n&&([i,n]=[n,null]),null!=i&&null!=n)[h,u]=[i,n];else if(null==n)typeof i===Ri||typeof i===ti||Array[Fe](i)?u=i:h=i;else if(null==i)return r;if(typeof h===ei&&null!=h)for(const t in h){if(!h[wn](t))continue;const e=h[t];-1!=[tn,bn,$n,ji,Zt][Sn](t)?r[t]=e:-1!=[zt,fn,sn,Oe,oe,de][Sn](t)?r[Ui][t]=e:null!=e&&r[jn](t,e)}if(null!=u){const t=typeof u===Ri,i=typeof u===ti,n=Array[Fe](u);if(t||i){const t=u;s===Se||s===$i?r[Di]=t:c?r[Dt](e[mn](u)):r[$n]=t}else if(n)for(let t of u){const i=t instanceof Element;typeof t===Ri||typeof t===ti?c?r[Dt](e[mn](t)):r[$n]+=t:i&&r[Dt](t)}}return r}function vs(t=""){return t[Ei](C,(t=>({"&":ys," ":gs,"<":ps,">":_s,'"':ms,"'":Ts}[t])))}function xs(t,e=""){return new RegExp(t,e)}function Ps(t){if(t)return t[pn]===li||t[Dn][zi]()===le&&t[vn][pn]===li?t:Ps(t[vn])}function Ls(t){const e=ks(le);return e[Dt](t),e[$n]}function Ms(t=""){if((t=t[Xi]())[Le]<1)return"";const e=t[We](Tt)||[];return e[Le]>2&&11===e[1][Le]?e[1]:""}function Hs(t=""){if((t=t[Xi]())[Le]<1)return"";const e=t.match(/(?:https?:\/\/)?(?:www\.)?vimeo\.com\/(?:channels\/[\w]+\/|groups\/[\w]+\/videos\/|album\/\d+\/video\/|video\/|)(\d+)/);return e?e[1]:null}function Gs(t,e="",i="",n="",s="",o=""){const l=Ks(i),r=n instanceof HTMLElement?n:ks(i,n);return m[wi](l,r[si]),e[Ei](t,s+l+o)}function Ks(t=""){let e="{{"+(t[Xi]()||Ft)+"-";for(let t=0;t<64;t++)e+=g[Lt](r[fe](36*r[gi]()));return e+="}}",m[Te](e)?Ks(t):e}function Bs(t=""){let i;for(let e of t[We](xs(S,Ns))||[]){const s=e[We](S),o=s[1]||"",l=s[3]||"",r=s[5]||"";i=ks(kt+(l[Le]?"."+l:"")),n(e,l),t=Gs(e,t,kt,i,o,r)}function n(t,e=""){let n=Xs(t[Xi]()[Ei](/^\>[\u00A0\u0020\u0009]?/,"")[Ei](/\n\>[\u00A0\u0020\u0009]?/g,"\n"))[Ii](nt);for(let t in n){const o=n[t];i[Dt](s(o,d(t),e))}}function s(t,n=0,o=""){let l=ks(Ki);const r=/^[\u00A0\u0020\u0009]*\>[\u00A0\u0020\u0009]?/,h=t[Ei](r,"");if(/\[\!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]/[Bi](t)&&0===n)l[Dt](ks(bi+".hint",[-1!=["NOTE","TIP","IMPORTANT","WARNING","CAUTION"][Sn](o)?ks("span.material-symbols-outlined",{NOTE:"info",TIP:"lightbulb",IMPORTANT:"sms",WARNING:"warning",CAUTION:"error"}[o]||""):null,o])),l[Dt](ks(xt));else if(r[Bi](t)){let t=ks(kt);t[Dt](s(h)),l[Dt](t)}else/^[\u00A0\u0020\u0009]*\{\{/[Bi](t)?l[Dt](i[Dt](e[mn](t))):l[Dt](ks(bi,t));return l}return t}function js(t=""){let e=[[Wt,$]];for(let i of e){const e=i[0],n=i[1];for(let i of t[We](xs(n,Ns))||[]){const s=i[We](n);if(U[Bi](s[1]||""))continue;let o=(s[1]||"")[Xi]();o[Le]<1||(e!=Wt?t=t[Ei](i,ks(e,o)[si]):(o=vs(o),t=Gs(i,t,e,o)))}}return t}function Vs(t){let e=0,i=ks(ni);for(let n in t){const s=t[n];0===d(n)&&(e=r.floor((s[We](/^\s*/)||[""])[0][Le]/4));const o=xs(`^\\s{0,${4*e}}`);i[Dt](ks(Me,vs(s[Ei](o,""))))}return i}function Ws(t=""){let e=[[Fi,W],[Fi,q],[Ss,V],[Ve,j],[he,R],[he,F],[xi,Y],[ki,z]];for(let t of e){i(t[0],t[1])}function i(e,i){for(let n of t[We](xs(i,Ns))||[]){const s=n[We](i);if(U[Bi](s[1]||""))continue;let o=(s[1]||"")[Xi]();o[Le]<1||(e!=Wt?t=t[Ei](n,ks(e,o)[si]):(o=vs(o),t=Gs(n,t,e,o)))}}return t}function qs(t="",e="",n=At){if(i(e||"")[Xi]()[Le]<1)return t;for(let i of t[We](xs(N,Ns))||[]){if(i[We](/^\\/))continue;const s=i[We](N);if(s[Le]<1)continue;const o=s[1],l=(s[2]||"")[Xi](),r=Ks(Os);if(l[Le]<1)continue;const h=ks(Ki,[ks(Os+"."+Li,{[Ne]:e+l,[Mi]:n===At?At:"_self"},l)]);m[wi](r,Ls(h)),t=t[Ei](i,o+r)}return t}function zs(t=""){return(()=>{for(let e of t[We](xs(k,Ns))||[]){const i=e[We](k);if(i[Le]<1)continue;const n=i[1]||"",s=(i[3]||"")[Xi]()[Le],o=(i[4]||"")[Xi]();0!=r[ze](s,o[Le])&&(t=Gs(e,t,Cs+s,o,n))}})(),(()=>{for(let e of t[We](xs(P,Ns))||[]){const i=e[We](P);if(i[Le]<1)continue;const n=i[1]||"",s=(i[2]||"")[Xi]()[Le],o=(i[3]||"")[Xi](),l=i[4]||"";0!=r[ze](s,o[Le])&&(t=Gs(e,t,Cs+s,o,n,l))}})(),(()=>{for(let e of t[We](xs(v,Ns))||[]){const i=e[We](v);if(i[Le]<1)continue;const n=i[1]||"",s=(i[2]||"")[Xi](),o=i[3]||"";s[Le]<1||(t=Gs(e,t,Cs+1,s,n,o))}})(),(()=>{for(let e of t[We](xs(x,Ns))||[]){const i=e[We](x);if(i[Le]<1)continue;const n=i[1]||"",s=(i[2]||"")[Xi](),o=i[3]||"";s[Le]<1||(t=Gs(e,t,Cs+2,s,n,o))}})(),t}function Ys(t=""){for(let e of t[We](xs(L,Ns))||[]){const i=e[We](L);if(i[Le]<1)continue;const n=i[1]||"",s=i[3]||"",o=Ks("HR");m[wi](o,"<hr>"),t=t[Ei](e,n+o+s)}return t}function Zs(t=""){const e="this.parentElement.nextElementSibling.style.display='block';this.parentElement.style.display='none'",i="https://cdn.jsdelivr.net/npm/@pardnchiu/nanomd@latest/dist/icon-play.svg";function n(t,n,s,o){return Ls(ks(Ki,[ks(Os,{[qi]:o,[Ne]:n,[Mi]:At},s||n),ks("section.more",[ks("img.cover","https://i.ytimg.com/vi/"+t+"/mqdefault.jpg"),ks("img.icon",{[Fn]:e},i)]),ks(we,{[Be]:Pe,[sn]:"640px",[Di]:"https://www.youtube.com/embed/"+t,frameborder:0,allow:"accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:"",[oe]:Qe})]))}function s(t,n,s,o){const l=function(t){const e=`https://vimeo.com/api/v2/video/${t}.json`;let i=null;const n=new XMLHttpRequest;n.open("GET",e,!1);try{n.send(),200===n.status?i=JSON.parse(n.responseText)[0].thumbnail_large:console.error("HTTP 錯誤:",n.status)}catch(t){console.error("無法獲取縮圖:",t)}return i}(t);return Ls(ks(Ki,[ks(Os,{[qi]:o,[Ne]:n,[Mi]:At},s||n),ks("section.more",[ks("img.cover",l),ks("img.icon",{[Fn]:e},i)]),ks(we,{[Be]:Pe,[sn]:"640px",[Di]:"https://player.vimeo.com/video/"+t,frameborder:0,allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:"",[oe]:Qe})]))}return(()=>{for(let e of t[We](xs(w,Ns))||[]){const i=e[We](w);if(i[Le]<1)continue;const o=(i[1]||"")[Xi](),l=(i[2]||"")[Xi](),h=(i[4]||"")[Xi](),u=(Ms(l)||"")[Xi](),c=(Hs(l)||"")[Xi]();if(0!=r[ze](o[Le],l[Le]))if(u[Le])t=Gs(e,t,le,n(u,l,o,h));else if(c[Le])t=Gs(e,t,le,s(c,l,o,h));else{const i=ks(Os,{[qi]:h,[Ne]:l,[Mi]:At},o);t=Gs(e,t,Os,i)}}})(),(()=>{for(let e of t[We](xs(et,Ns))||[]){if(e[We](H))continue;const i=e[We](et);if(i[Le]<1)continue;const o=i[1]||"",l=(i[2]||"")[Xi](),r=i[5]||"",h=(Ms(l)||"")[Xi](),u=(Hs(l)||"")[Xi]();if(!(l[Le]<1))if(h[Le])t=Gs(e,t,le,n(h,l),o,r);else if(u[Le])t=Gs(e,t,le,s(u,l));else{const i=ks(Os,{[Ne]:l,[Mi]:At},l);t=Gs(e,t,Os,i,o,r)}}})(),(()=>{for(let e of t[We](xs(A,Ns))||[]){if(e[We](H))continue;const i=e[We](A);if(i[Le]<1)continue;const n=(i[1]||"")+(i[2]||"")+(i[3]||""),s=(i[4]||"")[Xi](),o=i[8]||"";if(s[Le]<1)continue;const l=ks(Os,{[Ne]:Et+s,[Mi]:At},s);t=Gs(e,t,Os,l,n,o)}})(),t}function Xs(t=""){for(let i of t[We](xs(G,Ns))||[])e(i);function e(e){let i;e[Xi]()[Ei](xs(it,Ns),Ot)[Ii](it)[ye](((t,e)=>{const n=t[We](K)||[],s=n[Le]<1?null:/\d+\./[Bi]((n[2]||"")[Xi]())?ni:Qi,o=(t[We](/\s{4}/g)||[])[Le];let l=n[Le]<1?t[Ei](/^\s*([\-\*\+]|\d+\.)?\s*/g,""):(n[3]||"")[Xi]();if(0===d(e)&&null==s)return;0===d(e)&&(i=ks(s));let r=i;function h(t,e){if(/^\[\s*(\x)?\s*\]/[Bi](e)){const i=e[Xi]()[We](/^\[\s*(\x)?\s*\]/);e=e[Ei](/^\[\s*(\x)?\s*\]\s*/,"");const n=null!=i[1];t[Dt](ks(Me,[ks(ke,[ks(De,{[Ji]:Ht,[Mt]:n?"":null,[Fn]:"return false;"}),ks(bi,e)])]))}else t[Dt](ks(Me,e))}if(/^\s{0,3}([\-\*\+]|\d+\.)/[Bi](t))h(r,l);else if(/^\s{4,}([\-\*\+]|\d+\.)/[Bi](t)){r=i[xe];for(let t=0;t<o&&(null!=r&&null!=r[Yn]);t++)if(t==o-1&&r[Yn][zi]()==Me)if(r[xe]instanceof HTMLElement&&(r[xe][Yn][zi]()==ni||r[xe][Yn][zi]()==Qi))h(r[xe],l);else if(/^\[\s*(\x)?\s*\]/[Bi](l)){const t=l[Xi]()[We](/^\[\s*(\x)?\s*\]/);l=l[Ei](/^\[\s*(\x)?\s*\]\s*/,"");const e=null!=t[1];r[Dt](ks(s,[ks(Me,[ks(ke,[ks(De,{[Ji]:Ht,[Mt]:e?"":null,[Fn]:"return false;"}),ks(bi,l)])])]))}else r[Dt](ks(s,[ks(Me,l)]));else r=r[xe][xe]}else{if(null==i)return;for(r=i[xe];null!=r[xe];)r=r[xe];if(r instanceof HTMLElement);else if(/^\{\{(h\d|img|pre)/[Bi](r[Rn]||""));else{for(;r[kn][Yn][zi]()!=Me;)r=r[kn];r[kn][Dt](ks(xt))}r[kn][$n]+=l}})),null!=i&&(t=Gs(e,t,Ke,i))}return t}function Js(t=""){for(let e of t[We](xs(M,Ns))||[]){const i=e[We](M);if(i[Le]<1)continue;const n=(i[1]||"")[Xi](),s=(i[2]||"")[Xi](),o=(i[4]||"")[Xi]();let l=(i[6]||"")[Xi](),r=(i[7]||"")[Xi](),h=(i[9]||"")[Xi]();if(s[Le]<1)continue;l[Le]&&!tt[Bi](l)&&(l+=_i),r[Le]&&!tt[Bi](r)&&(r+=_i);const u=J[Bi](s),c=Q[Bi](s);let a;a=u?ks(en,{[Xt]:"",[qi]:o,[sn]:l||null,[Oe]:r||null},[ks($i,{[Ji]:p},s)]):c?ks(en,{[Xt]:"",[qi]:o,[sn]:l||null,[Oe]:r||null},[ks($i,{[Ji]:f},s)]):ks(Se,{[It]:n,[qi]:o,[sn]:l||null,[Oe]:r||null,[de]:h[Le]?h:null},s),null!=a&&(t=Gs(e,t,Se,a))}return t}function Qs(t=""){for(let e of t[We](xs(I,Ns))||[]){const i=e[We](I);if(i[Le]<1)continue;const n=null==i[2][We](b),s=n?"":(i[1]||"")[Xi]()[zi](),o=i[2]||"",l=-1!=_[Sn](s),r=o[Ei](b,"")[Ii](nt);let h;h=n?ks(Wt+"."+di,vs(o)):ks(ui+"."+di,{[Xe]:s},[ks(Wt+(l?"."+ve+"-"+s:""),{[Xe]:s},[Vs(r)]),ks(Pt+"."+Jt)]),t=Gs(e,t,n?Wt:ui,h)}return t}function to(t=""){for(let e of t[We](xs(D,Ns))||[]){const i=e[We](D);if(i[Le]<1)continue;const n=i[2]||"",s=e[Ei](b,"")[Ii](nt),o=ks(ui+"."+di,[ks(Wt,[Vs(s)]),ks(Pt+"."+Jt)]);t=Gs(e,t,ui,o,n)}return t}function eo(t=""){let e;function i(t){const e=t[We](/^([\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*)+/)||[],i=t[We](/[\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*$/)||[];return[e[0]||"",i[0]||""]}function n(t){const i=t[Xi]()[Ii](nt);e=ks(Ki,[ks(Pi,[ks(Wi),ks(Hi)])]);let n=!0,o=[],l=0;for(let t in i){const r=i[t],h=r[We](/((\s*)\|?((?:.*?\|)*.*)\|?)+/)||[];if(h[Le]<1)continue;const u=(h[3]||"")[Xi]()[Ei](/[\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*$/,""),c=/^[\u0020\u00A0\u0009]*\|?([\u0020\u00A0\u0009]*[\-\:]+[\u0020\u00A0\u0009]*\|?)+[\u0020\u00A0\u0009]*$/[Bi](r),a=u[Ii](/[\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*/);if(0===d(t)&&(l=a[Le]),c){for(let t of r[Ei](/^([\u0020\u00A0\u0009]*\|)|(\|[\u0020\u00A0\u0009]*)$/g,"")[Ii](/\|/))/^\-+\:$/[Bi](t[Xi]())?o.push("right"):/^\:\-+\:$/[Bi](t[Xi]())?o.push("center"):o.push("left");const t=[...e.firstChild.firstChild.childNodes[0].childNodes];for(let e in t)t[e].setAttribute("align",o[e]);n=!1}else s(n,a,l,o)}}function s(t=!0,i=[],n=0,s=[]){const o=t?e.firstChild.firstChild:e.firstChild[xe],l=ks(Zi);for(let e=0;e<n;e++)l[Dt](ks(t?Vi:Gi,{align:s[e]},i[e]||""));o[Dt](l)}return(()=>{const s=/([^\n]*)(?:[\u0020\u00A0\u0009]*\|[^\n]*\|[^\n]*\n)[\u0020\u00A0\u0009]*\|([\u0020\u00A0\u0009\-\:]*\|)+\n(?:[\u0020\u00A0\u0009]*\|[^\n]*\|[^\n]*\n)*/;for(let o of t[We](xs(s,Ns))||[])B[Bi](o)||(n(o),t=Gs(o,t,Pi,Ls(e),...i(o)))})(),(()=>{const s=/(([^\n]+\|)*[^\n]+\n)(([\u0020\u00A0\u0009\-\:]+\|)*[\u0020\u00A0\u0009\-\:]+\n)(?:([^\n]+\|)*[^\n]+\n)*/;for(let o of t[We](xs(s,Ns))||[])n(o),t=Gs(o,t,Pi,Ls(e),...i(o))})(),t}function io(t=""){return t=t[Ei](/\n[\u0020\u00A0\u0009]*/g,"\n"),(()=>{for(let e of t[We](xs(X,Ns))||[]){const i=e[We](X);if(i[Le]<1)continue;const n=i[2]||"",s=(i[0]||"")[Xi]();if(s[Le]){const i=ks(Ki,[ks("p",s)]),o=Ks("p");m[wi](o,Ls(i)),t=t[Ei](e,n+o)}}})(),(()=>{for(let e of t[We](xs(Z,Ns))||[]){const i=e[We](Z);if(i[Le]<1)continue;const n=i[2]||"",s=(i[0]||"")[Xi]();if(s[Le]){const i=ks(Ki,[ks("p",s)]),o=Ks("p");m[wi](o,Ls(i)),t=t[Ei](e,n+o)}}})(),t}function no(t=""){t=t[Ei](/^\n*|\n*$/g,"");const e=/(&lt;br&gt;)/g;return e[Bi](t)?t[Ei](e,"\n"):t}function so(t="",e="",i=At){t=t[Ei](st,Qn)[Ei](ot,ts)[Ei](lt,es)[Ei](rt,is)[Ei](ht,ns)[Ei](ut,ss)[Ei](ct,os)[Ei](at,ls)[Ei](dt,rs)[Ei](ft,hs)[Ei](pt,us)[Ei](_t,cs)[Ei](yt,as)[Ei](gt,ds)[Ei](mt,fs)[Ei](/[\u00A0\u0020]/g," ");let n=[Qs,js,Js,Zs,Ws,zs,Ys,eo,Bs,Xs,to,qs,no,io];for(let s of n)t=s(t,e,i);for(;/\{{2}\w*\-*\w{64}\}{2}/[Bi](t);)for(let e of t[We](/\{{2}\w*\-*\w{64}\}{2}/g)||[]){let i=xs(e);t=t[Ei](i,m[me](e))}const s=["h1","h2","h3","h4","h5","h6",Pi,ni,Qi,ui,kt,"details","hr",ke];for(let e of s){const i=xs(`[  \t]*\\n[  \t]*<${e}`,Ns),n=xs(`${e}>[  \t]*\\n[  \t]*`,Ns);t=t[Ei](i,`<${e}`)[Ei](n,`${e}>`)}return t=t[Ei](xs(Qn,Ns),"&excl;")[Ei](xs(ts,Ns),"&grave")[Ei](xs(es,Ns),"&num;")[Ei](xs(is,Ns),"&ast;")[Ei](xs(ns,Ns),"&lowbar;")[Ei](xs(ss,Ns),"&tilde;")[Ei](xs(os,Ns),"&Hat;")[Ei](xs(ls,Ns),"&equal;")[Ei](xs(rs,Ns),ps)[Ei](xs(hs,Ns),_s)[Ei](xs(us,Ns),"&lsqb;")[Ei](xs(cs,Ns),"&rsqb;")[Ei](xs(as,Ns),"&lpar;")[Ei](xs(ds,Ns),"&rpar;")[Ei](xs(fs,Ns),"&dollar;")[Ei](/([\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*){2,}/g,"<br>")}document.addEventListener("DOMContentLoaded",(t=>{!function(...t){const i=ks(Ai,`${on}.log.${ln}(${rn} 0, ${JSON.stringify(t)});`);e[vt][Dt](i),i[Ti]()}("%c"+Fs,"line-height: 1.75rem; font-size: 0.875rem;")}));t.PDMarkdownEditor=t.MDEditor=class{#t=!1;#e="";#i=!0;#n;#s;#o;#l;#r;#h;constructor(s={}){this.#e=(s.defaultContent||"")[Xi]();const o=s[Ui]||{},l=i(o[Ye]||Ft)[Xi]()[zi](),r=n(null==o.fill?1:o.fill)?1:0,h=i(o[_e]||"")[Xi]()||"'Roboto Mono', monospace",u=n(null==o.showRow?1:o.showRow)?1:0,c=o.placeholder||{},a=i(c.text||"Type here ..."),d=i(c.color||"#bfbfbf"),f=o.focus||{},p=i(f.backgroundColor||"#0000ff1a"),_=i(f.color||"#0000ffff");e[Ee][Dt](ks(Ui,`\n.${li}{font-family: ${h}}\n.${li}>div{font-size: 0.75rem}\n.${li}>div[data-focus="1"]{background-color:${p};color:${_};caret-color:${_}}\n.${li}>div:nth-last-child(2):empty::after{position:absolute;top:0;content:"${a}";color:${d} !important;caret-color:${_}}`));const g=document[un](s[Ce]);typeof s[Ce]===Ri&&null!=g?(this[vt]=g,g.classList.add(li)):this[vt]=ks(Ci+"."+li),this[vt][ne][Ye]=y&&l===Ft||l===ie?ie:"",this[vt][ne].fill=r,this[vt][ne].row=u,this[vt][ne].pin={1:1,0:0,[!0]:1,[!1]:0}[s.tabPin]||0,this[vt][ne].wrap={1:1,0:0,[!0]:1,[!1]:0}[s.wrap]||1,this.#h=new lo(this[vt]);const m=this[vt];if(this.#i=n(null==s.hotKey||s.hotKey),null==this.#s&&s[Ln]&&(this.#s=t[dn]("beforeunload",(t=>{t[Pn]()}))),null!=s[Ye]){let t=i(s[Ye]||Ft)[Xi]()[zi]();this[vt][ne][Ye]=y&&t===Ft||t===ie?ie:""}if(null!=s.fillMode){let t=n(s.fillMode)?1:0;this[vt][ne].fill=t}if(null!=s.showRow){let t=n(s.showRow)?1:0;this[vt][ne].row=t}if(null!=s[_e]){let t=i(s[_e])[Xi]()||"'Roboto Mono', monospace";e[Ee][Dt](ks(Ui,`.${li}{font-family: ${t}}`))}let T=i(s[En]||"")[Xi]()||p,E=i(s[An]||"")[Xi]()||_;e[Ee][Dt](ks(Ui,`.${li}>div[data-focus="1"]{background-color:${T};color:${E}`));let O=i(s[hi]||"")[Xi]()||a,A=i(s[xn]||"")[Xi]()||d;e[Ee][Dt](ks(Ui,`.${li}>div:nth-last-child(1):empty::after{content:"${O}";color:${A}}`)),m.onmousedown=m.onmouseup=t=>{if(t.target[Yn][zi]()!==le)return t[Pn](),!1;this.#u()},m.ontouchend=t=>{this.#u()},m.oncut=t=>(this.#c(),this.#a((e=>{t[Vt][Vn]("text/plain",this.#r.body),m[Kt][this.#r.start][$n]=vs(this.#r.left+this.#r.right),this.#d(),this.#f(m[Kt][this.#r.start],this.#r.left[Le])})),this.#p(!0),!1),m.onpaste=e=>(this.#c(),this.#a((i=>{const n=((e[Vt]||t[Vt])[Nn]("Text")||"")[Ii](/\n/),s=n[Le],o=s-1,l=s>1,r=this.#r.start+o,h=`${l?"":this.#r.left}${n[o]}`[Le],u=n[0],c=l?"":this.#r.right;if(m[Kt][this.#r.start][bn]=this.#r.left+u+c,this.#d(),l)for(let t=1;t<s;t++){const e=n[t],i=ks(le,vs(`${e}${t===o?this.#r.right:""}`));i[Fn]=t=>this.#u(),m[In](i,m[Kt][this.#r.start+t])}this.#f(m[Kt][r],h,h)})),this.#p(!0),!1),m.oncompositionstart=t=>{this.#t=!0},m.oncompositionend=t=>{this.#t=!1},m.oninput=t=>{let e,i;if("deleteCompositionText"===t.inputType){e=this.#l.index,i=this.#l.offset;for(let t of[...m[Kt]]){if(t[Dn][zi]()===le||t[Dn][zi]()===Ci)continue;t[Ti]();let n=ks(le,{"data-index":e+1,index:e+1});n[Fn]=t=>this.#u(),m[In](n,m[Kt][e]),this.#f(m[Kt][e],i)}}t.inputType;let n=this.#l.isMulti,s=this.#l.multi.left,o=t.data,l=this.#l.multi.right,r=this.#l.multi.start.offset;this.#u(),n&&(this.#n[bn]=s+o+l,this.#f(this.#n,r+1)),this.#p(!0,300)},m.onkeydown=t=>{const e=t[qe]||t[ee],i=t.shiftKey,n=/^a$/i[Bi](t.key),o=/^b$/i[Bi](t.key),l=/^i$/i[Bi](t.key),r=/^s$/i[Bi](t.key),h=/^u$/i[Bi](t.key),u=/^m$/i[Bi](t.key),c=/^z$/i[Bi](t.key),a=/^r$/i[Bi](t.key),d=/^k$/i[Bi](t.key),f=/^f5$/i[Bi](t.key),p="ArrowUp"===t.key,_="ArrowDown"===t.key;if(this.#u(null,this.#i&&e&&n),"Meta"===t.key||"Control"===t.key)return!1;if(this.#i&&e&&i&&c)return this.goForward(),!1;if(this.#i&&e&&c)return this.goBack(),!1;if(this.#i&&(e&&a||f)&&s[Ln])return!1;if(this.#i&&e&&o)return this.#_(t,"**",As),!1;if(this.#i&&e&&l)return this.#_(t,"*",ws),!1;if(this.#i&&e&&r)return this.#_(t,"~~",Ss),!1;if(this.#i&&e&&h)return this.#_(t,$s,$s),!1;if(this.#i&&e&&u)return this.#_(t,"==",Ve),!1;if(this.#i&&e&&p)return this.#_(t,"^",xi),!1;if(this.#i&&e&&_)return this.#_(t,"~",ki),!1;if(this.#i&&e&&d)return this.#_(t,"`",Wt),!1;if(this.#i&&e&&n){const t=this[vt].firstElementChild,e=this.#y,i=window.getSelection(),n=document.createRange();if(null==t.firstChild)return;return n.setStart(t.firstChild,0),n.setEnd(e.firstChild,e.firstChild.length),i.removeAllRanges(),i.addRange(n),!1}return"Tab"===t.key?this.#g(t):"Enter"===t.key?this.#m(t):"Backspace"===t.key?this.#T(t):void 0},m.onkeyup=t=>{"Meta"!==t.key&&"Control"!==t.key&&(m[Kt]&&1===m[Kt][Le]&&m.firstElementChild[Dn][zi]()!==le&&this[be](null,!0,!1),this.#u(),/^(Arrow(Up|Left|Down|Right)|CapsLock|Shift|Control|Alt|Clear|Escape|F\d+)$/[Bi](t.key)||this[nn]&&this[nn][be]())},m.onblur=t=>{this.#c()},this.init()}get viewer(){return this.#o}set viewer(t){this.#o=t}#E(){const t=Ci+"."+De+"-"+Pt,e=parseInt(this[vt].dataset.pin||0);this[vt].dataset.wrap;let i=this[vt][yi](t);if(i)return;const n=[{[Xe]:"format_bold",[qi]:"添加粗體",[Oi]:t=>this.addBold(t)},{[Xe]:"format_italic",[qi]:"添加斜體",[Oi]:t=>this.addItalic(t)},{[Xe]:"strikethrough_s",[qi]:"添加刪除線",[Oi]:t=>this.addStrikethrough(t)},{[Xe]:"format_underlined",[qi]:"添加底線",[Oi]:t=>this.addUnderline(t)},{[Xe]:"ink_marker",[qi]:"添加高亮",[Oi]:t=>this.addMarker(t)},{[Xe]:"superscript",[qi]:"添加上標",[Oi]:t=>this.addSup(t)},{[Xe]:"subscript",[qi]:"添加下標",[Oi]:t=>this.addSub(t)},{[Xe]:"format_quote",[qi]:"添加引用",[Oi]:t=>this.addBlockquote(t)},{[Xe]:"format_list_bulleted",[qi]:"添加無序列表",[Oi]:t=>this.addUl(t)},{[Xe]:"format_list_numbered",[qi]:"添加有序列表",[Oi]:t=>this.addOl(t)},{[Xe]:"code",[qi]:"添加代碼塊",[Oi]:t=>this.addCode(t)},{[Xe]:"link",[qi]:"添加連結",[Oi]:t=>this.addLink("連結文字","連結")},{[Xe]:"landscape",[qi]:"添加圖片",[Oi]:t=>this.addImage("圖片連結","圖片名稱")},{},{[Xe]:e?"keep_off":"keep",[qi]:"釘選面板",[Oi]:t=>this.#O(t)},{[Xe]:"wrap_text",[qi]:"換行",[Oi]:t=>this.#A(t)}].map((t=>{if(null==t[Xe]){return ks("span")}let e=ks("span.material-symbols-outlined",{title:t.title,name:t.name},t.name);return e[Fn]=t.click,e}));i=ks(t,n),i[Zt]=!1,i.dataset.hide=1,this[vt][Dt](i)}#O(t){const e=t.target,i=parseInt(this[vt].dataset.pin||0);this[vt].dataset.pin=Math.abs(i-1),e[bn]=i?"keep":"keep_off",e[qi]=i?"釘選面板":"取消釘選"}#A(t){const e=parseInt(this[vt].dataset.wrap||1);this[vt].dataset.wrap=Math.abs(e-1)}#N(t,e){this.#E();const i=Ci+"."+De+"-"+Pt;let n=this[vt][yi](i);t[ne][pe]=1,this[vt][In](n,this[vt][Kt][e+1]),n[ne][Ae]=0,this.#n=t}#c(){if(!this.#n)return;const t=Ci+"."+De+"-"+Pt,e=this[vt][yi](t);this.#n[ne][pe]=0,null!=e&&(this[vt][Dt](e),e[ne][Ae]=1),this.#n=null}#u(e,i=!1){this.#c(),this.#l=new oo(this[vt],e,i);const n=t[Cn]();if(n.rangeCount<1)return;const s=n.getRangeAt(0);let o=e||Ps(s.commonAncestorContainer);null!=o&&this.#N(o,this.#l.index||this.#l.multi.end.index)}#a(t){this.#r=new ro(this[vt],this.#l),t()}#d(){this.#r.removeRows()}#f(i,n,s){const o=this[vt][Mn](le);for(let t in o){const e=o[t];isNaN(d(t))||(e[ne][$e]=d(t)+1)}t[Cn]?t[Cn]()[ue]?t[Cn]()[ue]():t[Cn]()[Hn]&&t[Cn]()[Hn]():e[Cn]&&e[Cn]()[ue]();let l=t[Cn](),r=e.createRange(),h=n??i[Gt][0][Le],u=s??h;r.selectNode(i),i[Gt][0]?(r[qn](i[Gt][0],h>i[Gt][0][Le]?i[Gt][0][Le]:h),r[Wn](i[Gt][0],u>i[Gt][0][Le]?i[Gt][0][Le]:u)):(r[qn](i,0),r[Wn](i,0)),l.addRange(r),this.#u(i)}#g(t){if(9!==t.keyCode)return;const e=this[vt];return this.#a((t=>{e[Kt][this.#r.start][$n]=vs(this.#r.left+"    "+this.#r.right),this.#d();const i=this.#r.left[Le]+4;this.#f(e[Kt][this.#r.start],i)})),!1}#m(t){if(13!==t.keyCode)return;const e=this[vt];return this.#a((t=>{e[Kt][this.#r.start][$n]=vs(this.#r.left),this.#d(),e[kn][kn][Bn]+=28;const i=ks(le,vs(this.#r.right));i[Fn]=t=>this.#u(),e[In](i,e[Kt][this.#r.start+1]),this.#f(e[Kt][this.#r.start+1],0)})),!1}#T(t){if(8!==t.keyCode)return!1;const e=this[vt];return this.#a((t=>{if(this.#l.isMulti||this.#l.isSingle)e[Kt][this.#r.start][$n]=vs(this.#r.left+this.#r.right),this.#d(),this.#f(e[Kt][this.#r.start],this.#r.left[Le]);else if(this.#r.left[Le]){const t=this.#r.left[Si](0,this.#r.left[Le]-1);e[Kt][this.#r.start][$n]=vs(t+this.#r.right),this.#f(e[Kt][this.#r.start],t[Le])}else{if(0===this.#r.start)return;e[Kt][this.#r.start-1][$n]+=vs(this.#r.right),e[Kt][this.#r.start][Ti](),e[kn][kn][Bn]-=28;const t=e[Kt][this.#r.start-1][bn][Le]-this.#r.right[Le];this.#f(e[Kt][this.#r.start-1],t)}})),!1}#C(t){t=vs(t);let e=this.#y;const i=ks(le,t);i[Fn]=t=>this.#u(),e[bn][Xi]()[Le]<1?e[$n]=t:this[vt][Dt](i),this[vt][Bn]=this[vt][Gn]}get#y(){let t=this[vt].lastElementChild;return"SECTION"===t[Dn]&&(t=t.previousElementSibling),t}#w(t,e){t=vs(t);const i=this[vt][Kt][this.#r.start];i[$n]=t,this.#d(),this.#f(i,e),this.#S()}#_(t,e="",i=""){const n=t[qe]||t[ee]||e===i;this.#l.check?this.#a((t=>{const s=this.#r.left,o=this.#r.body,l=this.#r.right,r=`${s}${n?`<${i}>`:e}${o}${n?`</${i}>`:e}${l}`[Ei](/\n/g,""),h=r[Le]-l[Le]-(n?i[Le]+3:e[Le]);this.#w(r,h),this.#p(!0)})):(this.#C(n?`<${i}></${i}>`:`${e}${e}`),this.#f(this.#y,n?i[Le]+3:e[Le]),this.#p(!0))}#$(t){this.#l.check?this.#a((e=>{const i=this.#r.start,n=this.#r.end;for(let e=i;e<=n;e++){const i=this[vt][Kt][e];i[$n]=vs(`${t} ${i[bn]}`)}const s=this[vt][Kt][n],o=s[bn][Le];this.#f(s,o),this.#p(!0),this.#S()})):(this.#C(t),this.#f(this.#y,t[Le]+1),this.#p(!0))}#b(t="",e="",i){if(this.#l.check)return void this.#a((n=>{const s=this.#r.left,o=this.#r.right,l=`${s}${null==i?"":"!"}[${t}](${e}) ${o}`[Ei](/\n/g,""),r=l[Le]-o[Le]-1;this.#w(l,r),this.#p(!0)}));this.#C(`${null==i?"":"!"}[${t}](${e})`);const n=this.#y,s=n[bn][Le];this.#f(n,s),this.#p(!0),this.#S()}#p(t,e){this.#u(),this.#h.add(this.#l,t,e)}#I(t,i){const n=new a([i],{[Ji]:"application/octet-stream"}),s=h.createObjectURL(n),o=ks(Os,{href:s,download:`NanoMD-${c.now()}.${t}`});e[vt][Dt](o),o[Oi]()}#S(){null!=this[nn]&&this[nn][be]()}init(t,e=!0,n=!0){if(this[vt][Zt]=!0,this[vt][$n]=null,(t=i(t||this.#e)[Xi]())[Le]){this.#e="";const i=t[Ei](/\n*$/,"")[Ii](/\n/);for(let t=0;t<i.length;t++){const e=i[t],n=ks(le,{"data-index":t+1},vs(e));n[Fn]=t=>this.#u(),this[vt][Dt](n)}if(this.#E(),!e)return}else{const t=ks(le,{"data-index":1});if(t[Fn]=t=>this.#u(),this[vt][Dt](t),this.#E(),!e)return}n&&this.#p(!0)}changeMode(t=He){this[vt][ne][Ye]=t}goBack(){this.#c();const t=this.#h.undo();null!=t&&(this[be](t[Yt][Le]<1?null:t[Yt],!1,!1),this.#f(this[vt][Kt][t[$e]],t[ii]),this.#S())}goForward(){const t=this.#h.redo();null!=t&&(this.init(t[Yt],!1,!1),this.#f(this[vt][Kt][t[$e]],t[ii]),this.#S())}addHeading(t,e){const i=t[qe]||t[ee],n=`${new Array(e).fill("#")[Ue]("")}${0===e?"":" "}`;this.#l.check?this.#a((t=>{const s=this.#r.left[Ei](/^\s*\#*\s*/,""),o=this.#r.body,l=this.#r.right,r=`${i?`<h${e}>`:n}${s}${o}${l}${i?`</h${e}>`:""}`[Ei](/\n/g,""),h=r[Le]-(i?5:0);this.#w(r,h),this.#p(!0)})):(this.#C(i?`<h${e}></h${e}>`:n),this.#f(this.#y,n[Le]-(i?5:0)),this.#p(!0))}addBold(t){this.#_(t,"**",As)}addItalic(t){this.#_(t,"*",ws)}addStrikethrough(t){this.#_(t,"~~",Ss)}addUnderline(t){this.#_(t,$s,$s)}addMarker(t){this.#_(t,"==",Ve)}addSup(t){this.#_(t,"^",xi)}addSub(t){this.#_(t,"~",ki)}addBlockquote(){this.#l.check?this.#a((t=>{for(let t=this.#r.start;t<=this.#r.end;t++){const e=this[vt][Kt][t];e[$n]=vs(`> ${e[bn]}`)}const e=this[vt][Kt][this.#r.end],i=e[bn][Le];this.#f(e,i),this.#p(!0),this.#S()})):(this.#C("> "),this.#f(this.#y,2),this.#p(!0))}addUl(){this.#$("-")}addOl(){this.#$("1.")}addCode(t){this.#l.check?this.#a((e=>{if(this.#l.isMulti){const t=ks(le,"```"),e=ks(le,"```");t[Fn]=e[Fn]=t=>this.#u(),this[vt][In](t,this[vt][Kt][this.#r.end+1]),this[vt][In](e,this[vt][Kt][this.#r.start]),this.#f(this[vt][Kt][this.#r.end+1],this[vt][Kt][this.#r.end+1][bn][Le]),this.#p(!0),this.#S()}else this.#_(t,"`",Wt)})):this.#_(t,"`",Wt)}addLink(t="",e=""){e[Xi]()[Le]<1&&t[Xi]()[Le]<1||this.#b(t,e)}addImage(t="",e="",i=""){t[Xi]()[Le]<1||this.#b(i,t,e)}clear(){this.init(),this.#S()}downloadMd(){this.#I("md",this.getTxt()[Xi]())}downloadHtml(){this.#I("html",`<!DOCTYPE html> <html lang="zh-hant"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Markdown Editor</title> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@pardnchiu/nanomd@latest/dist/NanoMD.css"> <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"><\/script> <style> body { display: flex; justify-content: center; align-item: flex-start; width: 100%; height: 100%; overflow: scroll; } * { -ms-overflow-style: none; scrollbar-width: none; -webkit-overflow-scrolling: touch; touch-action: manipulation; box-sizing: border-box;} body { background-color: ghostwhite; } *::-webkit-scrollbar { display: none; } body>section { padding: 1rem !important; width: 100%; background-color: #fff; box-sizing: border-box; box-shadow: 0 0.25rem 0.5rem #0000000d; transition: 0.3s; } @media screen and (min-width: 640px) { body>section { padding: 3rem !important; max-width: 800px; } } </style> </head> <body><section class="pd-md-viewer">${so(`\n${this.getTxt()}\n`)}</section></body> </html><!DOCTYPE html>`)}openfile(t){if(null==t)return void alert("請選擇檔案");const e=new FileReader;e.readAsText(t),e.onload=()=>{this[vt][$n]=null;const t=e.result[Xi]()[Ei](/[\u0020\u00A0]/g," ");this.init(vs(t),!1),this.#S()}}getTxt(){return[...this[vt][Kt]].map((t=>"SECTION"===t[Dn]?"":t[bn]))[Ue]("\n")}};class oo{check=!1;isMulti=!1;isSingle=!0;index;offset;left;right;selection={};multi={};constructor(e,i,s=!1){const o=t[Cn]();if(o.rangeCount<1)return;const l=o.getRangeAt(0);let r=i||Ps(l.commonAncestorContainer);if(null==r)return;let h,u,c="";if(s){r=e;const t=r[Mn](le);for(let e=0;e<t.length;e++){const i=t[e];c+=(0==e?"":"\n")+i[bn]}h=0,u=t[Le]-1}else l.cloneContents()[Gt][ye](((t,e)=>{c+=(0==e?"":"\n")+t[bn]})),r===e&&(h=d(Ps(o.baseNode)[ne][$e])-1,u=d(Ps(o.focusNode)[ne][$e])-1);var a=n(r===e),f=!a&&!s&&n(o[Ut]!==o[On]),p=!!s||n(o[On]>o[Ut]),_=!!s||n(h<u);this.check=!0,this.index=a?null:d(r[ne][$e])-1,this.offset=a||f?null:d(o[On]),this.left=a||f?null:r[bn][Si](0,o[On]),this.right=a||f?null:r[bn][Si](o[On],r[bn][Le]),this.isSingle=f,this.isMulti=a;const y=f?p?o[Ut]:o[On]:null,g=f?p?o[On]:o[Ut]:null;this.selection={body:f?o.toString():c,start:y,end:g,left:f?r[bn][Si](0,y):null,right:f?r[bn][Si](g,r[bn][Le]):null};const m=a?_?h:u:null,T=s?0:a?_?o[Ut]:o[On]:null,E=a?_?u:h:null,O=s?e[Kt][u][bn][Le]:a?_?o[On]:o[Ut]:null;this.multi={start:{index:m,offset:T},end:{index:E,offset:O},left:s?"":a?r[Kt][m][bn][Si](0,T):null,right:s?"":a?r[Kt][E][bn][Si](O,r[bn][Le]):null}}}class lo{#D;#R;#F=[];#U=[];constructor(t){this.#D=t}clearTimer(){this.clearTimer(this.#R)}add(t,e,i){null==i?this.#k(t,e):this.#R=setTimeout((i=>{this.#k(t,e)}),i)}#k(t,e){this.#F[pi]({[$e]:t[$e],[ii]:t[ii],[Yt]:[...this.#D[Kt]].map((t=>t[bn]))[Ue]("\n")}),e&&(this.#U=[])}undo(){const t=this.#F[(this.#F||[])[Le]-2];if(null==t)return;let e=this.#F.pop();return this.#U[pi](e),t}redo(){const t=this.#U.pop();if(null!=t)return this.#F[pi](t),t}}class ro{editor;body;start;end;left;right;constructor(t,e){let i,n,s,o;this.editor=t,e.isMulti?(i=e.multi.start.index,n=e.multi.end.index,s=e.multi.left,o=e.multi.right):e.isSingle?(i=e.index,n=e.index,s=e.selection.left,o=e.selection.right):null!==e.index&&null!==e.offset&&(i=e.index,n=e.index,s=e.left,o=e.right),this.body=e.selection.body,this.start=d(i),this.end=d(n),this.left=s[Ei](/&lt;/g,"<")[Ei](/&gt;/g,">")[Ei](/&nbsp;/g," "),this.right=o[Ei](/&lt;/g,"<")[Ei](/&gt;/g,">")[Ei](/&nbsp;/g," ")}removeRows(){for(let t=this.end;t>this.start;t--)this.editor[Kt][t][Ti]()}}class ho{tag="";props={};children=[];data=null;constructor(t){if(t[Yn][zi]()===Ai){let i=!1;for(const n of e[Ee][Mn](Ai)||[])if(null!=t[Di]&&n[Di]===t[Di]||null!=t[ji]&&n[ji]===t[ji]){i=!0;break}i||e[Ee][Dt](t),this[Li]=Ai}this[Li]=t[Yn][zi](),this[ci]=[...t.attributes].reduce(((t,e)=>(t[e.name]=e.value.trim(),t)),{}),this[Kt]=function(t){return s[ge](t[Gt]).filter((t=>t[$t]===u[St]||t[$t]===u[wt]&&t[ji]&&t[ji][Xi]()[Le]>0))}(t)[je]((t=>t.nodeType===Node[St]?new ho(t):t[ji]||""))}getPatches(t){return this.#v(t,this)}#v(t,e,i=[]){if(null==t&&e)return[{[Ji]:Es.create,[$e]:i,[hn]:e}];if(t&&!e)return[{[Ji]:Es.remove,[$e]:i}];if(!t&&!e)return[];if(t.tag!==e.tag)return[{[Ji]:Es[Ei],[$e]:i,[hn]:e}];const n=[];return n[pi](...this.#x(t,e,i)),n[pi](...this.#P(t,e,i)),n}#x(t,e,i=[]){if(null==t||"string"==typeof t||null==e||"string"==typeof e)return[];const n=[],s=t[ci]||{},l=o[Ct](s)[Le],r=e[ci]||{},h=o[Ct](r)[Le];if(h>0)for(let t in r){const s=r[t];n[pi]({[Ji]:Es.prop,[hn]:e,key:t,value:s,[$e]:i})}if(l>0){if(h<1)for(let t in s)n[pi]({[Ji]:Es.prop,[hn]:e,key:t,[tn]:null,[$e]:i});for(let t in r)h>0&&!(t in r)&&n[pi]({[Ji]:Es.prop,[hn]:e,key:t,[tn]:null,[$e]:i})}return n}#P(t,e,i=[]){if(null==t||"string"==typeof t||null==e||"string"==typeof e)return[];const n=[],o=s[Fe](t[Kt])?t[Kt]:[],l=s[Fe](e[Kt])?e[Kt]:[],h=r.max(o[Le],l[Le]);for(let t=0;t<h;t++){const s=o[t],r=l[t],h=i.concat(t);if("string"==typeof s&&"string"==typeof r){if(s===r)continue;n[pi]({[Ji]:Es.text,[hn]:e,[tn]:r,[$e]:h})}else null==s?n[pi]({[Ji]:Es.append,[hn]:r,[$e]:h}):null==r?n[pi]({[Ji]:Es.remove,index:h}):n[pi](...this.#v(s,r,h))}return n}}t.PDMarkdownViewer=t.MDViewer=class{body;vbody;#L;#M="";#H=300;#G=0;#K;#B;#D;constructor(t={}){if((ce in t||ui in t)&&(this.#M=String(t[ce]||t[ui]||"")[Xi]()),Ui in t){t[Ui]}const s=t[Ui]||{},o=i(s[Ye]||Ft)[Xi]()[zi](),l=n(null==s.fill?1:s.fill)?1:0,r=i(s[_e]||"")[Xi]()||"'Noto Sans TC', sans-serif",h=t.sync||{};this.#H=d(null==h[se]?300:h[se])||300,this.#G=n(h[Ni]||0)?1:0,this[re]=h[re]instanceof PDMarkdownEditor?h[re]:null,e[Ee][Dt](ks(Ui,`.${ri}{font-family: ${r}}`));const u=document[un](t[Ce]);typeof t[Ce]===Ri&&null!=u?(this[vt]=u,u.classList.add(ri)):this[vt]=ks(Ci+"."+ri),this[vt][ne][Ye]=y&&o===Ft||o===ie?ie:"",this[vt][ne].fill=l;const c=t.hashtag||{};if(this.#K=i(c.path||"")[Xi](),this.#B=i(c[Mi]||"")[Xi](),null!=t.fillMode){let e=n(t.fillMode)?1:0;this[vt][ne].fill=e}if(null!=t[se]&&(this.#H=d(t[se])||300),null!=t[Kn]&&(this.#G=n(t[Kn])?1:0),null!=t[_e]){let n=i(t[_e])[Xi]()||"'Noto Sans TC', sans-serif";e[Ee][Dt](ks(Ui,`.${ri}{font-family: ${n}}`))}null!=t[Zn]&&(this.#K=i(t[Zn]||"")[Xi]()),null!=t[Xn]&&(this.#B=i(t[Xn]||"")[Xi]()),this.vbody=new ho(this[vt]),this.init()}get editor(){return this.#D}set editor(t){this.#D&&(this.#D[vt][Un]=null),null!=t&&(this.#D=t,this.#D.viewer=this,this.#G&&null!=this.#D&&(this.#D[vt][Un]=t=>{this[vt][Bn]+=t.deltaY}))}#j(){if(null==this.#D)return"";const t=[...this.#D[vt][Mn](le)];let e="";for(let n of t){var i=n[bn][Ei](/[\u00A0\u0020]/g," ");i[Xi]()[Le]<1?e+="\n":e+=i+"\n"}return e[Xi]()}clear(){let t=this[vt].cloneNode(!0);t[$n]="";let e=new ho(t);this[vt][$n]="",this.vbody=e}init(e=""){let i=this.#M,n=this[vt][Bn];t[jt](this.#L),this.#L=t[zn]((()=>{if(t[jt](this.#L),i&&this[vt][$n]&&i===this[vt][$n])return;let o=e||this.#j()||i;o=so(`\n${o}\n`,this.#K,this.#B);let l=this[vt].cloneNode(!0);l[$n]=o;let r=new ho(l);const h=r.getPatches(this.vbody);s[Fe](h)&&this.#V(this[vt],h),this.vbody=r;for(let e of[...this[vt][Mn](Pt+"."+Jt)])e[Fn]=async e=>{t[jt](Us);const i=e[Mi][kn],n=i[_n],s=i[Kt][0][bn];try{await navigator.clipboard.writeText(s),n[bt](vi),Us=t[zn]((t=>{n[Ti](vi)}),1e3)}catch(t){console[ae](t),n[bt](ae)}};let u=setInterval((()=>{null!=PR&&(clearInterval(u),this[vt][Bn]=n,PR.prettyPrint())}),50)}),this.#H)}changeMode(t=He){this[vt][ne][Ye]=t}#V(t,e){if(null!=t&&s[Fe](e)){this.#W(t,e);for(const i of e){const{index:e}=i,n=l.parse(l.stringify(e||[]));let s;i.type===Es.append&&(s=n?.pop());const o=n?this.#q(t,n):t;o&&(i.type===Es.create&&hn in i?this.#z(o,i):i.type===Es.replace&&hn in i&&null!=o[vn]?this.#Y(o,i):i.type===Es.append&&hn in i&&null!=s?this.#Z(o,i,s):i.type===Es.prop&&"key"in i&&tn in i&&o instanceof Element?this.#X(o,i.key,i.value||"",i[hn]):i.type===Es.text&&tn in i&&o.nodeType===u[wt]&&(o[ji]=i.value||""))}}}#W(t,e){const i=e.filter((t=>t.type===Es.remove)).sort(((t,e)=>{const i=(e.index.length||0)-(t.index.length||0);if(0!==i)return i;for(let i=0;i<(t.index.length||0);i++)if((t.index[i]||0)!==(e.index[i]||0))return(e.index[i]||0)-(t.index[i]||0);return 0}));for(const e of i){const i=this.#q(t,e.index);null!=i&&null!=i[vn]&&i[vn].removeChild(i)}}#z(t,i){if(i.type!==Es.create||!(hn in i))return;const n="string"==typeof i[hn]?e[mn](i[hn]):this.#J(i[hn]);null!=t[kn]&&t[kn][Dt](n)}#Y(t,i){if(i.type!==Es.replace||!(hn in i)||null==t[vn])return;const n="string"==typeof i[hn]?e[mn](i[hn]):this.#J(i[hn]);if(t[vn].replaceChild(n,t),!(n instanceof Text||"string"==typeof i[hn])){for(const t in i[hn][ci])this.#X(n,t,i[hn][ci][t]||"",i[hn]);this.#Q(i[hn],n)}}#Z(t,i,n){if(i.type!==Es.append||!(hn in i)||null==n)return;const s="string"==typeof i[hn]?e[mn](i[hn]):this.#J(i[hn]);if(n+1>t[Kt][Le]?t[Dt](s):t.insertBefore(s,t[Kt][n+1]),"string"!=typeof i[hn]){for(const[e,s]of o.entries(i[hn][ci]))this.#X(t[Kt][n],e,s||"",i[hn]);this.#Q(i[hn],t[Kt][n])}}#X(t,e,i,n){null==i?t[_removeAttribute](e):null!=t&&t[jn](e,i)}#Q(t,e){if("string"!=typeof t)for(const i in t.children.filter((t=>"string"!=typeof t))){if(null==e)continue;const n=t.children[+i],s=e.children[+i];if("string"!=typeof n){for(const[t,e]of o.entries(n[ci]))this.#X(s,t,e||"",n);this.#Q(n,s)}}}#q(t,e){let i=t,n=s.from(i.childNodes).filter((t=>t.nodeType===u[St]||t.nodeType===u[wt]&&""!==t[ji]?.trim()))||[];for(const t of e)i=n[t],null!=i&&(n=s.from(i.childNodes).filter((t=>t.nodeType===u[St]||t.nodeType===u[wt]&&""!==t[ji]?.trim()))||[]);return i}#J(t){const i=e.createElement(t.tag);if(t[ci])for(const[e,n]of o.entries(t[ci]))e[Nt](":")||e[Nt]("@")||void 0!==n&&i[jn](e,n);for(const n of t[Kt])"string"==typeof n?i[Dt](e[mn](n)):i[Dt](this.#J(n));return i}}}("undefined"==typeof window?window={}:window);export const editor = window.MDEditor; export const MDEditor = window.MDEditor; export const viewer = window.MDViewer; export const MDViewer = window.MDViewer;
