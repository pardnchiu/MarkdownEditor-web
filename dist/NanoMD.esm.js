!function(){const t=window,e=document,i=String,n=Boolean,s=Array,o=Object,l=JSON,r=Math,u=URL,h=Node,a=Date,c=Blob,d=parseInt,f="video/mp4",p="video/quicktime",g=["javascript","js","ts","html","css","xml","json","sql","java","python","ruby","php","cpp","csharp","swift","typescript","kotlin","go","rust","perl","bash"],m=t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)").matches,y="abcdefghijklmnopqrstuvwxyz0123456789";let v=new Map;const w=/\.([\w_-]+)?/gi,b=/\#([\w_-]+)?/i,A=/^\w+(?=[\#\.]*)/i,C=/[\"\']{0,1}([\u0020\u00A0\u0009]*)(mailto\:)?([\u0020\u00A0\u0009]*)(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)([\u0020\u00A0\u0009]*)[\"\']{0,1}/,$=/(\s{1})\\?[\#＃]{1}([\u4e00-\u9fff\u3040-\u30ff\uac00-\ud7a3a-zA-Z0-9_]+)/,M=/[& \<\>\"\']/g,_=/\[([^\]\n]+)?\]\(([^\)\n\u0020\u00A0\u0009]+)([\u0020\u00A0\u0009]*[\"\']([^\)\n]+)[\"\'])?\)/,T=/(\n)(\>\s*\[\!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]\n)?(\>[^\n]*(\n)?)+/,I=/\`([^\n\`]*)\`/,N=/^\n|\n$/g,S=/\`{3}(\w*)([\s\S]*?)\s*\`{3}/,x=/((\n([\u0020\u00A0]{4,}|[\u0009]))[^\n]+)+/,k=/\*([^\n\*]*)\*/,D=/\_([^\n\_]*)\_/,E=/^\s|\s$/g,P=/(\n[\u0020\u00A0\u0009]*|\n[\u0020\u00A0\u0009]*>[\u0020\u00A0\u0009]*|\n[\u0020\u00A0\u0009]*([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+)\\?(\#{1,6})[\u0020\u00A0\u0009]+([^\n]+)/,L=/(\n)([^\n]+)\n\={3,}([\u0020\u00A0\u0009]*\n)/,j=/(\n)([^\n]+)\n\-{3,}([\u0020\u00A0\u0009]*\n)/,R=/([\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*)\\?(\#{1,6})[\u0020\u00A0\u0009]+([^\n\|]*)([\u0020\u00A0\u0009]*)/,O=/(\n[\u0020\u00A0\u0009]*)(\*{3,}|\-{3,})([\u0020\u00A0\u0009]*\n)/,F=/\!\[([^\]\n]+)?\]\(([^\)\n\u0020\u00A0\u0009]+)([\u0020\u00A0\u0009]*[\"\']([^\)\n]+)[\"\'])?\)(\(([0-9]+\%?)?[\u0020\u00A0\u0009\*x]+([0-9]+\%?)?([\u0020\u00A0\u0009]+(left|right))?\))?/,H=/^['"].*['"]$/,z=/\n(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+(.+)(\n.*\S.*)*)+/,B=/(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+(.+)(\n.*\S.*)*)+/,U=/^(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]*[^\n]+)/,G=/\={2}([^\n\=]*)\={2}/,K=/\~{2}([^\n\~]*)\~{2}/,Z=/\*{2}([^\n\*]*)\*{2}/,q=/\_{2}([^\n\_]*)\_{2}/,W=/\~([^\n\~]*)\~/,V=/\^([^\n\^]*)\^/,Y=/(\n(?![\{\<])[^\n]+)+/,J=/^(\n?(?![\{\<])[^\n]+)+/,X=/\.mov$/,Q=/\.mp4$/,tt=/[A-Za-z\%]/,et=/[\"\']{0,1}([\u0020\u00A0\u0009]*)(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))([\u0020\u00A0\u0009]*)[\"\']{0,1}/,it=/(\<[\u00A0\u0020\u0009\>]*\/?[\u00A0\u0020\u0009\>]*br[\u00A0\u0020\u0009\>]*\/?[\u00A0\u0020\u0009\>]*\>|\n)/,nt=/\n/,st=/\\\!/g,ot=/\\\`/g,lt=/\\\#/g,rt=/\\\*/g,ut=/\\\_/g,ht=/\\\~/g,at=/\\\^/g,ct=/\\\=/g,dt=/\\\</g,ft=/\\\>/g,pt=/\\\[/g,gt=/\\\]/g,mt=/\\\(/g,yt=/\\\)/g,vt=/\$/g,wt=/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?/,bt="mailto:",At="\n",Ct="_blank",$t="startsWith",Mt="keys",_t="TEXT_NODE",Tt="ELEMENT_NODE",It="nodeType",Nt="add",St="alt",xt="appendChild",kt="as",Dt="auto",Et="baseOffset",Pt="blockquote",Lt="body",jt="br",Rt="button",Ot="charAt",Ft="checked",Ht="checkbox",zt="childNodes",Bt="children",Ut="class",Gt="clearTimeout",Kt="clipboardData",Zt="code",qt="Color",Wt="color",Vt="content",Yt="contentEditable",Jt="controls",Xt="copy",Qt="create",te="ctrlKey",ee="dark",ie="dataset",ne="delay",se="display",oe="div",le="editor",re="em",ue="empty",he="emptyContent",ae="error",ce="float",de="floor",fe="focus",pe="fontFamily",ge="forEach",me="from",ye="get",ve="has",we="head",be="height",Ae="hide",Ce="href",$e="id",Me="iframe",_e="img",Te="index",Ie="init",Ne="inner",Se="input",xe="insert",ke="isArray",De="join",Ee="label",Pe="language",Le="lastChild",je="lazy",Re="length",Oe="li",Fe="light",He="link",ze="list",Be="loading",Ue="map",Ge="mark",Ke="match",Ze="metaKey",qe="min",We="mode",Ve="Name",Ye="name",Je="node",Xe="none",Qe="number",ti="object",ei="offset",ii="ol",ni="outerHTML",si="parent",oi="pd-md-editor",li="pd-md-viewer",ri="placeholder",ui="pre",hi="props",ai="preload",ci="prettyprint",di="prevent",fi="push",pi="px",gi="querySelector",mi="random",yi="rel",vi="remove",wi="replace",bi="click",Ai="script",Ci="scroll",$i="section",Mi="set",_i="slice",Ti="source",Ii="span",Ni="split",Si="src",xi="string",ki="strong",Di="style",Ei="sub",Pi="success",Li="sup",ji="table",Ri="tag",Oi="target",Fi="tbody",Hi="td",zi="temp",Bi="test",Ui="textContent",Gi="th",Ki="thead",Zi="title",qi="toLowerCase",Wi="toUpperCase",Vi="tr",Yi="trim",Ji="type",Xi="ul",Qi="value",tn="video",en="viewer",nn="width",sn="console",on="apply",ln="void",rn="vdom",un="getElementById",hn="crossOrigin",an="preconnect",cn=Nt+"EventListener",dn="background"+qt,fn=Ut+Ve,pn=Ut+"List",gn=Qt+"DocumentFragment",mn=Qt+"Element",yn=Qt+"TextNode",vn=me+"CharCode",wn=fe+"Background"+qt,bn=fe+"Offset",An=fe+"Text"+qt,Cn=ye+"Data",$n=ye+"Selection",Mn=ve+"OwnProperty",_n=Te+"Of",Tn=Ne+"HTML",In=Ne+"Text",Nn=xe+"Before",Sn=Je+Ve,xn=Je+"Value",kn="onclick",Dn="onwheel",En=si+"Element",Pn=si+"Node",Ln=ri+qt,jn=di+"Default",Rn=di+"Refresh",On=gi+"All",Fn=vi+"AllRanges",Hn=Ci+"Height",zn=Ci+"Sync",Bn=Ci+"Top",Un=Mi+"Attribute",Gn=Mi+"Data",Kn=Mi+"End",Zn=Mi+"Start",qn=Mi+"Timeout",Wn=Ri+Ve,Vn=Ri+"Path",Yn=Ri+"Target";let Jn="";const Xn="@excl@",Qn="@grave@",ts="@num@",es="@ast@",is="@lowbar@",ns="@tilde@",ss="@Hat@",os="@equal@",ls="@lt@",rs="@gt@",us="@lsqb@",hs="@rsqb@",as="@lpar@",cs="@rpar@",ds="@dollar@",fs="&lt;",ps="&gt;",gs="&amp;",ms="&nbsp;",ys="&quot;",vs="&apos;",ws={create:"CREATE",append:"APPEND",replace:"REPLACE",text:"TEXT",prop:"PROP",remove:"REMOVE"};Array[me]({[Re]:26},((t,e)=>i[vn](97+e)))[ge](((e,n)=>{let s=n<10,o=n>=10&&n<20,l=n>=20,r=i(n),u=r[Ot](r[Re]-1),h=i=>{Jn+=i?e[Wi]():e,t[(i?"$":"_")+(l?"_":"")+u+(o?"_":"")]=i?e[Wi]():e};h(0),h(1),s&&(Jn+=n,t["_"+e]=n)}));t._a,t._b,t._c,t._d,t._e,t._f,t._g,t._h,t._i,t._j;const bs=t._0,As=t._1,Cs=(t._2,t._3,t._4,t._5,t._6),$s=t._7,Ms=t._8,_s=(t._9,t._0_,t._1_,t._2_,t._3_,t._4_,t._5_,t._6_,t._7_,t._8_),Ts=(t._9_,t.__0),Is=(t.__1,t.__2,t.__3,t.__4,t.__5,t.$0,t.$1,t.$2,t.$3,t.$4,t.$5,t.$6,t.$7,t.$8,t.$9,t.$0_,t.$1_,t.$2_,t.$3_,t.$4_,t.$5_,t.$6_,t.$7_,t.$8_,t.$9_,t.$_0,t.$_1,t.$_2,t.$_3,t.$_4,t.$_5,"https://fonts.googleapis.com"),Ns=Is+"/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0&display=swap",Ss="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js",xs="https://cdn.jsdelivr.net/npm/@pardnchiu/nanomd@1.9.1/dist/NanoMD.css",ks="NanoMD\nGitHub: https://github.com/pardnchiu/NanoMD\nCreator: Pardn Chiu\nLicense: Proprietary";let Ds;for(let t of[Es(He,{[yi]:an,[Ce]:"https://fonts.gstatic.com",[hn]:""}),Es(He,{[yi]:an,[Ce]:Is,[hn]:""}),Es(He,{[yi]:ai,[Ce]:Ns,[kt]:Di,[hn]:"anonymous"}),Es(He,{[yi]:"stylesheet",[Ce]:Ns}),Es(He,{[yi]:"preconnect",[Ce]:"https://cdn.jsdelivr.net"}),Es(He,{[yi]:ai,[Ce]:Ss,[kt]:Ai}),Es(Ai,{[Si]:Ss}),Es(He,{[yi]:ai,[Ce]:xs,[kt]:Di}),Es(He,{[yi]:"stylesheet",[Ce]:xs})])e[we][xt](t);function Es(t="",i,n){const s=((t[Ke](A)||[])[0]||"")[Yi](),o=((t[Ke](b)||[])[1]||"")[Yi](),l=(w[Bi](t)?t[Ke](w):[])[Ue]((t=>t[wi](/^\./,"")));if(s[Re]<1)return;let r,u,h,a=!1;if(t===zi?(a=!0,r=e[gn]()):r=e[mn](s),91!=ks[Re])return r;o[Re]&&(r.id=o);for(let t of l)r[pn][Nt](t);if(null==i&&null!=n&&([i,n]=[n,null]),null!=i&&null!=n)[u,h]=[i,n];else if(null==n)typeof i===xi||typeof i===Qe||Array[ke](i)?h=i:u=i;else if(null==i)return r;if(typeof u===ti&&null!=u)for(const t in u){if(!u[Mn](t))continue;const e=u[t];-1!=[Qi,In,Tn,Ui,Yt][_n](t)?r[t]=e:-1!=[Wt,dn,nn,be,se,ce][_n](t)?r[Di][t]=e:null!=e&&r[Un](t,e)}if(null!=h){const t=typeof h===xi,i=typeof h===Qe,n=Array[ke](h);if(t||i){const t=h;s===_e||s===Ti?r[Si]=t:a?r[xt](e[yn](h)):r[Tn]=t}else if(n)for(let t of h){const i=t instanceof Element;typeof t===xi||typeof t===Qe?a?r[xt](e[yn](t)):r[Tn]+=t:i&&r[xt](t)}}return r}function Ps(t=""){return t[wi](M,(t=>({"&":gs," ":ms,"<":fs,">":ps,'"':ys,"'":vs}[t])))}function Ls(t,e=""){return new RegExp(t,e)}function js(t){if(t)return t[fn]===oi||t[Sn][qi]()===oe&&t[Pn][fn]===oi?t:js(t[Pn])}function Rs(t){const e=Es(oe);return e[xt](t),e[Tn]}function Os(t=""){if((t=t[Yi]())[Re]<1)return"";const e=t[Ke](wt)||[];return e[Re]>2&&11===e[1][Re]?e[1]:""}function Fs(t=""){if((t=t[Yi]())[Re]<1)return"";const e=t.match(/(?:https?:\/\/)?(?:www\.)?vimeo\.com\/(?:channels\/[\w]+\/|groups\/[\w]+\/videos\/|album\/\d+\/video\/|video\/|)(\d+)/);return e?e[1]:null}function Hs(t,e="",i="",n="",s="",o=""){const l=zs(i),r=n instanceof HTMLElement?n:Es(i,n);return v[Mi](l,r[ni]),e[wi](t,s+l+o)}function zs(t=""){let e="{{"+(t[Yi]()||Dt)+"-";for(let t=0;t<64;t++)e+=y[Ot](r[de](36*r[mi]()));return e+="}}",v[ve](e)?zs(t):e}function Bs(t=""){let i;for(let e of t[Ke](Ls(T,Cs))||[]){const s=e[Ke](T),o=s[1]||"",l=s[3]||"",r=s[5]||"";i=Es(Pt+(l[Re]?"."+l:"")),n(e,l),t=Hs(e,t,Pt,i,o,r)}function n(t,e=""){let n=Ys(t[Yi]()[wi](/^\>[\u00A0\u0020\u0009]?/,"")[wi](/\n\>[\u00A0\u0020\u0009]?/g,"\n"))[Ni](nt);for(let t in n){const o=n[t];i[xt](s(o,d(t),e))}}function s(t,n=0,o=""){let l=Es(zi);const r=/^[\u00A0\u0020\u0009]*\>[\u00A0\u0020\u0009]?/,u=t[wi](r,"");if(/\[\!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]/[Bi](t)&&0===n)l[xt](Es(Ii+".hint",[-1!=["NOTE","TIP","IMPORTANT","WARNING","CAUTION"][_n](o)?Es("span.material-symbols-outlined",{NOTE:"info",TIP:"lightbulb",IMPORTANT:"sms",WARNING:"warning",CAUTION:"error"}[o]||""):null,o])),l[xt](Es(jt));else if(r[Bi](t)){let t=Es(Pt);t[xt](s(u)),l[xt](t)}else/^[\u00A0\u0020\u0009]*\{\{/[Bi](t)?l[xt](i[xt](e[yn](t))):l[xt](Es(Ii,t));return l}return t}function Us(t=""){let e=[[Zt,I]];for(let i of e){const e=i[0],n=i[1];for(let i of t[Ke](Ls(n,Cs))||[]){const s=i[Ke](n);if(E[Bi](s[1]||""))continue;let o=(s[1]||"")[Yi]();o[Re]<1||(e!=Zt?t=t[wi](i,Es(e,o)[ni]):(o=Ps(o),t=Hs(i,t,e,o)))}}return t}function Gs(t){let e=0,i=Es(ii);for(let n in t){const s=t[n];0===d(n)&&(e=r.floor((s[Ke](/^\s*/)||[""])[0][Re]/4));const o=Ls(`^\\s{0,${4*e}}`);i[xt](Es(Oe,Ps(s[wi](o,""))))}return i}function Ks(t=""){let e=[[ki,Z],[ki,q],[_s,K],[Ge,G],[re,k],[re,D],[Li,V],[Ei,W]];for(let t of e){i(t[0],t[1])}function i(e,i){for(let n of t[Ke](Ls(i,Cs))||[]){const s=n[Ke](i);if(E[Bi](s[1]||""))continue;let o=(s[1]||"")[Yi]();o[Re]<1||(e!=Zt?t=t[wi](n,Es(e,o)[ni]):(o=Ps(o),t=Hs(n,t,e,o)))}}return t}function Zs(t="",e="",n=Ct){if(i(e||"")[Yi]()[Re]<1)return t;for(let i of t[Ke](Ls($,Cs))||[]){if(i[Ke](/^\\/))continue;const s=i[Ke]($);if(s[Re]<1)continue;const o=s[1],l=(s[2]||"")[Yi](),r=zs(bs);if(l[Re]<1)continue;const u=Es(zi,[Es(bs+"."+Ri,{[Ce]:e+l,[Oi]:n===Ct?Ct:"_self"},l)]);v[Mi](r,Rs(u)),t=t[wi](i,o+r)}return t}function qs(t=""){return(()=>{for(let e of t[Ke](Ls(P,Cs))||[]){const i=e[Ke](P);if(i[Re]<1)continue;const n=i[1]||"",s=(i[3]||"")[Yi]()[Re],o=(i[4]||"")[Yi]();0!=r[qe](s,o[Re])&&(t=Hs(e,t,$s+s,o,n))}})(),(()=>{for(let e of t[Ke](Ls(R,Cs))||[]){const i=e[Ke](R);if(i[Re]<1)continue;const n=i[1]||"",s=(i[2]||"")[Yi]()[Re],o=(i[3]||"")[Yi](),l=i[4]||"";0!=r[qe](s,o[Re])&&(t=Hs(e,t,$s+s,o,n,l))}})(),(()=>{for(let e of t[Ke](Ls(L,Cs))||[]){const i=e[Ke](L);if(i[Re]<1)continue;const n=i[1]||"",s=(i[2]||"")[Yi](),o=i[3]||"";s[Re]<1||(t=Hs(e,t,$s+1,s,n,o))}})(),(()=>{for(let e of t[Ke](Ls(j,Cs))||[]){const i=e[Ke](j);if(i[Re]<1)continue;const n=i[1]||"",s=(i[2]||"")[Yi](),o=i[3]||"";s[Re]<1||(t=Hs(e,t,$s+2,s,n,o))}})(),t}function Ws(t=""){for(let e of t[Ke](Ls(O,Cs))||[]){const i=e[Ke](O);if(i[Re]<1)continue;const n=i[1]||"",s=i[3]||"",o=zs("HR");v[Mi](o,"<hr>"),t=t[wi](e,n+o+s)}return t}function Vs(t=""){const e="this.parentElement.nextElementSibling.style.display='block';this.parentElement.style.display='none'",i="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDEyMCAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF8yNTkyXzMwNDkpIj4KPHBhdGggZD0iTTEyMCA2MEMxMjAgMjYuODYyOSA5My4xMzcxIDAgNjAgMEMyNi44NjI5IDAgMCAyNi44NjI5IDAgNjBDMCA5My4xMzcxIDI2Ljg2MjkgMTIwIDYwIDEyMEM5My4xMzcxIDEyMCAxMjAgOTMuMTM3MSAxMjAgNjBaIiBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIwLjUiLz4KPHBhdGggZD0iTTg0LjM2MzMgNTYuNTgwM0M4Ni45MzAyIDU4LjEzNzYgODYuOTMwMiA2MS44NjI2IDg0LjM2MzMgNjMuNDE5OUw1MS44MjQ4IDgzLjE2MTJDNDkuMTU5MSA4NC43Nzg2IDQ1Ljc1IDgyLjg1OTQgNDUuNzUgNzkuNzQxNFY0MC4yNTg4QzQ1Ljc1IDM3LjE0MDggNDkuMTU5MSAzNS4yMjE2IDUxLjgyNDggMzYuODM4OUw4NC4zNjMzIDU2LjU4MDNaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzI1OTJfMzA0OSI+CjxyZWN0IHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPg==";function n(t,n,s,o){return Rs(Es(zi,[Es(bs,{[Zi]:o,[Ce]:n,[Oi]:Ct},s||n),Es("section.more",[Es("img.cover","https://i.ytimg.com/vi/"+t+"/mqdefault.jpg"),Es("img.icon",{[kn]:e},i)]),Es(Me,{[Be]:je,[nn]:"640px",[Si]:"https://www.youtube.com/embed/"+t,frameborder:0,allow:"accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:"",[se]:Xe})]))}function s(t,n,s,o){const l=function(t){const e=`https://vimeo.com/api/v2/video/${t}.json`;let i=null;const n=new XMLHttpRequest;n.open("GET",e,!1);try{n.send(),200===n.status?i=JSON.parse(n.responseText)[0].thumbnail_large:console.error("HTTP 錯誤:",n.status)}catch(t){console.error("無法獲取縮圖:",t)}return i}(t);return Rs(Es(zi,[Es(bs,{[Zi]:o,[Ce]:n,[Oi]:Ct},s||n),Es("section.more",[Es("img.cover",l),Es("img.icon",{[kn]:e},i)]),Es(Me,{[Be]:je,[nn]:"640px",[Si]:"https://player.vimeo.com/video/"+t,frameborder:0,allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:"",[se]:Xe})]))}return(()=>{for(let e of t[Ke](Ls(_,Cs))||[]){const i=e[Ke](_);if(i[Re]<1)continue;const o=(i[1]||"")[Yi](),l=(i[2]||"")[Yi](),u=(i[4]||"")[Yi](),h=(Os(l)||"")[Yi](),a=(Fs(l)||"")[Yi]();if(0!=r[qe](o[Re],l[Re]))if(h[Re])t=Hs(e,t,oe,n(h,l,o,u));else if(a[Re])t=Hs(e,t,oe,s(a,l,o,u));else{const i=Es(bs,{[Zi]:u,[Ce]:l,[Oi]:Ct},o);t=Hs(e,t,bs,i)}}})(),(()=>{for(let e of t[Ke](Ls(et,Cs))||[]){if(e[Ke](H))continue;const i=e[Ke](et);if(i[Re]<1)continue;const o=i[1]||"",l=(i[2]||"")[Yi](),r=i[5]||"",u=(Os(l)||"")[Yi](),h=(Fs(l)||"")[Yi]();if(!(l[Re]<1))if(u[Re])t=Hs(e,t,oe,n(u,l),o,r);else if(h[Re])t=Hs(e,t,oe,s(h,l));else{const i=Es(bs,{[Ce]:l,[Oi]:Ct},l);t=Hs(e,t,bs,i,o,r)}}})(),(()=>{for(let e of t[Ke](Ls(C,Cs))||[]){if(e[Ke](H))continue;const i=e[Ke](C);if(i[Re]<1)continue;const n=(i[1]||"")+(i[2]||"")+(i[3]||""),s=(i[4]||"")[Yi](),o=i[8]||"";if(s[Re]<1)continue;const l=Es(bs,{[Ce]:bt+s,[Oi]:Ct},s);t=Hs(e,t,bs,l,n,o)}})(),t}function Ys(t=""){for(let i of t[Ke](Ls(z,Cs))||[])e(i);function e(e){let i;e[Yi]()[wi](Ls(it,Cs),At)[Ni](it)[ge](((t,e)=>{const n=t[Ke](B)||[],s=n[Re]<1?null:/\d+\./[Bi]((n[2]||"")[Yi]())?ii:Xi,o=(t[Ke](/\s{4}/g)||[])[Re];let l=n[Re]<1?t[wi](/^\s*([\-\*\+]|\d+\.)?\s*/g,""):(n[3]||"")[Yi]();if(0===d(e)&&null==s)return;0===d(e)&&(i=Es(s));let r=i;function u(t,e){if(/^\[\s*(\x)?\s*\]/[Bi](e)){const i=e[Yi]()[Ke](/^\[\s*(\x)?\s*\]/);e=e[wi](/^\[\s*(\x)?\s*\]\s*/,"");const n=null!=i[1];t[xt](Es(Oe,[Es(Ee,[Es(Se,{[Ji]:Ht,[Ft]:n?"":null,[kn]:"return false;"}),Es(Ii,e)])]))}else t[xt](Es(Oe,e))}if(/^\s{0,3}([\-\*\+]|\d+\.)/[Bi](t))u(r,l);else if(/^\s{4,}([\-\*\+]|\d+\.)/[Bi](t)){r=i[Le];for(let t=0;t<o&&(null!=r&&null!=r[Wn]);t++)if(t==o-1&&r[Wn][qi]()==Oe)if(r[Le]instanceof HTMLElement&&(r[Le][Wn][qi]()==ii||r[Le][Wn][qi]()==Xi))u(r[Le],l);else if(/^\[\s*(\x)?\s*\]/[Bi](l)){const t=l[Yi]()[Ke](/^\[\s*(\x)?\s*\]/);l=l[wi](/^\[\s*(\x)?\s*\]\s*/,"");const e=null!=t[1];r[xt](Es(s,[Es(Oe,[Es(Ee,[Es(Se,{[Ji]:Ht,[Ft]:e?"":null,[kn]:"return false;"}),Es(Ii,l)])])]))}else r[xt](Es(s,[Es(Oe,l)]));else r=r[Le][Le]}else{if(null==i)return;for(r=i[Le];null!=r[Le];)r=r[Le];if(r instanceof HTMLElement);else if(/^\{\{(h\d|img|pre)/[Bi](r[xn]||""));else{for(;r[En][Wn][qi]()!=Oe;)r=r[En];r[En][xt](Es(jt))}r[En][Tn]+=l}})),null!=i&&(t=Hs(e,t,ze,i))}return t}function Js(t=""){for(let e of t[Ke](Ls(F,Cs))||[]){const i=e[Ke](F);if(i[Re]<1)continue;const n=(i[1]||"")[Yi](),s=(i[2]||"")[Yi](),o=(i[4]||"")[Yi]();let l=(i[6]||"")[Yi](),r=(i[7]||"")[Yi](),u=(i[9]||"")[Yi]();if(s[Re]<1)continue;l[Re]&&!tt[Bi](l)&&(l+=pi),r[Re]&&!tt[Bi](r)&&(r+=pi);const h=X[Bi](s),a=Q[Bi](s);let c;c=h?Es(tn,{[Jt]:"",[Zi]:o,[nn]:l||null,[be]:r||null},[Es(Ti,{[Ji]:p},s)]):a?Es(tn,{[Jt]:"",[Zi]:o,[nn]:l||null,[be]:r||null},[Es(Ti,{[Ji]:f},s)]):Es(_e,{[St]:n,[Zi]:o,[nn]:l||null,[be]:r||null,[ce]:u[Re]?u:null},s),null!=c&&(t=Hs(e,t,_e,c))}return t}function Xs(t=""){for(let e of t[Ke](Ls(S,Cs))||[]){const i=e[Ke](S);if(i[Re]<1)continue;const n=null==i[2][Ke](N),s=n?"":(i[1]||"")[Yi]()[qi](),o=i[2]||"",l=-1!=g[_n](s),r=o[wi](N,"")[Ni](nt);let u;u=n?Es(Zt+"."+ci,Ps(o)):Es(ui+"."+ci,{[Ye]:s},[Es(Zt+(l?"."+Pe+"-"+s:""),{[Ye]:s},[Gs(r)]),Es(Rt+"."+Xt)]),t=Hs(e,t,n?Zt:ui,u)}return t}function Qs(t=""){for(let e of t[Ke](Ls(x,Cs))||[]){const i=e[Ke](x);if(i[Re]<1)continue;const n=i[2]||"",s=e[wi](N,"")[Ni](nt),o=Es(ui+"."+ci,[Es(Zt,[Gs(s)]),Es(Rt+"."+Xt)]);t=Hs(e,t,ui,o,n)}return t}function to(t=""){let e;function i(t){const e=t[Ke](/^([\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*)+/)||[],i=t[Ke](/[\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*$/)||[];return[e[0]||"",i[0]||""]}function n(t){const i=t[Yi]()[Ni](nt);e=Es(zi,[Es(ji,[Es(Ki),Es(Fi)])]);let n=!0,o=[],l=0;for(let t in i){const r=i[t],u=r[Ke](/((\s*)\|?((?:.*?\|)*.*)\|?)+/)||[];if(u[Re]<1)continue;const h=(u[3]||"")[Yi]()[wi](/[\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*$/,""),a=/^[\u0020\u00A0\u0009]*\|?([\u0020\u00A0\u0009]*[\-\:]+[\u0020\u00A0\u0009]*\|?)+[\u0020\u00A0\u0009]*$/[Bi](r),c=h[Ni](/[\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*/);if(0===d(t)&&(l=c[Re]),a){for(let t of r[wi](/^([\u0020\u00A0\u0009]*\|)|(\|[\u0020\u00A0\u0009]*)$/g,"")[Ni](/\|/))/^\-+\:$/[Bi](t[Yi]())?o.push("right"):/^\:\-+\:$/[Bi](t[Yi]())?o.push("center"):o.push("left");const t=[...e.firstChild.firstChild.childNodes[0].childNodes];for(let e in t)t[e].setAttribute("align",o[e]);n=!1}else s(n,c,l,o)}}function s(t=!0,i=[],n=0,s=[]){const o=t?e.firstChild.firstChild:e.firstChild[Le],l=Es(Vi);for(let e=0;e<n;e++)l[xt](Es(t?Gi:Hi,{align:s[e]},i[e]||""));o[xt](l)}return(()=>{const s=/([^\n]*)(?:[\u0020\u00A0\u0009]*\|[^\n]*\|[^\n]*\n)[\u0020\u00A0\u0009]*\|([\u0020\u00A0\u0009\-\:]*\|)+\n(?:[\u0020\u00A0\u0009]*\|[^\n]*\|[^\n]*\n)*/;for(let o of t[Ke](Ls(s,Cs))||[])U[Bi](o)||(n(o),t=Hs(o,t,ji,Rs(e),...i(o)))})(),(()=>{const s=/(([^\n]+\|)*[^\n]+\n)(([\u0020\u00A0\u0009\-\:]+\|)*[\u0020\u00A0\u0009\-\:]+\n)(?:([^\n]+\|)*[^\n]+\n)*/;for(let o of t[Ke](Ls(s,Cs))||[])n(o),t=Hs(o,t,ji,Rs(e),...i(o))})(),t}function eo(t=""){return t=t[wi](/\n[\u0020\u00A0\u0009]*/g,"\n"),(()=>{for(let e of t[Ke](Ls(J,Cs))||[]){const i=e[Ke](J);if(i[Re]<1)continue;const n=i[2]||"",s=(i[0]||"")[Yi]();if(s[Re]){const i=Es(zi,[Es("p",s)]),o=zs("p");v[Mi](o,Rs(i)),t=t[wi](e,n+o)}}})(),(()=>{for(let e of t[Ke](Ls(Y,Cs))||[]){const i=e[Ke](Y);if(i[Re]<1)continue;const n=i[2]||"",s=(i[0]||"")[Yi]();if(s[Re]){const i=Es(zi,[Es("p",s)]),o=zs("p");v[Mi](o,Rs(i)),t=t[wi](e,n+o)}}})(),t}function io(t=""){t=t[wi](/^\n*|\n*$/g,"");const e=/(&lt;br&gt;)/g;return e[Bi](t)?t[wi](e,"\n"):t}function no(t="",e="",i=Ct){t=t[wi](st,Xn)[wi](ot,Qn)[wi](lt,ts)[wi](rt,es)[wi](ut,is)[wi](ht,ns)[wi](at,ss)[wi](ct,os)[wi](dt,ls)[wi](ft,rs)[wi](pt,us)[wi](gt,hs)[wi](mt,as)[wi](yt,cs)[wi](vt,ds)[wi](/[\u00A0\u0020]/g," ");let n=[Xs,Us,Js,Vs,Ks,qs,Ws,to,Bs,Ys,Qs,Zs,io,eo];for(let s of n)t=s(t,e,i);for(;/\{{2}\w*\-*\w{64}\}{2}/[Bi](t);)for(let e of t[Ke](/\{{2}\w*\-*\w{64}\}{2}/g)||[]){let i=Ls(e);t=t[wi](i,v[ye](e))}const s=["h1","h2","h3","h4","h5","h6",ji,ii,Xi,ui,Pt,"details","hr",Ee];for(let e of s){const i=Ls(`[  \t]*\\n[  \t]*<${e}`,Cs),n=Ls(`${e}>[  \t]*\\n[  \t]*`,Cs);t=t[wi](i,`<${e}`)[wi](n,`${e}>`)}return t=t[wi](Ls(Xn,Cs),"&excl;")[wi](Ls(Qn,Cs),"&grave")[wi](Ls(ts,Cs),"&num;")[wi](Ls(es,Cs),"&ast;")[wi](Ls(is,Cs),"&lowbar;")[wi](Ls(ns,Cs),"&tilde;")[wi](Ls(ss,Cs),"&Hat;")[wi](Ls(os,Cs),"&equal;")[wi](Ls(ls,Cs),fs)[wi](Ls(rs,Cs),ps)[wi](Ls(us,Cs),"&lsqb;")[wi](Ls(hs,Cs),"&rsqb;")[wi](Ls(as,Cs),"&lpar;")[wi](Ls(cs,Cs),"&rpar;")[wi](Ls(ds,Cs),"&dollar;")[wi](/([\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*){2,}/g,"<br>")}document.addEventListener("DOMContentLoaded",(t=>{!function(...t){const i=Es(Ai,`${sn}.log.${on}(${ln} 0, ${JSON.stringify(t)});`);e[Lt][xt](i),i[vi]()}("%c"+ks,"line-height: 1.75rem; font-size: 0.875rem;")}));class so{#t="";#e;#i=!0;#n=!0;#s;#o;#l;#r;#u;#h;#a;constructor(s={}){this.#t=(s.defaultContent||"")[Yi]();const o=s[Di]||{},l=i(o[We]||Dt)[Yi]()[qi](),r=n(null==o.fill?1:o.fill)?1:0,u=i(o[pe]||"")[Yi]()||"'Roboto Mono', monospace",h=n(null==o.showRow?1:o.showRow)?1:0,a=o.placeholder||{},c=i(a.text||"Type here ..."),d=i(a.color||"#bfbfbf"),f=o.focus||{},p=i(f.backgroundColor||"#0000ff1a"),g=i(f.color||"#0000ffff");e[we][xt](Es(Di,`\n.${oi}{font-family: ${u}}\n.${oi}>div[data-focus="1"]{background-color:${p};color:${g};caret-color:${g}}\n.${oi}>div[data-last="1"]:empty::after{content:"${c}";color:${d} !important;caret-color:${g}}`));const y=document[un](s[$e]);typeof s[$e]===xi&&null!=y?(this[Lt]=y,y.classList.add(oi)):this[Lt]=Es($i+"."+oi),this[Lt][ie][We]=m&&l===Dt||l===ee?ee:"",this[Lt][ie].fill=r,this[Lt][ie].row=h,this[Lt][ie].pin={1:1,0:0,[!0]:1,[!1]:0}[s.tabPin]||0,this[Lt][ie].wrap={1:1,0:0,[!0]:1,[!1]:0}[s.wrap]||1,this[Lt][ie].saved=1,this.#a=new lo(this[Lt]);const v=this[Lt];if(this.#i=n(null==s.hotKey||s.hotKey),this.#n=n(null==s.autoSave||s.autoSave),this.#s=s.event||{},null==this.#l&&s[Rn]&&(this.#l=t[cn]("beforeunload",(t=>{t[jn]()}))),null!=s[We]){let t=i(s[We]||Dt)[Yi]()[qi]();this[Lt][ie][We]=m&&t===Dt||t===ee?ee:""}if(null!=s.fillMode){let t=n(s.fillMode)?1:0;this[Lt][ie].fill=t}if(null!=s.showRow){let t=n(s.showRow)?1:0;this[Lt][ie].row=t}if(null!=s[pe]){let t=i(s[pe])[Yi]()||"'Roboto Mono', monospace";e[we][xt](Es(Di,`.${oi}{font-family: ${t}}`))}let w=i(s[wn]||"")[Yi]()||p,b=i(s[An]||"")[Yi]()||g;e[we][xt](Es(Di,`.${oi}>div[data-focus="1"]{background-color:${w};color:${b}`));let A=i(s[ri]||"")[Yi]()||c,C=i(s[Ln]||"")[Yi]()||d;e[we][xt](Es(Di,`.${oi}>div[data-last="1"]:empty::after{content:"${A}";color:${C}}`)),v.onmousedown=v.onmouseup=v.ontouchend=t=>{if(t.target[Wn][qi]()!==oe)return t[jn](),!1;this.#c()},v.oncut=t=>(this.#d(),this.#f((e=>{t[Kt][Gn]("text/plain",this.#h.body),v[Bt][this.#h.start][Tn]=Ps(this.#h.left+this.#h.right),this.#p(),this.#g(v[Bt][this.#h.start],this.#h.left[Re])})),this.#m(!0,!1),!1),v.onpaste=e=>(this.#d(),this.#f((i=>{const n=((e[Kt]||t[Kt])[Cn]("Text")||"")[Ni](/\n/),s=n[Re],o=s-1,l=s>1,r=this.#h.start+o,u=`${l?"":this.#h.left}${n[o]}`[Re],h=n[0],a=l?"":this.#h.right;if(v[Bt][this.#h.start][In]=this.#h.left+h+a,this.#p(),l)for(let t=1;t<s;t++){const e=n[t],i=Es(oe,Ps(`${e}${t===o?this.#h.right:""}`));i[kn]=t=>this.#c(),v[Nn](i,v[Bt][this.#h.start+t])}this.#g(v[Bt][r],u,u)})),this.#m(!0,!1),!1),v.oninput=t=>{let e,i;if("deleteCompositionText"===t.inputType){e=this.#u.index,i=this.#u.offset;for(let t of[...v[Bt]]){if(t[Sn][qi]()===oe||t[Sn][qi]()===$i)continue;t[vi]();let n=Es(oe,{"data-index":e+1,index:e+1});n[kn]=t=>this.#c(),v[Nn](n,v[Bt][e]),this.#g(v[Bt][e],i)}}t.inputType;let n=this.#u.isMulti,s=this.#u.multi.left,o=t.data,l=this.#u.multi.right,r=this.#u.multi.start.offset;this.#c(),n&&(this.#o[In]=s+o+l,this.#g(this.#o,r+1)),this.#m(!0,300)},v.onkeydown=t=>!new ro({editor:this,hotKey:this.#i,[Rn]:s[Rn],event:t}).preventDefault,v.onkeyup=t=>{"Meta"!==t.key&&"Control"!==t.key&&(v[Bt]&&1===v[Bt][Re]&&v.firstElementChild[Sn][qi]()!==oe&&this[Ie](null,!0,!1),this.#c(),/^(Arrow(Up|Left|Down|Right)|CapsLock|Shift|Control|Alt|Clear|Escape|F\d+)$/[Bi](t.key)||this.#n&&this.#y())},v.onblur=t=>{this.#d()},this.init()}get viewer(){return this.#r}set viewer(t){this.#r=t}#v(){let t=Es("button",[Es("span.material-symbols-outlined","markdown"),"Markdown"]),i=Es("button",[Es("span.material-symbols-outlined","html"),"HTML"]),n=Es("button",[Es("span.material-symbols-outlined","cancel"),"Cancel"]),s=Es("div.nanomd-pop",[Es("strong","Export"),t,i,n]);t[kn]=t=>{this.download("md"),s.remove()},i[kn]=t=>{this.download("html"),s.remove()},n[kn]=t=>{s.remove()},e[Lt][xt](s)}#c(e,i=!1){this.#d(),this.#u=new oo(this[Lt],e,i);const n=t[$n]();if(n.rangeCount<1)return;const s=n.getRangeAt(0);let o=e||js(s.commonAncestorContainer);null!=o&&this.#w(o,this.#u.index||this.#u.multi.end.index)}#f(t){this.#h=new uo(this[Lt],this.#u),t()}#p(){this.#h.removeRows()}#g(i,n,s){const o=this[Lt][On](oe);for(let t in o){const e=o[t];if(isNaN(d(t)))continue;const i=d(t)+1;e[ie][Te]=i,i===o.length?e[ie].last=1:e[ie].last=0}if(t[$n]?t[$n]()[ue]?t[$n]()[ue]():t[$n]()[Fn]&&t[$n]()[Fn]():e[$n]&&e[$n]()[ue](),null==i)return;let l=t[$n](),r=e.createRange(),u=n??i[zt][0][Re],h=s??u;r.selectNode(i),i[zt][0]?(r[Zn](i[zt][0],u>i[zt][0][Re]?i[zt][0][Re]:u),r[Kn](i[zt][0],h>i[zt][0][Re]?i[zt][0][Re]:h)):(r[Zn](i,0),r[Kn](i,0)),l.addRange(r),this.#c(i)}#w(t,e){const i=$i+"."+Se+"-"+Rt;let n=this[Lt][gi](i);t[ie][fe]=1,this[Lt][Nn](n,this[Lt][Bt][e+1]),n[ie][Ae]=0,this.#o=t}#d(){if(!this.#o)return;const t=$i+"."+Se+"-"+Rt,e=this[Lt][gi](t);this.#o[ie][fe]=0,null!=e&&(this[Lt][xt](e),e[ie][Ae]=1),this.#o=null}#b(t){t=Ps(t);let e=this.#A;const i=Es(oe,t);i[kn]=t=>this.#c(),e[In][Yi]()[Re]<1?e[Tn]=t:this[Lt][xt](i),this[Lt][Bn]=this[Lt][Hn],this[en]&&(this[en][Lt][Bn]=this[en][Lt][Hn])}get#A(){let t=this[Lt].lastElementChild;return"SECTION"===t[Sn]&&(t=t.previousElementSibling),t}#C(t,e){const i=this[Lt][Bt][this.#h.start];i[Tn]=Ps(t),this.#p(),this.#g(i,e)}#$(t,e="",i=""){const n=t[Ze]||t[te]||e===i;this.#u.check?this.#f((t=>{const s=this.#h.left,o=this.#h.body,l=this.#h.right,r=`${s}${n?`<${i}>`:e}${o}${n?`</${i}>`:e}${l}`[wi](/\n/g,""),u=r[Re]-l[Re]-(n?i[Re]+3:e[Re]);this.#C(r,u),this.#m(!0,this.#n)})):(this.#b(n?`<${i}></${i}>`:`${e}${e}`),this.#g(this.#A,n?i[Re]+3:e[Re]),this.#m(!0,this.#n))}#M(t){this.#u.check?this.#f((e=>{const i=this.#h.start,n=this.#h.end;for(let e=i;e<=n;e++){const i=this[Lt][Bt][e];i[Tn]=Ps(`${t} ${i[In]}`)}const s=this[Lt][Bt][n],o=s[In][Re];this.#g(s,o),this.#m(!0,this.#n)})):(this.#b(t),this.#g(this.#A,t[Re]+1),this.#m(!0,this.#n))}#_(t="",e="",i){if(this.#u.check)return void this.#f((n=>{const s=this.#h.left,o=this.#h.right,l=`${s}${null==i?"":"!"}[${t}](${e}) ${o}`[wi](/\n/g,""),r=l[Re]-o[Re]-1;this.#C(l,r),this.#m(!0,this.#n)}));this.#b(`${null==i?"":"!"}[${t}](${e})`);const n=this.#A,s=n[In][Re];this.#g(n,s),this.#m(!0,this.#n)}#m(t,e){this.#c(),this.#a.add(this.#u,t,"number"==typeof e?e:0),this.unsave(),("boolean"==typeof e&&e||null==e)&&(console.log(e),this.#y())}#T(t,i){const n=new c([i],{[Ji]:"application/octet-stream"}),s=u.createObjectURL(n),o=Es(bs,{href:s,download:`NanoMD-${a.now()}.${t}`});e[Lt][xt](o),o[bi]()}#y(){this[Lt][ie].saved=1,null!=this[en]&&this[en][Ie]()}init(t,e=!0,n=!0){if(this[Lt][Yt]=!0,this[Lt][Tn]=null,this.#e=new ho({editor:this,autoSave:this.#n}),this[Lt][xt](this.#e.body),(t=i(t||this.#t)[Yi]())[Re]){this.#t="";const i=t[wi](/\n*$/,"")[Ni](/\n/);for(let t=0;t<i.length;t++){const e=i[t],n=Es(oe,{"data-index":t+1},Ps(e));n[kn]=t=>this.#c(),this[Lt][xt](n)}if(!e)return}else{const t=Es(oe,{"data-index":1});if(t[kn]=t=>this.#c(),this[Lt][xt](t),!e)return}n&&(this.#c(),this.#a.add(this.#u,!0))}changeMode(t=Fe){this[Lt][ie][We]=t}selectAll(){this.#d();const t=this[Lt].firstElementChild,e=this.#A,i=window.getSelection(),n=document.createRange();null!=t.firstChild&&(n.setStart(t.firstChild,0),n.setEnd(e.firstChild,e.firstChild.length),i.removeAllRanges(),i.addRange(n))}save(){if(this.#n)if(this.#s[Mn]("save")){if(null==this.#s.save)return!1;this.#s.save(this.text)}else this.#v();else if(this.#y(),this.#s[Mn]("save")){if(null==this.#s.save)return!1;this.#s.save(this.text)}}unsave(){0!==d(this[Lt][ie].saved)&&(this[Lt][ie].saved=0,this[en]&&this[en].unsave())}indent(t){if(9!==t.keyCode)return;const e=this[Lt];return this.#f((t=>{e[Bt][this.#h.start][Tn]=Ps(this.#h.left+"    "+this.#h.right),this.#p();const i=this.#h.left[Re]+4;this.#g(e[Bt][this.#h.start],i)})),!1}wrap(t){if(13!==t.keyCode)return;const e=this[Lt];return this.#f((t=>{e[Bt][this.#h.start][Tn]=Ps(this.#h.left),this.#p(),e[En][En][Bn]+=28;const i=Es(oe,Ps(this.#h.right));i[kn]=t=>this.#c(),e[Nn](i,e[Bt][this.#h.start+1]),this.#g(e[Bt][this.#h.start+1],0)})),!1}backspace(t){if(8!==t.keyCode)return!1;const e=this[Lt];return this.#f((t=>{if(this.#u.isMulti||this.#u.isSingle)e[Bt][this.#h.start][Tn]=Ps(this.#h.left+this.#h.right),this.#p(),this.#g(e[Bt][this.#h.start],this.#h.left[Re]);else if(this.#h.left[Re]){const t=this.#h.left[_i](0,this.#h.left[Re]-1);e[Bt][this.#h.start][Tn]=Ps(t+this.#h.right),this.#g(e[Bt][this.#h.start],t[Re])}else{if(0===this.#h.start)return;e[Bt][this.#h.start-1][Tn]+=Ps(this.#h.right),e[Bt][this.#h.start][vi](),e[En][En][Bn]-=28;const t=e[Bt][this.#h.start-1][In][Re]-this.#h.right[Re];this.#g(e[Bt][this.#h.start-1],t)}})),!1}undo(){this.#d();const t=this.#a.undo();null!=t&&(this[Ie](t[Vt][Re]<1?null:t[Vt],!1,!1),this.unsave(),this.#g(this[Lt][Bt][t[Te]],t[ei]),this.#n&&this.#y())}redo(){const t=this.#a.redo();null!=t&&(this[Ie](t[Vt],!1,!1),this.unsave(),this.#g(this[Lt][Bt][t[Te]],t[ei]),this.#n&&this.#y())}heading(t,e){const i=t[Ze]||t[te],n=`${new Array(e).fill("#")[De]("")}${0===e?"":" "}`;this.#u.check?this.#f((t=>{const s=this.#h.left[wi](/^\s*\#*\s*/,""),o=this.#h.body,l=this.#h.right,r=`${i?`<h${e}>`:n}${s}${o}${l}${i?`</h${e}>`:""}`[wi](/\n/g,""),u=r[Re]-(i?5:0);this.#C(r,u),this.#m(!0,this.#n)})):(this.#b(i?`<h${e}></h${e}>`:n),this.#g(this.#A,n[Re]-(i?5:0)),this.#m(!0,this.#n))}bold(t){this.#$(t,"**",As)}italic(t){this.#$(t,"*",Ms)}strikethrough(t){this.#$(t,"~~",_s)}underline(t){this.#$(t,Ts,Ts)}marker(t){this.#$(t,"==",Ge)}sup(t){this.#$(t,"^",Li)}sub(t){this.#$(t,"~",Ei)}code(t){this.#u.check?this.#f((e=>{if(this.#u.isMulti){const t=Es(oe,"```"),e=Es(oe,"```");t[kn]=e[kn]=t=>this.#c(),this[Lt][Nn](t,this[Lt][Bt][this.#h.end+1]),this[Lt][Nn](e,this[Lt][Bt][this.#h.start]),this.#g(this[Lt][Bt][this.#h.end+1],this[Lt][Bt][this.#h.end+1][In][Re]),this.#m(!0,this.#n)}else this.#$(t,"`",Zt)})):this.#$(t,"`",Zt)}blockquote(){this.#u.check?this.#f((t=>{for(let t=this.#h.start;t<=this.#h.end;t++){const e=this[Lt][Bt][t];e[Tn]=Ps(`> ${e[In]}`)}const e=this[Lt][Bt][this.#h.end],i=e[In][Re];this.#g(e,i),this.#m(!0,this.#n)})):(this.#b("> "),this.#g(this.#A,2),this.#m(!0,this.#n))}ul(){this.#M("-")}ol(){this.#M("1.")}link(t="",e=""){e[Yi]()[Re]<1&&t[Yi]()[Re]<1||this.#_(t,e)}image(t="",e="",i=""){t[Yi]()[Re]<1||this.#_(i,t,e)}clear(){this.init(),this.#y()}download(t="md"){const e={md:"md",html:"html"}[t[qi]()];if(null==e)return;const i="md"===e?this.text[Yi]():`<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NanoMD 輸出</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@pardnchiu/nanomd@1.9.1/dist/NanoMD-output.css"><script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"><\/script></head><body><section class="pd-md-viewer">${no(`\n${this.text}\n`)}</section></body></html>`;this.#T(e,i)}openfile(t){if(null==t)return void alert("請選擇檔案");const e=new FileReader;e.readAsText(t),e.onload=()=>{this[Lt][Tn]=null;const t=e.result[Yi]()[wi](/[\u0020\u00A0]/g," ");this.init(t,!1),this.#y()}}get text(){return[...this[Lt][Bt]].map((t=>"SECTION"===t[Sn]?"":t[In]))[De]("\n")}goBack(){this.undo()}goForward(){this.redo()}addHeading(t,e){this.heading(t,e)}addBold(t){this.bold(t)}addItalic(t){this.italic(t)}addStrikethrough(t){this.strikethrough(t)}addUnderline(t){this.underline(t)}addMarker(t){this.marker(t)}addSup(t){this.sup(t)}addSub(t){this.sub(t)}addCode(t){this.code(t)}addBlockquote(){this.blockquote()}addUl(){this.ul()}addOl(){this.ol()}addLink(t="",e=""){this.link(t,e)}addImage(t="",e="",i=""){this.image(t,e,i)}downloadMd(){this.download("md")}downloadHtml(){this.download("html")}getTxt(){return this.text}}t.PDMarkdownEditor=t.MDEditor=so;class oo{check=!1;isMulti=!1;isSingle=!0;index;offset;left;right;selection={};multi={};constructor(e,i,s=!1){const o=t[$n]();if(o.rangeCount<1)return;const l=o.getRangeAt(0);let r=i||js(l.commonAncestorContainer);if(null==r)return;let u,h,a="";if(s){r=e;const t=r[On](oe);for(let e=0;e<t.length;e++){const i=t[e];a+=(0==e?"":"\n")+i[In]}u=0,h=t[Re]-1}else l.cloneContents()[zt][ge](((t,e)=>{a+=(0==e?"":"\n")+t[In]})),r===e&&(u=d(js(o.baseNode)[ie][Te])-1,h=d(js(o.focusNode)[ie][Te])-1);var c=n(r===e),f=!c&&!s&&n(o[Et]!==o[bn]),p=!!s||n(o[bn]>o[Et]),g=!!s||n(u<h);this.check=!0,this.index=c?null:d(r[ie][Te])-1,this.offset=c||f?null:d(o[bn]),this.left=c||f?null:r[In][_i](0,o[bn]),this.right=c||f?null:r[In][_i](o[bn],r[In][Re]),this.isSingle=f,this.isMulti=c;const m=f?p?o[Et]:o[bn]:null,y=f?p?o[bn]:o[Et]:null;this.selection={body:f?o.toString():a,start:m,end:y,left:f?r[In][_i](0,m):null,right:f?r[In][_i](y,r[In][Re]):null};const v=c?g?u:h:null,w=s?0:c?g?o[Et]:o[bn]:null,b=c?g?h:u:null,A=s?e[Bt][h][In][Re]:c?g?o[bn]:o[Et]:null;this.multi={start:{index:v,offset:w},end:{index:b,offset:A},left:s?"":c?r[Bt][v][In][_i](0,w):null,right:s?"":c?r[Bt][b][In][_i](A,r[In][Re]):null}}}class lo{#I;#N;#S=[];#x=[];constructor(t){this.#I=t}add(t,e,i){clearInterval(this.#N),null==i?this.#k(t,e):this.#N=setTimeout((i=>{this.#k(t,e)}),i)}#k(t,e){this.#S[fi]({[Te]:t[Te],[ei]:t[ei],[Vt]:[...this.#I[Bt]].filter((t=>"DIV"==t.nodeName)).map((t=>t[In]))[De]("\n")}),e&&(this.#x=[])}undo(){const t=this.#S[(this.#S||[])[Re]-2];if(null==t)return;let e=this.#S.pop();return this.#x[fi](e),t}redo(){const t=this.#x.pop();if(null!=t)return this.#S[fi](t),t}}class ro{#I;#s;#i=!1;preventDefault=!0;#D={"cmd+meta":1};#E={"cmd+b":(t,e)=>t.bold(e),"cmd+i":(t,e)=>t.italic(e),"cmd+shift+x":(t,e)=>t.strikethrough(e),"cmd+u":(t,e)=>t.underline(e),"cmd+m":(t,e)=>t.marker(e),"cmd+k":(t,e)=>t.code(e),"cmd+arrowup":(t,e)=>t.sup(e),"cmd+arrowdown":(t,e)=>t.sub(e)};#P={"cmd+shift+z":(t,e)=>t.redo(),"cmd+z":(t,e)=>t.undo(),"cmd+a":(t,e)=>(t.selectAll(),!1),"cmd+s":(t,e)=>(t.save(),!1),tab:(t,e)=>t.indent(e),enter:(t,e)=>t.wrap(e),backspace:(t,e)=>t.backspace(e)};constructor(t={}){this.#I=t[le],this.#s=t.event,this.#i=t.hotKey;const e=this.#L(this.#s);if(!this.#D[Mn](e)){if(this.#i&&this.#E[Mn](e)){if(!1===this.#E[e](this.#I,this.#s))return;return this.#I[Lt][ie].saved=0,void(this.#I[en]&&(this.#I[en][Lt][ie].saved=0))}if(this.#P[Mn](e)){if(!1===this.#P[e](this.#I,this.#s))return;return this.#I[Lt][ie].saved=0,void(this.#I[en]&&(this.#I[en][Lt][ie].saved=0))}this.preventDefault=!1}}#L(t){let e="";return(t.metaKey||t.ctrlKey)&&(e+="cmd+"),t.shiftKey&&(e+="shift+"),e+=t.key[qi](),e}}class uo{editor;body;start;end;left;right;constructor(t,e){let i,n,s,o;this.editor=t,e.isMulti?(i=e.multi.start.index,n=e.multi.end.index,s=e.multi.left,o=e.multi.right):e.isSingle?(i=e.index,n=e.index,s=e.selection.left,o=e.selection.right):null!==e.index&&null!==e.offset&&(i=e.index,n=e.index,s=e.left,o=e.right),this.body=e.selection.body,this.start=d(i),this.end=d(n),this.left=s[wi](/&lt;/g,"<")[wi](/&gt;/g,">")[wi](/&nbsp;/g," "),this.right=o[wi](/&lt;/g,"<")[wi](/&gt;/g,">")[wi](/&nbsp;/g," ")}removeRows(){for(let t=this.end;t>this.start;t--)this.editor[Bt][t][vi]()}}class ho{#I;#n;constructor(t={}){this.#I=t.editor,this.#n=n(null==t.autoSave||t.autoSave);const e=$i+"."+Se+"-"+Rt,i=parseInt(this.#I[Lt][ie].pin||0);this.#I[Lt][ie].wrap;let s=this.#I[Lt][gi](e);if(s)return;const o=[{[Ye]:"format_bold",[Zi]:"添加粗體",[bi]:t=>this.#I.bold(t)},{[Ye]:"format_italic",[Zi]:"添加斜體",[bi]:t=>this.#I.italic(t)},{[Ye]:"strikethrough_s",[Zi]:"添加刪除線",[bi]:t=>this.#I.strikethrough(t)},{[Ye]:"format_underlined",[Zi]:"添加底線",[bi]:t=>this.#I.underline(t)},{[Ye]:"ink_marker",[Zi]:"添加高亮",[bi]:t=>this.#I.marker(t)},{[Ye]:"superscript",[Zi]:"添加上標",[bi]:t=>this.#I.sup(t)},{[Ye]:"subscript",[Zi]:"添加下標",[bi]:t=>this.#I.sub(t)},{[Ye]:"format_quote",[Zi]:"添加引用",[bi]:t=>this.#I.blockquote(t)},{[Ye]:"format_list_bulleted",[Zi]:"添加無序列表",[bi]:t=>this.#I.ul(t)},{[Ye]:"format_list_numbered",[Zi]:"添加有序列表",[bi]:t=>this.#I.ol(t)},{[Ye]:"code",[Zi]:"添加代碼塊",[bi]:t=>this.#I.code(t)},{[Ye]:"link",[Zi]:"添加連結",[bi]:t=>this.#I.link("連結文字","連結")},{[Ye]:"landscape",[Zi]:"添加圖片",[bi]:t=>this.#I.image("圖片連結","圖片名稱")},{},this.#n?null:{[Ye]:"autorenew",[Zi]:"儲存並預覽",[bi]:t=>this.#I.save(t)},{[Ye]:i?"keep_off":"keep",[Zi]:"釘選面板",[bi]:t=>this.#j(t)},{[Ye]:"wrap_text",[Zi]:"換行",[bi]:t=>this.#R()}].map((t=>{if(null==t)return;if(null==t[Ye]){return Es("span")}let e=Es("span.material-symbols-outlined",{title:t.title,[Ye]:t[Ye]},t[Ye]);return e[kn]=t.click,e}));s=Es(e,o),s[Yt]=!1,s[ie].hide=1,this[Lt]=s}#j(t){const e=t.target,i=d(this.#I[Lt][ie].pin||0);this.#I[Lt][ie].pin=Math.abs(i-1),e[In]=i?"keep":"keep_off",e[Zi]=i?"釘選面板":"取消釘選"}#R(){const t=d(this.#I[Lt][ie].wrap||1);this.#I[Lt][ie].wrap=Math.abs(t-1)}}class ao{tag="";props={};children=[];data=null;constructor(t){if(t[Wn][qi]()===Ai){let i=!1;for(const n of e[we][On](Ai)||[])if(null!=t[Si]&&n[Si]===t[Si]||null!=t[Ui]&&n[Ui]===t[Ui]){i=!0;break}i||e[we][xt](t),this[Ri]=Ai}this[Ri]=t[Wn][qi](),this[hi]=[...t.attributes].reduce(((t,e)=>(t[e.name]=e.value.trim(),t)),{}),this[Bt]=function(t){return s[me](t[zt]).filter((t=>t[It]===h[Tt]||t[It]===h[_t]&&t[Ui]&&t[Ui][Yi]()[Re]>0))}(t)[Ue]((t=>t.nodeType===Node[Tt]?new ao(t):t[Ui]||""))}getPatches(t){return this.#O(t,this)}#O(t,e,i=[]){if(null==t&&e)return[{[Ji]:ws.create,[Te]:i,[rn]:e}];if(t&&!e)return[{[Ji]:ws.remove,[Te]:i}];if(!t&&!e)return[];if(t.tag!==e.tag)return[{[Ji]:ws[wi],[Te]:i,[rn]:e}];const n=[];return n[fi](...this.#F(t,e,i)),n[fi](...this.#H(t,e,i)),n}#F(t,e,i=[]){if(null==t||"string"==typeof t||null==e||"string"==typeof e)return[];const n=[],s=t[hi]||{},l=o[Mt](s)[Re],r=e[hi]||{},u=o[Mt](r)[Re];if(u>0)for(let t in r){const s=r[t];n[fi]({[Ji]:ws.prop,[rn]:e,key:t,value:s,[Te]:i})}if(l>0){if(u<1)for(let t in s)n[fi]({[Ji]:ws.prop,[rn]:e,key:t,[Qi]:null,[Te]:i});for(let t in r)u>0&&!(t in r)&&n[fi]({[Ji]:ws.prop,[rn]:e,key:t,[Qi]:null,[Te]:i})}return n}#H(t,e,i=[]){if(null==t||"string"==typeof t||null==e||"string"==typeof e)return[];const n=[],o=s[ke](t[Bt])?t[Bt]:[],l=s[ke](e[Bt])?e[Bt]:[],u=r.max(o[Re],l[Re]);for(let t=0;t<u;t++){const s=o[t],r=l[t],u=i.concat(t);if("string"==typeof s&&"string"==typeof r){if(s===r)continue;n[fi]({[Ji]:ws.text,[rn]:e,[Qi]:r,[Te]:u})}else null==s?n[fi]({[Ji]:ws.append,[rn]:r,[Te]:u}):null==r?n[fi]({[Ji]:ws.remove,index:u}):n[fi](...this.#O(s,r,u))}return n}}t.PDMarkdownViewer=t.MDViewer=class{body;vbody;#z;#B="";#U=300;#G=0;#K;#Z;#I;constructor(t={}){if((he in t||ui in t)&&(this.#B=String(t[he]||t[ui]||"")[Yi]()),Di in t){t[Di]}const s=t[Di]||{},o=i(s[We]||Dt)[Yi]()[qi](),l=n(null==s.fill?1:s.fill)?1:0,r=i(s[pe]||"")[Yi]()||"'Noto Sans TC', sans-serif",u=t.sync||{};this.#U=d(null==u[ne]?300:u[ne])||300,this.#G=n(u[Ci]||0)?1:0,this[le]=u[le]instanceof so?u[le]:null,e[we][xt](Es(Di,`.${li}{font-family: ${r}}`));const h=document[un](t[$e]);typeof t[$e]===xi&&null!=h?(this[Lt]=h,h.classList.add(li)):this[Lt]=Es($i+"."+li),this[Lt][ie][We]=m&&o===Dt||o===ee?ee:"",this[Lt][ie].fill=l,this[Lt][ie].sync=null==this[le]?0:1;const a=t.hashtag||{};if(this.#K=i(a.path||"")[Yi](),this.#Z=i(a[Oi]||"")[Yi](),null!=t.fillMode){let e=n(t.fillMode)?1:0;this[Lt][ie].fill=e}if(null!=t[ne]&&(this.#U=d(t[ne])||300),null!=t[zn]&&(this.#G=n(t[zn])?1:0),null!=t[pe]){let n=i(t[pe])[Yi]()||"'Noto Sans TC', sans-serif";e[we][xt](Es(Di,`.${li}{font-family: ${n}}`))}null!=t[Vn]&&(this.#K=i(t[Vn]||"")[Yi]()),null!=t[Yn]&&(this.#Z=i(t[Yn]||"")[Yi]()),this.vbody=new ao(this[Lt]),this.init()}get editor(){return this.#I}set editor(t){this.#I&&(this.#I[Lt][Dn]=null),null!=t&&(this.#I=t,this.#I.viewer=this,this.#G&&null!=this.#I&&(this.#I[Lt][Dn]=t=>{this[Lt][Bn]+=t.deltaY}))}#q(){if(null==this.#I)return"";const t=[...this.#I[Lt][On](oe)];let e="";for(let n of t){var i=n[In][wi](/[\u00A0\u0020]/g," ");i[Yi]()[Re]<1?e+="\n":e+=i+"\n"}return e[Yi]()}clear(){let t=this[Lt].cloneNode(!0);t[Tn]="";let e=new ao(t);this[Lt][Tn]="",this.vbody=e}unsave(){0!==d(this[Lt][ie].saved)&&(this[Lt][ie].saved=0)}init(e=""){this[Lt][ie].saved=1;let i=this.#B,n=this[Lt][Bn];t[Gt](this.#z),this.#z=t[qn]((()=>{if(t[Gt](this.#z),i&&this[Lt][Tn]&&i===this[Lt][Tn])return;let o=e||this.#q()||i;o=no(`\n${o}\n`,this.#K,this.#Z);let l=this[Lt].cloneNode(!0);l[Tn]=o;let r=new ao(l);const u=r.getPatches(this.vbody);s[ke](u)&&this.#W(this[Lt],u),this.vbody=r;for(let e of[...this[Lt][On](Rt+"."+Xt)])e[kn]=async e=>{t[Gt](Ds);const i=e[Oi][En],n=i[pn],s=i[Bt][0][In];try{await navigator.clipboard.writeText(s),n[Nt](Pi),Ds=t[qn]((t=>{n[vi](Pi)}),1e3)}catch(t){console[ae](t),n[Nt](ae)}};let h=setInterval((()=>{null!=PR&&(clearInterval(h),this[Lt][Bn]=n,PR.prettyPrint())}),50)}),this.#U)}changeMode(t=Fe){this[Lt][ie][We]=t}#W(t,e){if(null!=t&&s[ke](e)){this.#V(t,e);for(const i of e){const{index:e}=i,n=l.parse(l.stringify(e||[]));let s;i.type===ws.append&&(s=n?.pop());const o=n?this.#Y(t,n):t;o&&(i.type===ws.create&&rn in i?this.#J(o,i):i.type===ws.replace&&rn in i&&null!=o[Pn]?this.#X(o,i):i.type===ws.append&&rn in i&&null!=s?this.#Q(o,i,s):i.type===ws.prop&&"key"in i&&Qi in i&&o instanceof Element?this.#tt(o,i.key,i.value||"",i[rn]):i.type===ws.text&&Qi in i&&o.nodeType===h[_t]&&(o[Ui]=i.value||""))}}}#V(t,e){const i=e.filter((t=>t.type===ws.remove)).sort(((t,e)=>{const i=(e.index.length||0)-(t.index.length||0);if(0!==i)return i;for(let i=0;i<(t.index.length||0);i++)if((t.index[i]||0)!==(e.index[i]||0))return(e.index[i]||0)-(t.index[i]||0);return 0}));for(const e of i){const i=this.#Y(t,e.index);null!=i&&null!=i[Pn]&&i[Pn].removeChild(i)}}#J(t,i){if(i.type!==ws.create||!(rn in i))return;const n="string"==typeof i[rn]?e[yn](i[rn]):this.#et(i[rn]);null!=t[En]&&t[En][xt](n)}#X(t,i){if(i.type!==ws.replace||!(rn in i)||null==t[Pn])return;const n="string"==typeof i[rn]?e[yn](i[rn]):this.#et(i[rn]);if(t[Pn].replaceChild(n,t),!(n instanceof Text||"string"==typeof i[rn])){for(const t in i[rn][hi])this.#tt(n,t,i[rn][hi][t]||"",i[rn]);this.#it(i[rn],n)}}#Q(t,i,n){if(i.type!==ws.append||!(rn in i)||null==n)return;const s="string"==typeof i[rn]?e[yn](i[rn]):this.#et(i[rn]);if(n+1>t[Bt][Re]?t[xt](s):t.insertBefore(s,t[Bt][n+1]),"string"!=typeof i[rn]){for(const[e,s]of o.entries(i[rn][hi]))this.#tt(t[Bt][n],e,s||"",i[rn]);this.#it(i[rn],t[Bt][n])}}#tt(t,e,i,n){null==i?t[_removeAttribute](e):null!=t&&t[Un](e,i)}#it(t,e){if("string"!=typeof t)for(const i in t.children.filter((t=>"string"!=typeof t))){if(null==e)continue;const n=t.children[+i],s=e.children[+i];if("string"!=typeof n){for(const[t,e]of o.entries(n[hi]))this.#tt(s,t,e||"",n);this.#it(n,s)}}}#Y(t,e){let i=t,n=s.from(i.childNodes).filter((t=>t.nodeType===h[Tt]||t.nodeType===h[_t]&&""!==t[Ui]?.trim()))||[];for(const t of e)i=n[t],null!=i&&(n=s.from(i.childNodes).filter((t=>t.nodeType===h[Tt]||t.nodeType===h[_t]&&""!==t[Ui]?.trim()))||[]);return i}#et(t){const i=e.createElement(t.tag);if(t[hi])for(const[e,n]of o.entries(t[hi]))e[$t](":")||e[$t]("@")||void 0!==n&&i[Un](e,n);for(const n of t[Bt])"string"==typeof n?i[xt](e[yn](n)):i[xt](this.#et(n));return i}}}("undefined"==typeof window?window={}:window);export const editor = window.MDEditor; export const MDEditor = window.MDEditor; export const viewer = window.MDViewer; export const MDViewer = window.MDViewer;
