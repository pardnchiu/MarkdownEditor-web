!function(){const t=window,e=document,i=String,n=Boolean,s=Array,o=Object,l=JSON,r=Math,u=URL,a=Node,h=Date,c=Blob,d=parseInt,f=location,p="video/mp4",g="video/quicktime",m=["javascript","js","ts","html","css","xml","json","sql","java","python","ruby","php","cpp","csharp","swift","typescript","kotlin","go","rust","perl","bash"],y=t.matchMedia&&t.matchMedia("(prefers-color-scheme: dark)").matches,v="abcdefghijklmnopqrstuvwxyz0123456789";let w=new Map;const b=/\.([\w_-]+)?/gi,A=/\#([\w_-]+)?/i,C=/^\w+(?=[\#\.]*)/i,$=/[\"\']{0,1}([\u0020\u00A0\u0009]*)(mailto\:)?([\u0020\u00A0\u0009]*)(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)([\u0020\u00A0\u0009]*)[\"\']{0,1}/,M=/(\s{1})\\?[\#＃]{1}([\u4e00-\u9fff\u3040-\u30ff\uac00-\ud7a3a-zA-Z0-9_]+)/,_=/[& \<\>\"\']/g,I=/\[([^\]\n]+)?\]\(([^\)\n\u0020\u00A0\u0009]+)([\u0020\u00A0\u0009]*[\"\']([^\)\n]+)[\"\'])?\)/,T=/(\n)(\>\s*\[\!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]\n)?(\>[^\n]*(\n)?)+/,k=/\`([^\n\`]*)\`/,x=/^\n|\n$/g,S=/\`{3}(\w*)([\s\S]*?)\s*\`{3}/,N=/((\n([\u0020\u00A0]{4,}|[\u0009]))[^\n]+)+/,D=/\*([^\n\*]*)\*/,E=/\_([^\n\_]*)\_/,P=/^\s|\s$/g,L=/(\n[\u0020\u00A0\u0009]*|\n[\u0020\u00A0\u0009]*>[\u0020\u00A0\u0009]*|\n[\u0020\u00A0\u0009]*([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+)\\?(\#{1,6})[\u0020\u00A0\u0009]+([^\n]+)/,j=/(\n)([^\n]+)\n\={3,}([\u0020\u00A0\u0009]*\n)/,R=/(\n)([^\n]+)\n\-{3,}([\u0020\u00A0\u0009]*\n)/,O=/([\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*)\\?(\#{1,6})[\u0020\u00A0\u0009]+([^\n\|]*)([\u0020\u00A0\u0009]*)/,F=/(\n[\u0020\u00A0\u0009]*)(\*{3,}|\-{3,})([\u0020\u00A0\u0009]*\n)/,H=/\!\[([^\]\n]+)?\]\(([^\)\n\u0020\u00A0\u0009]+)([\u0020\u00A0\u0009]*[\"\']([^\)\n]+)[\"\'])?\)(\(([0-9]+\%?)?[\u0020\u00A0\u0009\*x]+([0-9]+\%?)?([\u0020\u00A0\u0009]+(left|right))?\))?/,z=/^['"].*['"]$/,K=/\n(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+(.+)(\n.*\S.*)*)+/,B=/(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+(.+)(\n.*\S.*)*)+/,U=/^(([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]*[^\n]+)/,G=/\={2}([^\n\=]*)\={2}/,Z=/\~{2}([^\n\~]*)\~{2}/,q=/\*{2}([^\n\*]*)\*{2}/,W=/\_{2}([^\n\_]*)\_{2}/,V=/\~([^\n\~]*)\~/,Y=/\^([^\n\^]*)\^/,J=/(\n(?![\{\<])[^\n]+)+/,X=/^(\n?(?![\{\<])[^\n]+)+/,Q=/\.mov$/,tt=/\.mp4$/,et=/[A-Za-z\%]/,it=/[\"\']{0,1}([\u0020\u00A0\u0009]*)(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))([\u0020\u00A0\u0009]*)[\"\']{0,1}/,nt=/(\<[\u00A0\u0020\u0009\>]*\/?[\u00A0\u0020\u0009\>]*br[\u00A0\u0020\u0009\>]*\/?[\u00A0\u0020\u0009\>]*\>|\n)/,st=/\n/,ot=/\\\!/g,lt=/\\\`/g,rt=/\\\#/g,ut=/\\\*/g,at=/\\\_/g,ht=/\\\~/g,ct=/\\\^/g,dt=/\\\=/g,ft=/\\\</g,pt=/\\\>/g,gt=/\\\[/g,mt=/\\\]/g,yt=/\\\(/g,vt=/\\\)/g,wt=/\$/g,bt=/(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?/,At="mailto:",Ct="\n",$t="_blank",Mt="startsWith",_t="key",It="stringify",Tt="keys",kt="TEXT_NODE",xt="ELEMENT_NODE",St="nodeType",Nt="add",Dt="alt",Et="appendChild",Pt="as",Lt="auto",jt="baseOffset",Rt="blockquote",Ot="body",Ft="br",Ht="button",zt="charAt",Kt="checked",Bt="checkbox",Ut="childNodes",Gt="children",Zt="class",qt="clearTimeout",Wt="clipboardData",Vt="code",Yt="Color",Jt="color",Xt="content",Qt="contentEditable",te="controls",ee="copy",ie="create",ne="ctrlKey",se="dark",oe="dataset",le="delay",re="display",ue="div",ae="editor",he="em",ce="empty",de="emptyContent",fe="error",pe="float",ge="floor",me="focus",ye="fontFamily",ve="forEach",we="from",be="get",Ae="has",Ce="head",$e="height",Me="hide",_e="href",Ie="id",Te="iframe",ke="img",xe="index",Se="init",Ne="inner",De="input",Ee="insert",Pe="isArray",Le="join",je="label",Re="language",Oe="lastChild",Fe="lazy",He="length",ze="li",Ke="light",Be="link",Ue="list",Ge="loading",Ze="map",qe="mark",We="match",Ve="metaKey",Ye="min",Je="mode",Xe="Name",Qe="name",ti="node",ei="none",ii="number",ni="object",si="offset",oi="ol",li="outerHTML",ri="parent",ui="pd-md-editor",ai="pd-md-viewer",hi="placeholder",ci="pre",di="props",fi="preload",pi="prettyprint",gi="prevent",mi="push",yi="px",vi="querySelector",wi="random",bi="rel",Ai="remove",Ci="replace",$i="click",Mi="script",_i="scroll",Ii="section",Ti="set",ki="slice",xi="source",Si="span",Ni="split",Di="src",Ei="string",Pi="strong",Li="style",ji="sub",Ri="success",Oi="sup",Fi="table",Hi="tag",zi="target",Ki="tbody",Bi="td",Ui="temp",Gi="test",Zi="textContent",qi="th",Wi="thead",Vi="title",Yi="toLowerCase",Ji="toUpperCase",Xi="tr",Qi="trim",tn="type",en="ul",nn="value",sn="video",on="viewer",ln="width",rn="console",un="apply",an="void",hn="vdom",cn="getElementById",dn="crossOrigin",fn="preconnect",pn=Nt+"EventListener",gn="background"+Yt,mn=Zt+Xe,yn=Zt+"List",vn=ie+"DocumentFragment",wn=ie+"Element",bn=ie+"TextNode",An=we+"CharCode",Cn=me+"Background"+Yt,$n=me+"Offset",Mn=me+"Text"+Yt,_n=be+"Data",In=be+"Selection",Tn=Ae+"OwnProperty",kn=xe+"Of",xn=Ne+"HTML",Sn=Ne+"Text",Nn=Ee+"Before",Dn=ti+Xe,En=ti+"Value",Pn="onclick",Ln="onwheel",jn=ri+"Element",Rn=ri+"Node",On=hi+Yt,Fn=gi+"Default",Hn=gi+"Refresh",zn=vi+"All",Kn=Ai+"AllRanges",Bn=_i+"Height",Un=_i+"Sync",Gn=_i+"Top",Zn=Ti+"Attribute",qn=Ti+"Data",Wn=Ti+"End",Vn=Ti+"Start",Yn=Ti+"Timeout",Jn=Hi+Xe,Xn=Hi+"Path",Qn=Hi+"Target";let ts="";const es="@excl@",is="@grave@",ns="@num@",ss="@ast@",os="@lowbar@",ls="@tilde@",rs="@Hat@",us="@equal@",as="@lt@",hs="@gt@",cs="@lsqb@",ds="@rsqb@",fs="@lpar@",ps="@rpar@",gs="@dollar@",ms="&lt;",ys="&gt;",vs="&amp;",ws="&nbsp;",bs="&quot;",As="&apos;",Cs={create:"CREATE",append:"APPEND",replace:"REPLACE",text:"TEXT",prop:"PROP",remove:"REMOVE"};Array[we]({[He]:26},((t,e)=>i[An](97+e)))[ve](((e,n)=>{let s=n<10,o=n>=10&&n<20,l=n>=20,r=i(n),u=r[zt](r[He]-1),a=i=>{ts+=i?e[Ji]():e,t[(i?"$":"_")+(l?"_":"")+u+(o?"_":"")]=i?e[Ji]():e};a(0),a(1),s&&(ts+=n,t["_"+e]=n)}));t._a,t._b,t._c,t._d,t._e,t._f,t._g,t._h,t._i,t._j;const $s=t._0,Ms=t._1,_s=(t._2,t._3,t._4,t._5,t._6),Is=t._7,Ts=t._8,ks=(t._9,t._0_,t._1_,t._2_,t._3_,t._4_,t._5_,t._6_,t._7_,t._8_),xs=(t._9_,t.__0),Ss=(t.__1,t.__2,t.__3,t.__4,t.__5,t.$0,t.$1,t.$2,t.$3,t.$4,t.$5,t.$6,t.$7,t.$8,t.$9,t.$0_,t.$1_,t.$2_,t.$3_,t.$4_,t.$5_,t.$6_,t.$7_,t.$8_,t.$9_,t.$_0,t.$_1,t.$_2,t.$_3,t.$_4,t.$_5,"https://fonts.googleapis.com"),Ns=Ss+"/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,1,0&display=swap",Ds="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js",Es="https://cdn.jsdelivr.net/npm/@pardnchiu/nanomd@1.9.4/dist/NanoMD.css",Ps="NanoMD\nGitHub: https://github.com/pardnchiu/NanoMD\nCreator: Pardn Chiu\nLicense: Proprietary";let Ls;for(let t of[js(Be,{[bi]:fn,[_e]:"https://fonts.gstatic.com",[dn]:""}),js(Be,{[bi]:fn,[_e]:Ss,[dn]:""}),js(Be,{[bi]:fi,[_e]:Ns,[Pt]:Li,[dn]:"anonymous"}),js(Be,{[bi]:"stylesheet",[_e]:Ns}),js(Be,{[bi]:"preconnect",[_e]:"https://cdn.jsdelivr.net"}),js(Be,{[bi]:fi,[_e]:Ds,[Pt]:Mi}),js(Mi,{[Di]:Ds}),js(Be,{[bi]:fi,[_e]:Es,[Pt]:Li}),js(Be,{[bi]:"stylesheet",[_e]:Es})])e[Ce][Et](t);function js(t="",i,n){const s=((t[We](C)||[])[0]||"")[Qi](),o=((t[We](A)||[])[1]||"")[Qi](),l=(b[Gi](t)?t[We](b):[])[Ze]((t=>t[Ci](/^\./,"")));if(s[He]<1)return;let r,u,a,h=!1;if(t===Ui?(h=!0,r=e[vn]()):r=e[wn](s),91!=Ps[He])return r;o[He]&&(r.id=o);for(let t of l)r[yn][Nt](t);if(null==i&&null!=n&&([i,n]=[n,null]),null!=i&&null!=n)[u,a]=[i,n];else if(null==n)typeof i===Ei||typeof i===ii||Array[Pe](i)?a=i:u=i;else if(null==i)return r;if(typeof u===ni&&null!=u)for(const t in u){if(!u[Tn](t))continue;const e=u[t];-1!=[nn,Sn,xn,Zi,Qt][kn](t)?r[t]=e:-1!=[Jt,gn,ln,$e,re,pe][kn](t)?r[Li][t]=e:null!=e&&r[Zn](t,e)}if(null!=a){const t=typeof a===Ei,i=typeof a===ii,n=Array[Pe](a);if(t||i){const t=a;s===ke||s===xi?r[Di]=t:h?r[Et](e[bn](a)):r[xn]=t}else if(n)for(let t of a){const i=t instanceof Element;typeof t===Ei||typeof t===ii?h?r[Et](e[bn](t)):r[xn]+=t:i&&r[Et](t)}}return r}function Rs(t=""){return t[Ci](_,(t=>({"&":vs," ":ws,"<":ms,">":ys,'"':bs,"'":As}[t])))}function Os(t,e=""){return new RegExp(t,e)}function Fs(t){if(t)return t[mn]===ui||t[Dn][Yi]()===ue&&t[Rn][mn]===ui?t:Fs(t[Rn])}function Hs(t){const e=js(ue);return e[Et](t),e[xn]}function zs(t=""){if((t=t[Qi]())[He]<1)return"";const e=t[We](bt)||[];return e[He]>2&&11===e[1][He]?e[1]:""}function Ks(t=""){if((t=t[Qi]())[He]<1)return"";const e=t.match(/(?:https?:\/\/)?(?:www\.)?vimeo\.com\/(?:channels\/[\w]+\/|groups\/[\w]+\/videos\/|album\/\d+\/video\/|video\/|)(\d+)/);return e?e[1]:null}function Bs(t,e="",i="",n="",s="",o=""){const l=Us(i),r=n instanceof HTMLElement?n:js(i,n);return w[Ti](l,r[li]),e[Ci](t,s+l+o)}function Us(t=""){let e="{{"+(t[Qi]()||Lt)+"-";return e+=Gs(),e+="}}",w[Ae](e)?Us(t):e}function Gs(t=64){let e="";for(let i=0;i<t;i++)e+=v[zt](r[ge](36*r[wi]()));return e}function Zs(t=""){let i;for(let e of t[We](Os(T,_s))||[]){const s=e[We](T),o=s[1]||"",l=s[3]||"",r=s[5]||"";i=js(Rt+(l[He]?"."+l:"")),n(e,l),t=Bs(e,t,Rt,i,o,r)}function n(t,e=""){let n=to(t[Qi]()[Ci](/^\>[\u00A0\u0020\u0009]?/,"")[Ci](/\n\>[\u00A0\u0020\u0009]?/g,"\n"))[Ni](st);for(let t in n){const o=n[t];i[Et](s(o,d(t),e))}}function s(t,n=0,o=""){let l=js(Ui);const r=/^[\u00A0\u0020\u0009]*\>[\u00A0\u0020\u0009]?/,u=t[Ci](r,"");if(/\[\!(NOTE|TIP|IMPORTANT|WARNING|CAUTION)\]/[Gi](t)&&0===n)l[Et](js(Si+".hint",[-1!=["NOTE","TIP","IMPORTANT","WARNING","CAUTION"][kn](o)?js("span.material-symbols-outlined",{NOTE:"info",TIP:"lightbulb",IMPORTANT:"sms",WARNING:"warning",CAUTION:"error"}[o]||""):null,o])),l[Et](js(Ft));else if(r[Gi](t)){let t=js(Rt);t[Et](s(u)),l[Et](t)}else/^[\u00A0\u0020\u0009]*\{\{/[Gi](t)?l[Et](i[Et](e[bn](t))):l[Et](js(Si,t));return l}return t}function qs(t=""){let e=[[Vt,k]];for(let i of e){const e=i[0],n=i[1];for(let i of t[We](Os(n,_s))||[]){const s=i[We](n);if(P[Gi](s[1]||""))continue;let o=(s[1]||"")[Qi]();o[He]<1||(e!=Vt?t=t[Ci](i,js(e,o)[li]):(o=Rs(o),t=Bs(i,t,e,o)))}}return t}function Ws(t){let e=0,i=js(oi);for(let n in t){const s=t[n];0===d(n)&&(e=r.floor((s[We](/^\s*/)||[""])[0][He]/4));const o=Os(`^\\s{0,${4*e}}`);i[Et](js(ze,Rs(s[Ci](o,""))))}return i}function Vs(t=""){let e=[[Pi,q],[Pi,W],[ks,Z],[qe,G],[he,D],[he,E],[Oi,Y],[ji,V]];for(let t of e){i(t[0],t[1])}function i(e,i){for(let n of t[We](Os(i,_s))||[]){const s=n[We](i);if(P[Gi](s[1]||""))continue;let o=(s[1]||"")[Qi]();o[He]<1||(e!=Vt?t=t[Ci](n,js(e,o)[li]):(o=Rs(o),t=Bs(n,t,e,o)))}}return t}function Ys(t="",e="",n=$t){if(i(e||"")[Qi]()[He]<1)return t;for(let i of t[We](Os(M,_s))||[]){if(i[We](/^\\/))continue;const s=i[We](M);if(s[He]<1)continue;const o=s[1],l=(s[2]||"")[Qi](),r=Us($s);if(l[He]<1)continue;const u=js(Ui,[js($s+"."+Hi,{[_e]:e+l,[zi]:n===$t?$t:"_self"},l)]);w[Ti](r,Hs(u)),t=t[Ci](i,o+r)}return t}function Js(t=""){return(()=>{for(let e of t[We](Os(L,_s))||[]){const i=e[We](L);if(i[He]<1)continue;const n=i[1]||"",s=(i[3]||"")[Qi]()[He],o=(i[4]||"")[Qi]();0!=r[Ye](s,o[He])&&(t=Bs(e,t,Is+s,o,n))}})(),(()=>{for(let e of t[We](Os(O,_s))||[]){const i=e[We](O);if(i[He]<1)continue;const n=i[1]||"",s=(i[2]||"")[Qi]()[He],o=(i[3]||"")[Qi](),l=i[4]||"";0!=r[Ye](s,o[He])&&(t=Bs(e,t,Is+s,o,n,l))}})(),(()=>{for(let e of t[We](Os(j,_s))||[]){const i=e[We](j);if(i[He]<1)continue;const n=i[1]||"",s=(i[2]||"")[Qi](),o=i[3]||"";s[He]<1||(t=Bs(e,t,Is+1,s,n,o))}})(),(()=>{for(let e of t[We](Os(R,_s))||[]){const i=e[We](R);if(i[He]<1)continue;const n=i[1]||"",s=(i[2]||"")[Qi](),o=i[3]||"";s[He]<1||(t=Bs(e,t,Is+2,s,n,o))}})(),t}function Xs(t=""){for(let e of t[We](Os(F,_s))||[]){const i=e[We](F);if(i[He]<1)continue;const n=i[1]||"",s=i[3]||"",o=Us("HR");w[Ti](o,"<hr>"),t=t[Ci](e,n+o+s)}return t}function Qs(t=""){const e="this.parentElement.nextElementSibling.style.display='block';this.parentElement.style.display='none'",i="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDEyMCAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxnIGNsaXAtcGF0aD0idXJsKCNjbGlwMF8yNTkyXzMwNDkpIj4KPHBhdGggZD0iTTEyMCA2MEMxMjAgMjYuODYyOSA5My4xMzcxIDAgNjAgMEMyNi44NjI5IDAgMCAyNi44NjI5IDAgNjBDMCA5My4xMzcxIDI2Ljg2MjkgMTIwIDYwIDEyMEM5My4xMzcxIDEyMCAxMjAgOTMuMTM3MSAxMjAgNjBaIiBmaWxsPSJibGFjayIgZmlsbC1vcGFjaXR5PSIwLjUiLz4KPHBhdGggZD0iTTg0LjM2MzMgNTYuNTgwM0M4Ni45MzAyIDU4LjEzNzYgODYuOTMwMiA2MS44NjI2IDg0LjM2MzMgNjMuNDE5OUw1MS44MjQ4IDgzLjE2MTJDNDkuMTU5MSA4NC43Nzg2IDQ1Ljc1IDgyLjg1OTQgNDUuNzUgNzkuNzQxNFY0MC4yNTg4QzQ1Ljc1IDM3LjE0MDggNDkuMTU5MSAzNS4yMjE2IDUxLjgyNDggMzYuODM4OUw4NC4zNjMzIDU2LjU4MDNaIiBmaWxsPSJ3aGl0ZSIvPgo8L2c+CjxkZWZzPgo8Y2xpcFBhdGggaWQ9ImNsaXAwXzI1OTJfMzA0OSI+CjxyZWN0IHdpZHRoPSIxMjAiIGhlaWdodD0iMTIwIiBmaWxsPSJ3aGl0ZSIvPgo8L2NsaXBQYXRoPgo8L2RlZnM+Cjwvc3ZnPg==";function n(t,n,s,o){return Hs(js(Ui,[js($s,{[Vi]:o,[_e]:n,[zi]:$t},s||n),js("section.more",[js("img.cover","https://i.ytimg.com/vi/"+t+"/mqdefault.jpg"),js("img.icon",{[Pn]:e},i)]),js(Te,{[Ge]:Fe,[ln]:"640px",[Di]:"https://www.youtube.com/embed/"+t,frameborder:0,allow:"accelerometer; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:"",[re]:ei})]))}function s(t,n,s,o){const l=function(t){const e=`https://vimeo.com/api/v2/video/${t}.json`;let i=null;const n=new XMLHttpRequest;n.open("GET",e,!1);try{n.send(),200===n.status?i=JSON.parse(n.responseText)[0].thumbnail_large:console.error("HTTP 錯誤:",n.status)}catch(t){console.error("無法獲取縮圖:",t)}return i}(t);return Hs(js(Ui,[js($s,{[Vi]:o,[_e]:n,[zi]:$t},s||n),js("section.more",[js("img.cover",l),js("img.icon",{[Pn]:e},i)]),js(Te,{[Ge]:Fe,[ln]:"640px",[Di]:"https://player.vimeo.com/video/"+t,frameborder:0,allow:"autoplay; fullscreen; picture-in-picture",allowfullscreen:"",[re]:ei})]))}return(()=>{for(let e of t[We](Os(I,_s))||[]){const i=e[We](I);if(i[He]<1)continue;const o=(i[1]||"")[Qi](),l=(i[2]||"")[Qi](),u=(i[4]||"")[Qi](),a=(zs(l)||"")[Qi](),h=(Ks(l)||"")[Qi]();if(0!=r[Ye](o[He],l[He]))if(a[He])t=Bs(e,t,ue,n(a,l,o,u));else if(h[He])t=Bs(e,t,ue,s(h,l,o,u));else{const i=js($s,{[Vi]:u,[_e]:l,[zi]:$t},o);t=Bs(e,t,$s,i)}}})(),(()=>{for(let e of t[We](Os(it,_s))||[]){if(e[We](z))continue;const i=e[We](it);if(i[He]<1)continue;const o=i[1]||"",l=(i[2]||"")[Qi](),r=i[5]||"",u=(zs(l)||"")[Qi](),a=(Ks(l)||"")[Qi]();if(!(l[He]<1))if(u[He])t=Bs(e,t,ue,n(u,l),o,r);else if(a[He])t=Bs(e,t,ue,s(a,l));else{const i=js($s,{[_e]:l,[zi]:$t},l);t=Bs(e,t,$s,i,o,r)}}})(),(()=>{for(let e of t[We](Os($,_s))||[]){if(e[We](z))continue;const i=e[We]($);if(i[He]<1)continue;const n=(i[1]||"")+(i[2]||"")+(i[3]||""),s=(i[4]||"")[Qi](),o=i[8]||"";if(s[He]<1)continue;const l=js($s,{[_e]:At+s,[zi]:$t},s);t=Bs(e,t,$s,l,n,o)}})(),t}function to(t=""){for(let i of t[We](Os(K,_s))||[])e(i);function e(e){let i;e[Qi]()[Ci](Os(nt,_s),Ct)[Ni](nt)[ve](((t,e)=>{const n=t[We](B)||[],s=n[He]<1?null:/\d+\./[Gi]((n[2]||"")[Qi]())?oi:en,o=(t[We](/\s{4}/g)||[])[He];let l=n[He]<1?t[Ci](/^\s*([\-\*\+]|\d+\.)?\s*/g,""):(n[3]||"")[Qi]();if(0===d(e)&&null==s)return;0===d(e)&&(i=js(s));let r=i;function u(t,e){if(/^\[\s*(\x)?\s*\]/[Gi](e)){const i=e[Qi]()[We](/^\[\s*(\x)?\s*\]/);e=e[Ci](/^\[\s*(\x)?\s*\]\s*/,"");const n=null!=i[1];t[Et](js(ze,[js(je,[js(De,{[tn]:Bt,[Kt]:n?"":null,[Pn]:"return false;"}),js(Si,e)])]))}else t[Et](js(ze,e))}if(/^\s{0,3}([\-\*\+]|\d+\.)/[Gi](t))u(r,l);else if(/^\s{4,}([\-\*\+]|\d+\.)/[Gi](t)){r=i[Oe];for(let t=0;t<o&&(null!=r&&null!=r[Jn]);t++)if(t==o-1&&r[Jn][Yi]()==ze)if(r[Oe]instanceof HTMLElement&&(r[Oe][Jn][Yi]()==oi||r[Oe][Jn][Yi]()==en))u(r[Oe],l);else if(/^\[\s*(\x)?\s*\]/[Gi](l)){const t=l[Qi]()[We](/^\[\s*(\x)?\s*\]/);l=l[Ci](/^\[\s*(\x)?\s*\]\s*/,"");const e=null!=t[1];r[Et](js(s,[js(ze,[js(je,[js(De,{[tn]:Bt,[Kt]:e?"":null,[Pn]:"return false;"}),js(Si,l)])])]))}else r[Et](js(s,[js(ze,l)]));else r=r[Oe][Oe]}else{if(null==i)return;for(r=i[Oe];null!=r[Oe];)r=r[Oe];if(r instanceof HTMLElement);else if(/^\{\{(h\d|img|pre)/[Gi](r[En]||""));else{for(;r[jn][Jn][Yi]()!=ze;)r=r[jn];r[jn][Et](js(Ft))}r[jn][xn]+=l}})),null!=i&&(t=Bs(e,t,Ue,i))}return t}function eo(t=""){for(let e of t[We](Os(H,_s))||[]){const i=e[We](H);if(i[He]<1)continue;const n=(i[1]||"")[Qi](),s=(i[2]||"")[Qi](),o=(i[4]||"")[Qi]();let l=(i[6]||"")[Qi](),r=(i[7]||"")[Qi](),u=(i[9]||"")[Qi]();if(s[He]<1)continue;l[He]&&!et[Gi](l)&&(l+=yi),r[He]&&!et[Gi](r)&&(r+=yi);const a=Q[Gi](s),h=tt[Gi](s);let c;c=a?js(sn,{[te]:"",[Vi]:o,[ln]:l||null,[$e]:r||null},[js(xi,{[tn]:g},s)]):h?js(sn,{[te]:"",[Vi]:o,[ln]:l||null,[$e]:r||null},[js(xi,{[tn]:p},s)]):js(ke,{[Dt]:n,[Vi]:o,[ln]:l||null,[$e]:r||null,[pe]:u[He]?u:null},s),null!=c&&(t=Bs(e,t,ke,c))}return t}function io(t=""){for(let e of t[We](Os(S,_s))||[]){const i=e[We](S);if(i[He]<1)continue;const n=null==i[2][We](x),s=n?"":(i[1]||"")[Qi]()[Yi](),o=i[2]||"",l=-1!=m[kn](s),r=o[Ci](x,"")[Ni](st);let u;u=n?js(Vt+"."+pi,Rs(o)):js(ci+"."+pi,{[Qe]:s},[js(Vt+(l?"."+Re+"-"+s:""),{[Qe]:s},[Ws(r)]),js(Ht+"."+ee)]),t=Bs(e,t,n?Vt:ci,u)}return t}function no(t=""){for(let e of t[We](Os(N,_s))||[]){const i=e[We](N);if(i[He]<1)continue;const n=i[2]||"",s=e[Ci](x,"")[Ni](st),o=js(ci+"."+pi,[js(Vt,[Ws(s)]),js(Ht+"."+ee)]);t=Bs(e,t,ci,o,n)}return t}function so(t=""){let e;function i(t){const e=t[We](/^([\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*)+/)||[],i=t[We](/[\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*$/)||[];return[e[0]||"",i[0]||""]}function n(t){const i=t[Qi]()[Ni](st);e=js(Ui,[js(Fi,[js(Wi),js(Ki)])]);let n=!0,o=[],l=0;for(let t in i){const r=i[t],u=r[We](/((\s*)\|?((?:.*?\|)*.*)\|?)+/)||[];if(u[He]<1)continue;const a=(u[3]||"")[Qi]()[Ci](/[\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*$/,""),h=/^[\u0020\u00A0\u0009]*\|?([\u0020\u00A0\u0009]*[\-\:]+[\u0020\u00A0\u0009]*\|?)+[\u0020\u00A0\u0009]*$/[Gi](r),c=a[Ni](/[\u0020\u00A0\u0009]*\|[\u0020\u00A0\u0009]*/);if(0===d(t)&&(l=c[He]),h){for(let t of r[Ci](/^([\u0020\u00A0\u0009]*\|)|(\|[\u0020\u00A0\u0009]*)$/g,"")[Ni](/\|/))/^\-+\:$/[Gi](t[Qi]())?o.push("right"):/^\:\-+\:$/[Gi](t[Qi]())?o.push("center"):o.push("left");const t=[...e.firstChild.firstChild.childNodes[0].childNodes];for(let e in t)t[e].setAttribute("align",o[e]);n=!1}else s(n,c,l,o)}}function s(t=!0,i=[],n=0,s=[]){const o=t?e.firstChild.firstChild:e.firstChild[Oe],l=js(Xi);for(let e=0;e<n;e++)l[Et](js(t?qi:Bi,{align:s[e]},i[e]||""));o[Et](l)}return(()=>{const s=/([^\n]*)(?:[\u0020\u00A0\u0009]*\|[^\n]*\|[^\n]*\n)[\u0020\u00A0\u0009]*\|([\u0020\u00A0\u0009\-\:]*\|)+\n(?:[\u0020\u00A0\u0009]*\|[^\n]*\|[^\n]*\n)*/;for(let o of t[We](Os(s,_s))||[])U[Gi](o)||(n(o),t=Bs(o,t,Fi,Hs(e),...i(o)))})(),(()=>{const s=/(([^\n]+\|)*[^\n]+\n)(([\u0020\u00A0\u0009\-\:]+\|)*[\u0020\u00A0\u0009\-\:]+\n)(?:([^\n]+\|)*[^\n]+\n)*/;for(let o of t[We](Os(s,_s))||[])n(o),t=Bs(o,t,Fi,Hs(e),...i(o))})(),t}function oo(t=""){return t=t[Ci](/\n[\u0020\u00A0\u0009]*/g,"\n"),(()=>{for(let e of t[We](Os(X,_s))||[]){const i=e[We](X);if(i[He]<1)continue;const n=i[2]||"",s=(i[0]||"")[Qi]();if(s[He]){const i=js(Ui,[js("p",s)]),o=Us("p");w[Ti](o,Hs(i)),t=t[Ci](e,n+o)}}})(),(()=>{for(let e of t[We](Os(J,_s))||[]){const i=e[We](J);if(i[He]<1)continue;const n=i[2]||"",s=(i[0]||"")[Qi]();if(s[He]){const i=js(Ui,[js("p",s)]),o=Us("p");w[Ti](o,Hs(i)),t=t[Ci](e,n+o)}}})(),t}function lo(t=""){t=t[Ci](/^\n*|\n*$/g,"");const e=/(&lt;br&gt;)/g;return e[Gi](t)?t[Ci](e,"\n"):t}function ro(t="",e="",i=$t){t=t[Ci](ot,es)[Ci](lt,is)[Ci](rt,ns)[Ci](ut,ss)[Ci](at,os)[Ci](ht,ls)[Ci](ct,rs)[Ci](dt,us)[Ci](ft,as)[Ci](pt,hs)[Ci](gt,cs)[Ci](mt,ds)[Ci](yt,fs)[Ci](vt,ps)[Ci](wt,gs)[Ci](/[\u00A0\u0020]/g," ");let n=[io,qs,eo,Qs,Vs,Js,Xs,so,Zs,to,no,Ys,lo,oo];for(let s of n)t=s(t,e,i);for(;/\{{2}\w*\-*\w{64}\}{2}/[Gi](t);)for(let e of t[We](/\{{2}\w*\-*\w{64}\}{2}/g)||[]){let i=Os(e);t=t[Ci](i,w[be](e))}const s=["h1","h2","h3","h4","h5","h6",Fi,oi,en,ci,Rt,"details","hr",je];for(let e of s){const i=Os(`[  \t]*\\n[  \t]*<${e}`,_s),n=Os(`${e}>[  \t]*\\n[  \t]*`,_s);t=t[Ci](i,`<${e}`)[Ci](n,`${e}>`)}return t=t[Ci](Os(es,_s),"&excl;")[Ci](Os(is,_s),"&grave")[Ci](Os(ns,_s),"&num;")[Ci](Os(ss,_s),"&ast;")[Ci](Os(os,_s),"&lowbar;")[Ci](Os(ls,_s),"&tilde;")[Ci](Os(rs,_s),"&Hat;")[Ci](Os(us,_s),"&equal;")[Ci](Os(as,_s),ms)[Ci](Os(hs,_s),ys)[Ci](Os(cs,_s),"&lsqb;")[Ci](Os(ds,_s),"&rsqb;")[Ci](Os(fs,_s),"&lpar;")[Ci](Os(ps,_s),"&rpar;")[Ci](Os(gs,_s),"&dollar;")[Ci](/([\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*){2,}/g,"<br>")}document.addEventListener("DOMContentLoaded",(t=>{!function(...t){const i=js(Mi,`${rn}.log.${un}(${an} 0, ${JSON.stringify(t)});`);e[Ot][Et](i),i[Ai]()}("%c"+Ps,"line-height: 1.75rem; font-size: 0.875rem;")}));class uo{#t="";#e;#i=!0;#n=!0;#s;#o;#l;#r;#u;#a;#h;constructor(s={}){this.#t=(s.defaultContent||"")[Qi]();const o=s[Li]||{},l=i(o[Je]||Lt)[Qi]()[Yi](),r=n(null==o.fill?1:o.fill)?1:0,u=i(o[ye]||"")[Qi]()||"'Roboto Mono', monospace",a=n(null==o.showRow?1:o.showRow)?1:0,h=o.placeholder||{},c=i(h.text||"Type here ..."),d=i(h.color||"#bfbfbf"),f=o.focus||{},p=i(f.backgroundColor||"#0000ff1a"),g=i(f.color||"#0000ffff");e[Ce][Et](js(Li,`\n.${ui}{font-family: ${u}}\n.${ui}>div[data-focus="1"]{background-color:${p};color:${g};caret-color:${g}}\n.${ui}>div[data-last="1"]:empty::after{content:"${c}";color:${d} !important;caret-color:${g}}`));const m=e[cn](s[Ie]);typeof s[Ie]===Ei&&null!=m?(this[Ot]=m,m.classList.add(ui)):this[Ot]=js(Ii+"."+ui),this[Ot][oe][Je]=y&&l===Lt||l===se?se:"",this[Ot][oe].fill=r,this[Ot][oe].row=a,this[Ot][oe].pin={1:1,0:0,[!0]:1,[!1]:0}[s.tabPin]||0,this[Ot][oe].wrap={1:1,0:0,[!0]:1,[!1]:0}[s.wrap]||1,this[Ot][oe].saved=1,this.#h=new ho(this[Ot]);const v=this[Ot];if(this.#i=n(null==s.hotKey||s.hotKey),this.#n=n(null==s.autoSave||s.autoSave),this.#s=s.event||{},null==this.#l&&s[Hn]&&(this.#l=t[pn]("beforeunload",(t=>{t[Fn]()})),e[pn]("keydown",(t=>{console.log(t,{r:1,R:1}[t[_t]]),("F5"===t[_t]||(t.ctrlKey||t.metaKey)&&{r:1,R:1}[t[_t]])&&t[Fn]()}))),null!=s[Je]){let t=i(s[Je]||Lt)[Qi]()[Yi]();this[Ot][oe][Je]=y&&t===Lt||t===se?se:""}if(null!=s.fillMode){let t=n(s.fillMode)?1:0;this[Ot][oe].fill=t}if(null!=s.showRow){let t=n(s.showRow)?1:0;this[Ot][oe].row=t}if(null!=s[ye]){let t=i(s[ye])[Qi]()||"'Roboto Mono', monospace";e[Ce][Et](js(Li,`.${ui}{font-family: ${t}}`))}let w=i(s[Cn]||"")[Qi]()||p,b=i(s[Mn]||"")[Qi]()||g;e[Ce][Et](js(Li,`.${ui}>div[data-focus="1"]{background-color:${w};color:${b}`));let A=i(s[hi]||"")[Qi]()||c,C=i(s[On]||"")[Qi]()||d;e[Ce][Et](js(Li,`.${ui}>div[data-last="1"]:empty::after{content:"${A}";color:${C}}`)),v.onmousedown=v.onmouseup=v.ontouchend=t=>{if(t.target[Jn][Yi]()!==ue)return t[Fn](),!1;this.#c()},v.oncut=t=>(this.#d(),this.#f((e=>{t[Wt][qn]("text/plain",this.#a.body),v[Gt][this.#a.start][xn]=Rs(this.#a.left+this.#a.right),this.#p(),this.#g(v[Gt][this.#a.start],this.#a.left[He])})),this.#m(!0,!1),!1),v.onpaste=e=>(this.#d(),this.#f((i=>{const n=((e[Wt]||t[Wt])[_n]("Text")||"")[Ni](/\n/),s=n[He],o=s-1,l=s>1,r=this.#a.start+o,u=`${l?"":this.#a.left}${n[o]}`[He],a=n[0],h=l?"":this.#a.right;if(v[Gt][this.#a.start][Sn]=this.#a.left+a+h,this.#p(),l)for(let t=1;t<s;t++){const e=n[t],i=js(ue,Rs(`${e}${t===o?this.#a.right:""}`));i[Pn]=t=>this.#c(),v[Nn](i,v[Gt][this.#a.start+t])}this.#g(v[Gt][r],u,u)})),this.#m(!0,!1),!1),v.oninput=t=>{let e,i;if("deleteCompositionText"===t.inputType){e=this.#u.index,i=this.#u.offset;for(let t of[...v[Gt]]){if(t[Dn][Yi]()===ue||t[Dn][Yi]()===Ii)continue;t[Ai]();let n=js(ue,{"data-index":e+1,index:e+1});n[Pn]=t=>this.#c(),v[Nn](n,v[Gt][e]),this.#g(v[Gt][e],i)}}t.inputType;let n=this.#u.isMulti,s=this.#u.multi.left,o=t.data,l=this.#u.multi.right,r=this.#u.multi.start.offset;this.#c(),n&&(this.#o[Sn]=s+o+l,this.#g(this.#o,r+1)),this.#m(!0,300)},v.onkeydown=t=>!new co({editor:this,hotKey:this.#i,[Hn]:s[Hn],event:t}).preventDefault,v.onkeyup=t=>{"Meta"!==t.key&&"Control"!==t.key&&(v[Gt]&&1===v[Gt][He]&&v.firstElementChild[Dn][Yi]()!==ue&&this[Se](null,!0,!1),this.#c(),/^(Arrow(Up|Left|Down|Right)|CapsLock|Shift|Control|Alt|Clear|Escape|F\d+)$/[Gi](t.key)||this.#n&&this.#y())},v.onblur=t=>{this.#d()},this.init()}get viewer(){return this.#r}set viewer(t){this.#r=t}#v(){let t=js("button",[js("span.material-symbols-outlined","markdown"),"Markdown"]),i=js("button",[js("span.material-symbols-outlined","html"),"HTML"]),n=js("button",[js("span.material-symbols-outlined","cancel"),"Cancel"]),s=js("div.nanomd-pop",[js("strong","Export"),t,i,n]);t[Pn]=t=>{this.download("md"),s.remove()},i[Pn]=t=>{this.download("html"),s.remove()},n[Pn]=t=>{s.remove()},e[Ot][Et](s)}#c(e,i=!1){this.#d(),this.#u=new ao(this[Ot],e,i);const n=t[In]();if(n.rangeCount<1)return;const s=n.getRangeAt(0);let o=e||Fs(s.commonAncestorContainer);null!=o&&this.#w(o,this.#u.index||this.#u.multi.end.index)}#f(t){this.#a=new fo(this[Ot],this.#u),t()}#p(){this.#a.removeRows()}#g(i,n,s){const o=this[Ot][zn](ue);for(let t in o){const e=o[t];if(isNaN(d(t)))continue;const i=d(t)+1;e[oe][xe]=i,i===o.length?e[oe].last=1:e[oe].last=0}if(t[In]?t[In]()[ce]?t[In]()[ce]():t[In]()[Kn]&&t[In]()[Kn]():e[In]&&e[In]()[ce](),null==i)return;let l=t[In](),r=e.createRange(),u=n??i[Ut][0][He],a=s??u;r.selectNode(i),i[Ut][0]?(r[Vn](i[Ut][0],u>i[Ut][0][He]?i[Ut][0][He]:u),r[Wn](i[Ut][0],a>i[Ut][0][He]?i[Ut][0][He]:a)):(r[Vn](i,0),r[Wn](i,0)),l.addRange(r),this.#c(i)}#w(t,e){const i=Ii+"."+De+"-"+Ht;let n=this[Ot][vi](i);t[oe][me]=1,this[Ot][Nn](n,this[Ot][Gt][e+1]),n[oe][Me]=0,this.#o=t}#d(){if(!this.#o)return;const t=Ii+"."+De+"-"+Ht,e=this[Ot][vi](t);this.#o[oe][me]=0,null!=e&&(this[Ot][Et](e),e[oe][Me]=1),this.#o=null}#b(t){t=Rs(t);let e=this.#A;const i=js(ue,t);i[Pn]=t=>this.#c(),e[Sn][Qi]()[He]<1?e[xn]=t:this[Ot][Et](i),this[Ot][Gn]=this[Ot][Bn],this[on]&&(this[on][Ot][Gn]=this[on][Ot][Bn])}get#A(){let t=this[Ot].lastElementChild;return"SECTION"===t[Dn]&&(t=t.previousElementSibling),t}#C(t,e){const i=this[Ot][Gt][this.#a.start];i[xn]=Rs(t),this.#p(),this.#g(i,e)}#$(t,e="",i=""){const n=t[Ve]||t[ne]||e===i;this.#u.check?this.#f((t=>{const s=this.#a.left,o=this.#a.body,l=this.#a.right,r=`${s}${n?`<${i}>`:e}${o}${n?`</${i}>`:e}${l}`[Ci](/\n/g,""),u=r[He]-l[He]-(n?i[He]+3:e[He]);this.#C(r,u),this.#m(!0,this.#n)})):(this.#b(n?`<${i}></${i}>`:`${e}${e}`),this.#g(this.#A,n?i[He]+3:e[He]),this.#m(!0,this.#n))}#M(t){this.#u.check?this.#f((e=>{const i=this.#a.start,n=this.#a.end;for(let e=i;e<=n;e++){const i=this[Ot][Gt][e];i[xn]=Rs(`${t} ${i[Sn]}`)}const s=this[Ot][Gt][n],o=s[Sn][He];this.#g(s,o),this.#m(!0,this.#n)})):(this.#b(t),this.#g(this.#A,t[He]+1),this.#m(!0,this.#n))}#_(t="",e="",i){if(this.#u.check)return void this.#f((n=>{const s=this.#a.left,o=this.#a.right,l=`${s}${null==i?"":"!"}[${t}](${e}) ${o}`[Ci](/\n/g,""),r=l[He]-o[He]-1;this.#C(l,r),this.#m(!0,this.#n)}));this.#b(`${null==i?"":"!"}[${t}](${e})`);const n=this.#A,s=n[Sn][He];this.#g(n,s),this.#m(!0,this.#n)}#m(t,e){this.#c(),this.#h.add(this.#u,t,"number"==typeof e?e:0),this.unsave(),("boolean"==typeof e&&e||null==e)&&(console.log(e),this.#y())}#I(t,i){const n=new c([i],{[tn]:"application/octet-stream"}),s=u.createObjectURL(n),o=js($s,{href:s,download:`NanoMD-${h.now()}.${t}`});e[Ot][Et](o),o[$i]()}#y(){this[Ot][oe].saved=1,null!=this[on]&&this[on][Se]()}init(t,e=!0,n=!0){if(this[Ot][Qt]=!0,this[Ot][xn]=null,this.#e=new po({editor:this,autoSave:this.#n}),this[Ot][Et](this.#e.body),(t=i(t||this.#t)[Qi]())[He]){this.#t="";const i=t[Ci](/\n*$/,"")[Ni](/\n/);for(let t=0;t<i.length;t++){const e=i[t],n=js(ue,{"data-index":t+1},Rs(e));n[Pn]=t=>this.#c(),this[Ot][Et](n)}if(!e)return}else{const t=js(ue,{"data-index":1});if(t[Pn]=t=>this.#c(),this[Ot][Et](t),!e)return}n&&(this.#c(),this.#h.add(this.#u,!0))}changeMode(t=Ke){this[Ot][oe][Je]=t}selectAll(){this.#d();const t=this[Ot].firstElementChild,e=this.#A,i=window.getSelection(),n=document.createRange();null!=t.firstChild&&(n.setStart(t.firstChild,0),n.setEnd(e.firstChild,e.firstChild.length),i.removeAllRanges(),i.addRange(n))}save(){if(this.#n)if(this.#s[Tn]("save")){if(null==this.#s.save)return!1;this.#s.save(this.text)}else this.#v();else if(this.#y(),this.#s[Tn]("save")){if(null==this.#s.save)return!1;this.#s.save(this.text)}}unsave(){0!==d(this[Ot][oe].saved)&&(this[Ot][oe].saved=0,this[on]&&this[on].unsave())}indent(t){if(9!==t.keyCode)return;const e=this[Ot];return this.#f((t=>{e[Gt][this.#a.start][xn]=Rs(this.#a.left+"    "+this.#a.right),this.#p();const i=this.#a.left[He]+4;this.#g(e[Gt][this.#a.start],i)})),!1}wrap(t){if(13!==t.keyCode)return;const e=this[Ot];return this.#f((t=>{e[Gt][this.#a.start][xn]=Rs(this.#a.left),this.#p(),e[jn][jn][Gn]+=28;const i=js(ue,Rs(this.#a.right));i[Pn]=t=>this.#c(),e[Nn](i,e[Gt][this.#a.start+1]),this.#g(e[Gt][this.#a.start+1],0)})),!1}backspace(t){if(8!==t.keyCode)return!1;const e=this[Ot];return this.#f((t=>{if(this.#u.isMulti||this.#u.isSingle)e[Gt][this.#a.start][xn]=Rs(this.#a.left+this.#a.right),this.#p(),this.#g(e[Gt][this.#a.start],this.#a.left[He]);else if(this.#a.left[He]){const t=this.#a.left[ki](0,this.#a.left[He]-1);e[Gt][this.#a.start][xn]=Rs(t+this.#a.right),this.#g(e[Gt][this.#a.start],t[He])}else{if(0===this.#a.start)return;e[Gt][this.#a.start-1][xn]+=Rs(this.#a.right),e[Gt][this.#a.start][Ai](),e[jn][jn][Gn]-=28;const t=e[Gt][this.#a.start-1][Sn][He]-this.#a.right[He];this.#g(e[Gt][this.#a.start-1],t)}})),!1}undo(){this.#d();const t=this.#h.undo();null!=t&&(this[Se](t[Xt][He]<1?null:t[Xt],!1,!1),this.unsave(),this.#g(this[Ot][Gt][t[xe]],t[si]),this.#n&&this.#y())}redo(){const t=this.#h.redo();null!=t&&(this[Se](t[Xt],!1,!1),this.unsave(),this.#g(this[Ot][Gt][t[xe]],t[si]),this.#n&&this.#y())}heading(t,e){const i=t[Ve]||t[ne],n=`${new Array(e).fill("#")[Le]("")}${0===e?"":" "}`;this.#u.check?this.#f((t=>{const s=this.#a.left[Ci](/^\s*\#*\s*/,""),o=this.#a.body,l=this.#a.right,r=`${i?`<h${e}>`:n}${s}${o}${l}${i?`</h${e}>`:""}`[Ci](/\n/g,""),u=r[He]-(i?5:0);this.#C(r,u),this.#m(!0,this.#n)})):(this.#b(i?`<h${e}></h${e}>`:n),this.#g(this.#A,n[He]-(i?5:0)),this.#m(!0,this.#n))}bold(t){this.#$(t,"**",Ms)}italic(t){this.#$(t,"*",Ts)}strikethrough(t){this.#$(t,"~~",ks)}underline(t){this.#$(t,xs,xs)}marker(t){this.#$(t,"==",qe)}sup(t){this.#$(t,"^",Oi)}sub(t){this.#$(t,"~",ji)}code(t){this.#u.check?this.#f((e=>{if(this.#u.isMulti){const t=js(ue,"```"),e=js(ue,"```");t[Pn]=e[Pn]=t=>this.#c(),this[Ot][Nn](t,this[Ot][Gt][this.#a.end+1]),this[Ot][Nn](e,this[Ot][Gt][this.#a.start]),this.#g(this[Ot][Gt][this.#a.end+1],this[Ot][Gt][this.#a.end+1][Sn][He]),this.#m(!0,this.#n)}else this.#$(t,"`",Vt)})):this.#$(t,"`",Vt)}blockquote(){this.#u.check?this.#f((t=>{for(let t=this.#a.start;t<=this.#a.end;t++){const e=this[Ot][Gt][t];e[xn]=Rs(`> ${e[Sn]}`)}const e=this[Ot][Gt][this.#a.end],i=e[Sn][He];this.#g(e,i),this.#m(!0,this.#n)})):(this.#b("> "),this.#g(this.#A,2),this.#m(!0,this.#n))}ul(){this.#M("-")}ol(){this.#M("1.")}link(t="",e=""){e[Qi]()[He]<1&&t[Qi]()[He]<1||this.#_(t,e)}image(t="",e="",i=""){t[Qi]()[He]<1||this.#_(i,t,e)}clear(){this.init(),this.#y()}download(t="md"){const e={md:"md",html:"html"}[t[Yi]()];if(null==e)return;let i="https://cdn.jsdelivr.net/npm/@pardnchiu/nanomd@1.9.4/dist/NanoMD-output.css";const n="md"===e?this.text[Qi]():`<!DOCTYPE html><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>NanoMD 輸出</title><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="preload" href="${i}" as="style"><link rel="stylesheet" href="${i}"><script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"><\/script></head><body><section class="pd-md-viewer">${ro(`\n${this.text}\n`)}</section></body></html>`;this.#I(e,n)}openfile(t){if(null==t)return void alert("請選擇檔案");this.clear();const e=new FileReader;e.readAsText(t),e.onload=()=>{this[Ot][xn]=null;const t=e.result[Qi]()[Ci](/[\u0020\u00A0]/g," ");this.init(t,!1),this.#y()}}get text(){return[...this[Ot][Gt]].map((t=>"SECTION"===t[Dn]?"":t[Sn]))[Le]("\n")}goBack(){this.undo()}goForward(){this.redo()}addHeading(t,e){this.heading(t,e)}addBold(t){this.bold(t)}addItalic(t){this.italic(t)}addStrikethrough(t){this.strikethrough(t)}addUnderline(t){this.underline(t)}addMarker(t){this.marker(t)}addSup(t){this.sup(t)}addSub(t){this.sub(t)}addCode(t){this.code(t)}addBlockquote(){this.blockquote()}addUl(){this.ul()}addOl(){this.ol()}addLink(t="",e=""){this.link(t,e)}addImage(t="",e="",i=""){this.image(t,e,i)}downloadMd(){this.download("md")}downloadHtml(){this.download("html")}getTxt(){return this.text}}t.PDMarkdownEditor=t.MDEditor=uo;class ao{check=!1;isMulti=!1;isSingle=!0;index;offset;left;right;selection={};multi={};constructor(e,i,s=!1){const o=t[In]();if(o.rangeCount<1)return;const l=o.getRangeAt(0);let r=i||Fs(l.commonAncestorContainer);if(null==r)return;let u,a,h="";if(s){r=e;const t=r[zn](ue);for(let e=0;e<t.length;e++){const i=t[e];h+=(0==e?"":"\n")+i[Sn]}u=0,a=t[He]-1}else l.cloneContents()[Ut][ve](((t,e)=>{h+=(0==e?"":"\n")+t[Sn]})),r===e&&(u=d(Fs(o.baseNode)[oe][xe])-1,a=d(Fs(o.focusNode)[oe][xe])-1);var c=n(r===e),f=!c&&!s&&n(o[jt]!==o[$n]),p=!!s||n(o[$n]>o[jt]),g=!!s||n(u<a);this.check=!0,this.index=c?null:d(r[oe][xe])-1,this.offset=c||f?null:d(o[$n]),this.left=c||f?null:r[Sn][ki](0,o[$n]),this.right=c||f?null:r[Sn][ki](o[$n],r[Sn][He]),this.isSingle=f,this.isMulti=c;const m=f?p?o[jt]:o[$n]:null,y=f?p?o[$n]:o[jt]:null;this.selection={body:f?o.toString():h,start:m,end:y,left:f?r[Sn][ki](0,m):null,right:f?r[Sn][ki](y,r[Sn][He]):null};const v=c?g?u:a:null,w=s?0:c?g?o[jt]:o[$n]:null,b=c?g?a:u:null,A=s?e[Gt][a][Sn][He]:c?g?o[$n]:o[jt]:null;this.multi={start:{index:v,offset:w},end:{index:b,offset:A},left:s?"":c?r[Gt][v][Sn][ki](0,w):null,right:s?"":c?r[Gt][b][Sn][ki](A,r[Sn][He]):null}}}class ho{#T;#k;#x=[];#S=[];constructor(t){this.#T=t}add(t,e,i){clearInterval(this.#k),null==i?this.#N(t,e):this.#k=setTimeout((i=>{this.#N(t,e)}),i)}#N(t,e){this.#x[mi]({[xe]:t[xe],[si]:t[si],[Xt]:[...this.#T[Gt]].filter((t=>"DIV"==t.nodeName)).map((t=>t[Sn]))[Le]("\n")}),e&&(this.#S=[])}undo(){const t=this.#x[(this.#x||[])[He]-2];if(null==t)return;let e=this.#x.pop();return this.#S[mi](e),t}redo(){const t=this.#S.pop();if(null!=t)return this.#x[mi](t),t}}class co{#T;#s;#i=!1;preventDefault=!0;#D={"cmd+meta":1};#E={"cmd+b":(t,e)=>t.bold(e),"cmd+i":(t,e)=>t.italic(e),"cmd+shift+x":(t,e)=>t.strikethrough(e),"cmd+u":(t,e)=>t.underline(e),"cmd+m":(t,e)=>t.marker(e),"cmd+k":(t,e)=>t.code(e),"cmd+arrowup":(t,e)=>t.sup(e),"cmd+arrowdown":(t,e)=>t.sub(e)};#P={"cmd+shift+z":(t,e)=>t.redo(),"cmd+r":void 0,f5:void 0,"cmd+z":(t,e)=>t.undo(),"cmd+a":(t,e)=>(t.selectAll(),!1),"cmd+s":(t,e)=>(t.save(),!1),tab:(t,e)=>t.indent(e),enter:(t,e)=>t.wrap(e),backspace:(t,e)=>t.backspace(e)};constructor(t={}){this.#T=t[ae],this.#s=t.event,this.#i=t.hotKey;const e=this.#L(this.#s);if(!this.#D[Tn](e)){if(this.#i&&this.#E[Tn](e)){if(!1===this.#E[e](this.#T,this.#s))return;return this.#T[Ot][oe].saved=0,void(this.#T[on]&&(this.#T[on][Ot][oe].saved=0))}if(this.#P[Tn](e)){if(!1===this.#P[e](this.#T,this.#s))return;return this.#T[Ot][oe].saved=0,void(this.#T[on]&&(this.#T[on][Ot][oe].saved=0))}this.preventDefault=!1}}#L(t){let e="";return(t.metaKey||t.ctrlKey)&&(e+="cmd+"),t.shiftKey&&(e+="shift+"),e+=t.key[Yi](),e}}class fo{editor;body;start;end;left;right;constructor(t,e){let i,n,s,o;this.editor=t,e.isMulti?(i=e.multi.start.index,n=e.multi.end.index,s=e.multi.left,o=e.multi.right):e.isSingle?(i=e.index,n=e.index,s=e.selection.left,o=e.selection.right):null!==e.index&&null!==e.offset&&(i=e.index,n=e.index,s=e.left,o=e.right),this.body=e.selection.body,this.start=d(i),this.end=d(n),this.left=s[Ci](/&lt;/g,"<")[Ci](/&gt;/g,">")[Ci](/&nbsp;/g," "),this.right=o[Ci](/&lt;/g,"<")[Ci](/&gt;/g,">")[Ci](/&nbsp;/g," ")}removeRows(){for(let t=this.end;t>this.start;t--)this.editor[Gt][t][Ai]()}}class po{#T;#n;#j;#R;constructor(t={}){this.#T=t.editor,this.#n=n(null==t.autoSave||t.autoSave);const e=Ii+"."+De+"-"+Ht,i=parseInt(this.#T[Ot][oe].pin||0);this.#T[Ot][oe].wrap;let s=this.#T[Ot][vi](e);if(this.#j=/nanomd\.pardn\.io/[Gi](f[_e]),s)return;const o=[{[Qe]:"format_bold",[Vi]:"添加粗體",[$i]:t=>this.#T.bold(t)},{[Qe]:"format_italic",[Vi]:"添加斜體",[$i]:t=>this.#T.italic(t)},{[Qe]:"strikethrough_s",[Vi]:"添加刪除線",[$i]:t=>this.#T.strikethrough(t)},{[Qe]:"format_underlined",[Vi]:"添加底線",[$i]:t=>this.#T.underline(t)},{[Qe]:"ink_marker",[Vi]:"添加高亮",[$i]:t=>this.#T.marker(t)},{[Qe]:"superscript",[Vi]:"添加上標",[$i]:t=>this.#T.sup(t)},{[Qe]:"subscript",[Vi]:"添加下標",[$i]:t=>this.#T.sub(t)},{[Qe]:"format_quote",[Vi]:"添加引用",[$i]:t=>this.#T.blockquote(t)},{[Qe]:"format_list_bulleted",[Vi]:"添加無序列表",[$i]:t=>this.#T.ul(t)},{[Qe]:"format_list_numbered",[Vi]:"添加有序列表",[$i]:t=>this.#T.ol(t)},{[Qe]:"code",[Vi]:"添加代碼塊",[$i]:t=>this.#T.code(t)},{[Qe]:"link",[Vi]:"添加連結",[$i]:t=>this.#T.link("連結文字","連結")},{[Qe]:"landscape",[Vi]:"添加圖片",[$i]:t=>this.#T.image("圖片連結","圖片名稱")},{},this.#n?null:{[Qe]:"autorenew",[Vi]:"儲存並預覽",[$i]:t=>this.#T.save(t)},{[Qe]:i?"keep_off":"keep",[Vi]:"釘選面板",[$i]:t=>this.#O(t)},{[Qe]:"wrap_text",[Vi]:"換行",[$i]:t=>this.#F()},this.#j?{[Qe]:"cloud_upload",[Vi]:"部署",[$i]:t=>this.#H()}:null].map((t=>{if(null==t)return;if(null==t[Qe]){return js("span")}let e=js("span.material-symbols-outlined",{title:t.title,[Qe]:t[Qe]},t[Qe]);return e[Pn]=t.click,e}));s=js(e,o),s[Qt]=!1,s[oe].hide=1,this[Ot]=s}#O(t){const e=t.target,i=d(this.#T[Ot][oe].pin||0);this.#T[Ot][oe].pin=Math.abs(i-1),e[Sn]=i?"keep":"keep_off",e[Vi]=i?"釘選面板":"取消釘選"}#F(){const t=d(this.#T[Ot][oe].wrap||1);this.#T[Ot][oe].wrap=Math.abs(t-1)}async#H(){const e=new URL(location.href),i=navigator.language||navigator.userLanguage;let n=e.searchParams.get("lang"),s=/^zh/i.test(i);null!=n&&(s=/^zh/i.test(n)),null==this.#R&&(this.#R=Date.now()+"."+Gs(16)),fetch("https://nanomd-deploy.pardn.workers.dev/",{method:"POST",headers:{"Content-Type":"application/json"},[Ot]:l[It]({[_t]:this.#R,[nn]:ro(`\n${this.#T.text}\n`)})[Qi]()[Ci](/[\u2028\u2029]/g,"")}).then((t=>t.text())).then((async e=>{confirm(s?"已成功部署並複製連結\n開啟頁面?":"Deployment successful and link copied.\nOpen the page?")&&t.open("https://nanomd-cloud.pardn.workers.dev/"+e)})).catch((t=>alert("Error:"+t.message)))}}class go{tag="";props={};children=[];data=null;constructor(t){if(t[Jn][Yi]()===Mi){let i=!1;for(const n of e[Ce][zn](Mi)||[])if(null!=t[Di]&&n[Di]===t[Di]||null!=t[Zi]&&n[Zi]===t[Zi]){i=!0;break}i||e[Ce][Et](t),this[Hi]=Mi}this[Hi]=t[Jn][Yi](),this[di]=[...t.attributes].reduce(((t,e)=>(t[e.name]=e.value.trim(),t)),{}),this[Gt]=function(t){return s[we](t[Ut]).filter((t=>t[St]===a[xt]||t[St]===a[kt]&&t[Zi]&&t[Zi][Qi]()[He]>0))}(t)[Ze]((t=>t.nodeType===Node[xt]?new go(t):t[Zi]||""))}getPatches(t){return this.#z(t,this)}#z(t,e,i=[]){if(null==t&&e)return[{[tn]:Cs.create,[xe]:i,[hn]:e}];if(t&&!e)return[{[tn]:Cs.remove,[xe]:i}];if(!t&&!e)return[];if(t.tag!==e.tag)return[{[tn]:Cs[Ci],[xe]:i,[hn]:e}];const n=[];return n[mi](...this.#K(t,e,i)),n[mi](...this.#B(t,e,i)),n}#K(t,e,i=[]){if(null==t||"string"==typeof t||null==e||"string"==typeof e)return[];const n=[],s=t[di]||{},l=o[Tt](s)[He],r=e[di]||{},u=o[Tt](r)[He];if(u>0)for(let t in r){const s=r[t];n[mi]({[tn]:Cs.prop,[hn]:e,key:t,value:s,[xe]:i})}if(l>0){if(u<1)for(let t in s)n[mi]({[tn]:Cs.prop,[hn]:e,key:t,[nn]:null,[xe]:i});for(let t in r)u>0&&!(t in r)&&n[mi]({[tn]:Cs.prop,[hn]:e,key:t,[nn]:null,[xe]:i})}return n}#B(t,e,i=[]){if(null==t||"string"==typeof t||null==e||"string"==typeof e)return[];const n=[],o=s[Pe](t[Gt])?t[Gt]:[],l=s[Pe](e[Gt])?e[Gt]:[],u=r.max(o[He],l[He]);for(let t=0;t<u;t++){const s=o[t],r=l[t],u=i.concat(t);if("string"==typeof s&&"string"==typeof r){if(s===r)continue;n[mi]({[tn]:Cs.text,[hn]:e,[nn]:r,[xe]:u})}else null==s?n[mi]({[tn]:Cs.append,[hn]:r,[xe]:u}):null==r?n[mi]({[tn]:Cs.remove,index:u}):n[mi](...this.#z(s,r,u))}return n}}t.PDMarkdownViewer=t.MDViewer=class{body;vbody;#U;#G="";#Z=300;#q=0;#W;#V;#T;constructor(t={}){if((de in t||ci in t)&&(this.#G=String(t[de]||t[ci]||"")[Qi]()),Li in t){t[Li]}const s=t[Li]||{},o=i(s[Je]||Lt)[Qi]()[Yi](),l=n(null==s.fill?1:s.fill)?1:0,r=i(s[ye]||"")[Qi]()||"'Noto Sans TC', sans-serif",u=t.sync||{};this.#Z=d(null==u[le]?300:u[le])||300,this.#q=n(u[_i]||0)?1:0,this[ae]=u[ae]instanceof uo?u[ae]:null,e[Ce][Et](js(Li,`.${ai}{font-family: ${r}}`));const a=document[cn](t[Ie]);typeof t[Ie]===Ei&&null!=a?(this[Ot]=a,a.classList.add(ai)):this[Ot]=js(Ii+"."+ai),this[Ot][oe][Je]=y&&o===Lt||o===se?se:"",this[Ot][oe].fill=l,this[Ot][oe].sync=null==this[ae]?0:1;const h=t.hashtag||{};if(this.#W=i(h.path||"")[Qi](),this.#V=i(h[zi]||"")[Qi](),null!=t.fillMode){let e=n(t.fillMode)?1:0;this[Ot][oe].fill=e}if(null!=t[le]&&(this.#Z=d(t[le])||300),null!=t[Un]&&(this.#q=n(t[Un])?1:0),null!=t[ye]){let n=i(t[ye])[Qi]()||"'Noto Sans TC', sans-serif";e[Ce][Et](js(Li,`.${ai}{font-family: ${n}}`))}null!=t[Xn]&&(this.#W=i(t[Xn]||"")[Qi]()),null!=t[Qn]&&(this.#V=i(t[Qn]||"")[Qi]()),this.vbody=new go(this[Ot]),this.init()}get editor(){return this.#T}set editor(t){this.#T&&(this.#T[Ot][Ln]=null),null!=t&&(this.#T=t,this.#T.viewer=this,this.#q&&null!=this.#T&&(this.#T[Ot][Ln]=t=>{this[Ot][Gn]+=t.deltaY}))}#Y(){if(null==this.#T)return"";const t=[...this.#T[Ot][zn](ue)];let e="";for(let n of t){var i=n[Sn][Ci](/[\u00A0\u0020]/g," ");i[Qi]()[He]<1?e+="\n":e+=i+"\n"}return e[Qi]()}clear(){let t=this[Ot].cloneNode(!0);t[xn]="";let e=new go(t);this[Ot][xn]="",this.vbody=e}unsave(){0!==d(this[Ot][oe].saved)&&(this[Ot][oe].saved=0)}init(e=""){this[Ot][oe].saved=1;let i=this.#G,n=this[Ot][Gn];t[qt](this.#U),this.#U=t[Yn]((()=>{if(t[qt](this.#U),i&&this[Ot][xn]&&i===this[Ot][xn])return;let o=e||this.#Y()||i;o=ro(`\n${o}\n`,this.#W,this.#V);let l=this[Ot].cloneNode(!0);l[xn]=o;let r=new go(l);const u=r.getPatches(this.vbody);s[Pe](u)&&this.#J(this[Ot],u),this.vbody=r;for(let e of[...this[Ot][zn](Ht+"."+ee)])e[Pn]=async e=>{t[qt](Ls);const i=e[zi][jn],n=i[yn],s=i[Gt][0][Sn];try{await navigator.clipboard.writeText(s),n[Nt](Ri),Ls=t[Yn]((t=>{n[Ai](Ri)}),1e3)}catch(t){console[fe](t),n[Nt](fe)}};let a=setInterval((()=>{null!=PR&&(clearInterval(a),this[Ot][Gn]=n,PR.prettyPrint())}),50)}),this.#Z)}changeMode(t=Ke){this[Ot][oe][Je]=t}#J(t,e){if(null!=t&&s[Pe](e)){this.#X(t,e);for(const i of e){const{index:e}=i,n=l.parse(l[It](e||[]));let s;i.type===Cs.append&&(s=n?.pop());const o=n?this.#Q(t,n):t;o&&(i.type===Cs.create&&hn in i?this.#tt(o,i):i.type===Cs.replace&&hn in i&&null!=o[Rn]?this.#et(o,i):i.type===Cs.append&&hn in i&&null!=s?this.#it(o,i,s):i.type===Cs.prop&&_t in i&&nn in i&&o instanceof Element?this.#nt(o,i.key,i.value||"",i[hn]):i.type===Cs.text&&nn in i&&o.nodeType===a[kt]&&(o[Zi]=i.value||""))}}}#X(t,e){const i=e.filter((t=>t.type===Cs.remove)).sort(((t,e)=>{const i=(e.index.length||0)-(t.index.length||0);if(0!==i)return i;for(let i=0;i<(t.index.length||0);i++)if((t.index[i]||0)!==(e.index[i]||0))return(e.index[i]||0)-(t.index[i]||0);return 0}));for(const e of i){const i=this.#Q(t,e.index);null!=i&&null!=i[Rn]&&i[Rn].removeChild(i)}}#tt(t,i){if(i.type!==Cs.create||!(hn in i))return;const n="string"==typeof i[hn]?e[bn](i[hn]):this.#st(i[hn]);null!=t[jn]&&t[jn][Et](n)}#et(t,i){if(i.type!==Cs.replace||!(hn in i)||null==t[Rn])return;const n="string"==typeof i[hn]?e[bn](i[hn]):this.#st(i[hn]);if(t[Rn].replaceChild(n,t),!(n instanceof Text||"string"==typeof i[hn])){for(const t in i[hn][di])this.#nt(n,t,i[hn][di][t]||"",i[hn]);this.#ot(i[hn],n)}}#it(t,i,n){if(i.type!==Cs.append||!(hn in i)||null==n)return;const s="string"==typeof i[hn]?e[bn](i[hn]):this.#st(i[hn]);if(n+1>t[Gt][He]?t[Et](s):t.insertBefore(s,t[Gt][n+1]),"string"!=typeof i[hn]){for(const[e,s]of o.entries(i[hn][di]))this.#nt(t[Gt][n],e,s||"",i[hn]);this.#ot(i[hn],t[Gt][n])}}#nt(t,e,i,n){null==i?t[_removeAttribute](e):null!=t&&t[Zn](e,i)}#ot(t,e){if("string"!=typeof t)for(const i in t.children.filter((t=>"string"!=typeof t))){if(null==e)continue;const n=t.children[+i],s=e.children[+i];if("string"!=typeof n){for(const[t,e]of o.entries(n[di]))this.#nt(s,t,e||"",n);this.#ot(n,s)}}}#Q(t,e){let i=t,n=s.from(i.childNodes).filter((t=>t.nodeType===a[xt]||t.nodeType===a[kt]&&""!==t[Zi]?.trim()))||[];for(const t of e)i=n[t],null!=i&&(n=s.from(i.childNodes).filter((t=>t.nodeType===a[xt]||t.nodeType===a[kt]&&""!==t[Zi]?.trim()))||[]);return i}#st(t){const i=e.createElement(t.tag);if(t[di])for(const[e,n]of o.entries(t[di]))e[Mt](":")||e[Mt]("@")||void 0!==n&&i[Zn](e,n);for(const n of t[Gt])"string"==typeof n?i[Et](e[bn](n)):i[Et](this.#st(n));return i}}}("undefined"==typeof window?window={}:window);export const editor = window.MDEditor; export const MDEditor = window.MDEditor; export const viewer = window.MDViewer; export const MDViewer = window.MDViewer;
