let R,N,D,L,z,O,M,j,P,H,B,Y,F,U,K,q,V,Z,W,G,Q,X,J,ee,ne,re,oe,le,te=[],ie=[],se=null;export class editor{constructor(t={}){const i=(t[r]||"").trim()||e;document.head[b]([ge._(`\n#${i}>div.inputFocus {background-color: ${t.focusBackgroundColor||"#0000ff1a"}; color: ${t.focusTextColor||"#0000ffff"};}\n#${i}>div:nth-last-child(1):empty::after {content: "${t.placeholder||"Type here ..."}"; color: ${t.placeholderColor||"#bfbfbf"};}`)]),this[x]=(_e+"#"+i+"."+we)._({"data-fillMode":null==t.fillMode?1:t.fillMode,"data-row":null==t.showRow?1:t.showRow});const n=this[x];null==se&&(se=window.addEventListener("beforeunload",(function(e){e.preventDefault()}))),n._mouseup((e=>{this.#e()}))._touchend((e=>{this.#e()}))._cut((e=>(this.#t((t=>{e[c].setData(ve,N),n[$](D)[m]=(z+O).$html,this.#i(),this.#r(n[$](D),z[_])})),this.#o(!0),!1)))._paste((e=>(this.#t((t=>{const i=((e[c]||window[c]).getData("Text")||"").$ary(/\n/),r=i[_],o=r-1,d=r>1,l=D+o,s=`${d?"":z}${i[o]}`[_],h=i[0],a=d?"":O;if(n[$](D)[p]=z+h+a,this.#i(),d)for(let e=1;e<r;e++){const t=i[e];n[b](w._(`${t}${e===o?O:""}`.$html)._click((()=>this.#e())),n[$](D+e))}this.#r(n[$](l),s,s)})),this.#o(!0),!1)))._input((e=>{let t,i;clearTimeout(R),"deleteCompositionText"===e.inputType&&(t=H,i=B,n.$childAll.forEach((e=>{if(e[o][g]()===w)return!1;e.remove(),n[b](w._({index:t+1})._click((e=>this.#e())),n[$](t)),this.#r(n[$](t),i)}))),e.inputType,this.#e(),R=setTimeout((()=>{this.#o(!0)}),300)}))._keydown((e=>{const t=e.metaKey||e.ctrlKey,i=e.shiftKey,r="b"===e.key||"B"===e.key,o="i"===e.key||"I"===e.key,n="s"===e.key||"S"===e.key,d="u"===e.key||"U"===e.key,l="m"===e.key||"M"===e.key,s="z"===e.key||"Z"===e.key,h="r"===e.key||"R"===e.key,a="k"===e.key||"K"===e.key,c="ArrowUp"===e.key,m="ArrowDown"===e.key,u="f5"===e.key||"F5"===e.key;return t&&i&&s?(this.goForward(),!1):t&&s?(this.goBack(),!1):!(t&&h||u)&&(t&&r?(this.#n(e,$e,be),!1):t&&o?(this.#n(e,ye,ke),!1):t&&n?(this.#n(e,xe,Ae),!1):t&&d?(this.#n(e,Ee,Te),!1):t&&l?(this.#n(e,Ie,me),!1):t&&c?(this.#n(e,Ce,Se),!1):t&&m?(this.#n(e,De,Re),!1):t&&a?(this.#n(e,ze,pe),!1):(this.#e(),"Tab"===e.key?this.#d(e):"Enter"===e.key?this.#l(e):"Backspace"===e.key?this.#s(e):void 0))}))._keyup((e=>{n[E]&&1===n[E][_]&&n[T][o][g]()!==w&&this.init(null,!1),this.#e(),this.viewer&&this.viewer.init()}))._blur((e=>{(w+"."+v).$&&(w+"."+v).$[y](v)}))}get viewer(){return this.md_viewer}set viewer(e){this.md_viewer=e}#e(t){function i(t){if(t)return t[r]===e||t[o][g]()===w&&t[l][r]===e?t:i(t[l])}(w+"."+v).$&&(w+"."+v).$[y](v);const n=window[a]();if(n.rangeCount<1)return;const d=n.getRangeAt(0),s=t||i(d.commonAncestorContainer);if(null==s)return;s._class(v);let c="";var m,b;d.cloneContents()[S].forEach(((e,t)=>{c+=(0==t?"":"\n")+e[p]})),s===this[x]&&(m=parseInt(i(n.baseNode).$attr("index"))-1,b=parseInt(i(n.focusNode).$attr("index"))-1);var k=Boolean(s===this[x]),A=!k&&Boolean(n[h]!==n[u]),T=Boolean(n[u]>n[h]),E=Boolean(m<b);M=!0,H=k?null:parseInt(s.$attr("index"))-1,B=k||A?null:parseInt(n[u]),Y=k||A?null:s[p][f](0,n[u]),F=k||A?null:s[p][f](n[u],s[p][_]),P=A,U=A?n.toString():c,K=A?T?n[h]:n[u]:null,q=A?T?n[u]:n[h]:null,V=A?s[p][f](0,K):null,Z=A?s[p][f](q,s[p][_]):null,j=k,W=k?E?m:b:null,G=k?E?n[h]:n[u]:null,Q=k?E?b:m:null,X=k?E?n[u]:n[h]:null,J=k?s[$](W)[p][f](0,G):null,ee=k?s[$](Q)[p][f](X,s[p][_]):null}#t(e){let t,i,r,o;j?(t=W,i=Q,r=J,o=ee):P?(t=H,i=H,r=V,o=Z):null!==H&&null!==B&&(t=H,i=H,r=Y,o=F),N=U,D=parseInt(t),L=parseInt(i),z=r.__(/&lt;/g,"<").__(/&gt;/g,">").__(/&nbsp;/g," "),O=o.__(/&lt;/g,"<").__(/&gt;/g,">").__(/&nbsp;/g," "),e()}#i(){for(let e=L;e>D;e--)this[x][$](e).remove()}#r(e,t,i){this[x].$selAll(w).forEach(((e,t)=>{e._attr({index:t+1})})),window[a]?window[a]()[d]?window[a]()[d]():window[a]()[A]&&window[a]()[A]():document[s]&&document[s][d]();var r=window[a](),o=document.createRange(),n=t??e[S][0][_],l=i??n;o.selectNode(e),e[S][0]?(o[C](e[S][0],n>e[S][0][_]?e[S][0][_]:n),o[k](e[S][0],l>e[S][0][_]?e[S][0][_]:l)):(o[C](e,0),o[k](e,0)),r.addRange(o),this.#e(e)}#d(e){if(9!==e.keyCode)return;const t=this[x];return this.#t((e=>{t[$](D)[m]=(z+"    "+O).$html,this.#i();const i=z[_]+4;this.#r(t[$](D),i)})),!1}#l(e){if(13!==e.keyCode)return;const t=this[x];return this.#t((e=>{t[$](D)[m]=z.$html,this.#i(),t.$parent(1)[I]+=28,t[b](w._(O.$html)._click((()=>this.#e())),t[$](D+1)),this.#r(t[$](D+1),0)})),!1}#s(e){if(8!==e.keyCode)return!1;const t=this[x];return this.#t((e=>{if(j||P)t[$](D)[m]=(z+O).$html,this.#i(),this.#r(t[$](D),z[_]);else if(z[_]){const e=z[f](0,z[_]-1);t[$](D)[m]=(e+O).$html,this.#r(t[$](D),e[_])}else{if(0===D)return;t[$](D-1)[m]+=O.$html,t[$](D).$rm(),t.$parent(1)[I]-=28;const e=t[$](D-1)[p][_]-O[_];this.#r(t[$](D-1),e)}})),!1}#h(e){this[x][$](-1)[p].trim().length<1?this[x][$](-1)[m]=e.$html:this[x][b]([w._(e.$html)._click((()=>this.#e()))]),this[x][I]=this[x].scrollHeight}#a(e,t){this[x][$](D)[m]=e.$html,this.#i(),this.#r(this[x][$](D),t),this.viewer&&this.viewer.init()}#n(e,t="",i=""){const r=e.metaKey||e.ctrlKey;M?this.#t((e=>{const o=O,n=`${z}${r?`<${i}>`:t}${N}${r?`</${i}>`:t}${o}`.__(/\n/g,""),d=n[_]-o[_]-(r?i.length+3:t.length);this.#a(n.$html,d),this.#o(!0)})):(this.#h((r?`<${i}></${i}>`:`${t}${t}`).$html),this.#r(this[x][$](-1),r?i.length+3:t.length),this.#o(!0))}#c(e){M?this.#t((t=>{for(let t=D;t<=L;t++){const i=this[x][$](t);i[m]=`${e} ${i[p]}`.$html}const i=this[x][$](L),r=i[p][_];this.#r(i,r),this.#o(!0),this.viewer&&this.viewer.init()})):(this.#h(e.$html),this.#r(this[x][$](-1),e.length+1),this.#o(!0))}#m(e="",t="",i){if(M)return void this.#t((r=>{const o=O,n=`${z} ${null==i?"":"!"}[${e}](${t}) ${o}`.__(/\n/g,""),d=n[_]-o[_]-1;this.#a(n.$html,d),this.#o(!0)}));this.#h(`${null==i?"":"!"}[${e}](${t})`.$html);const r=this[x][$](-1),o=r[p][_];this.#r(r,o),this.#o(!0),this.viewer&&this.viewer.init()}#o(e){te.push(this.getTxt()),e&&(ie=[])}#u(e,t){let i=`Markdown-Editor.${e}`,r=new Blob([t],{type:"application/octet-stream"}),o=URL.createObjectURL(r),n="a"._({href:o,download:i});_child(n),n.click()}init(e,t=!0){if(this[x].contentEditable=!0,this[x][m]=null,null!=e){const t=e.__(/\n*$/,"").split("\n");t.forEach(((e,t)=>{this[x][b]([w._({index:t+1},e.$html)._click((()=>this.#e()))])})),this[x][b]([w._({index:t[_]+1})._click((()=>this.#e()))]),this.#r(this[x][$](H||0),0)}else this[x][b]([w._({index:1})._click((()=>this.#e()))]),this.#r(this[x][T],0);t&&this.#o(!0)}goBack(){const e=te.$(-2);if(null==e)return;let t=te.pop();ie.push(t),this.init(e[_]<1?null:e,!1),this.viewer&&this.viewer.init()}goForward(){const e=ie.pop();null!=e&&(te.push(e),this.init(e,!1),this.viewer&&this.viewer.init())}addHeading(e,t){const i=e.metaKey||e.ctrlKey,r=`${new Array(t).fill("#").join("")}${0===t?"":" "}`;M?this.#t((e=>{const o=z.__(/^\s*\#*\s*/,""),n=`${i?`<h${t}>`:r}${o}${N}${O}${i?`</h${t}>`:""}`.__(/\n/g,""),d=n[_]-(i?5:0);this.#a(n.$html,d),this.#o(!0)})):(this.#h((i?`<h${t}></h${t}>`:r).$html),this.#r(this[x][$](-1),r[_]-(i?5:0)),this.#o(!0))}addBold(e){this.#n(e,$e,be)}addItalic(e){this.#n(e,ye,ke)}addStrikethrough(e){this.#n(e,xe,Ae)}addUnderline(e){this.#n(e,Ee,Te)}addMarker(e){this.#n(e,Ie,me)}addSup(e){this.#n(e,Ce,Se)}addSub(e){this.#n(e,De,Re)}addBlockquote(){M?this.#t((e=>{for(let e=D;e<=L;e++){const t=this[x][$](e);t[m]=`> ${t[p]}`.$html}const t=this[x][$](L),i=t[p][_];this.#r(t,i),this.#o(!0),this.viewer&&this.viewer.init()})):(this.#h("> ".$html),this.#r(this[x][$](-1),2),this.#o(!0))}addUl(){this.#c("-")}addOl(){this.#c("1.")}addCode(e){M?this.#t((t=>{j?(this[x][b](w._("```")._click((()=>this.#e())),this[x][$](L+1)),this[x][b](w._("```")._click((()=>this.#e())),this[x][$](D)),this.#r(this[x][$](L+1),this[x][$](L+1)[p][_]),this.viewer&&this.viewer.init(),this.#o(!0)):this.#n(e,ze,pe)})):this.#n(e,ze,pe)}addLink(e="",t=""){t.trim().length<1&&e.trim().length<1||this.#m(e,t)}addImage(e="",t="",i=""){e.trim().length<1||this.addLink(i,e,t)}clear(){this.init(),this.viewer&&this.viewer.init()}downloadMd(){this.#u("md",this.getTxt().trim())}downloadHtml(){this.#u("html",`<!DOCTYPE html> <html lang="zh-hant"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <title>Markdown Editor</title> <link rel="stylesheet" href="https://pardnchiu.github.io/markdown-editor/css/PDMDEditor.css"> <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"><\/script> <style> body { display: flex; justify-content: center; align-item: flex-start; width: 100%; height: 100%; overflow: scroll; } * { -ms-overflow-style: none; scrollbar-width: none; -webkit-overflow-scrolling: touch; touch-action: manipulation; background-color: ghostwhite; } *::-webkit-scrollbar { display: none; } body>section { padding: 1rem !important; width: 100%; background-color: #fff; box-sizing: border-box; box-shadow: 0 0.25rem 0.5rem #0000000d; transition: 0.3s; } @media screen and (min-width: 640px) { body>section { padding: 3rem !important; max-width: 800px; } } </style> </head> <body><section class="pd-md-viewer">${`\n${this.getTxt()}\n`.md_to_html()}</section></body> </html><!DOCTYPE html>`)}openfile(e){if(null==e)return void alert("請選擇檔案");const t=new FileReader;t.readAsText(e),t.onload=()=>{this[x][m]=null;const e=t.result.trim().__(/[\u0020\u00A0]/g," ");this.init(e.$html),this.viewer&&this.viewer.init(e)}}getTxt(){return this[x].$childAll.map((e=>e[p])).join("\n")}}document.head._child(["script"._({src:"https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"})]);export class viewer{#p;#f;#w;#g;constructor(e={}){const t=(e[r]||"").trim()||fe;var i;this.#p=(e.pre||"").trim(),this.#f=parseInt(e.delay)||300,this.#w=parseInt(e.scrollSync)||0,this.editor=e.editor instanceof editor?e.editor:null,ne=(e.tagPath||"").trim()||null,re=null==e.tagTarget?"_blank":e.tagTarget,document.head._child(["link"._({rel:"stylesheet",href:"data:text/css;base64,"+(i='\n                    .pd-md-editor{position:relative;display:flex;flex-flow:column;justify-content:flex-start;align-items:flex-start;gap:.5rem;margin:0;padding:1.5rem 0;overflow:hidden scroll}.pd-md-editor[data-fillMode="1"]{position:absolute;top:0;left:0;bottom:0;right:0;width:100%;height:100%}.pd-md-editor[data-row="1"]::before{content:"";position:fixed;z-index:0;top:0;left:0;bottom:0;width:3rem;background-color:#efefef}.pd-md-editor[data-row="1"]>div{padding:0 1rem 0 0}.pd-md-editor[data-row="1"]>div::before{content:attr(index);margin-right:1rem;flex-shrink:0;width:3rem;line-height:1.5rem;min-height:1.5rem;font-family:monospace;font-size:.75rem;text-align:center}.pd-md-editor>div{z-index:1;display:flex;flex-shrink:0;padding:0 1rem;width:100%;min-height:1.5rem;line-height:1.5rem;font-size:.875rem;margin:0;transition:.3s}.pd-md-viewer{position:relative;margin:0;padding:0 0 5rem;overflow:hidden scroll;font-size:.875rem;word-break:break-word;word-wrap:break-word}.pd-md-viewer[data-fillMode="1"]{position:absolute;top:0;left:0;bottom:0;right:0;width:100%;height:100%}.pd-md-viewer *{all:revert;margin:0 0 .75rem;padding:0;flex-shrink:0;max-width:100% !important;font-family:inherit;font-style:inherit;font-weight:inherit;font-size:.875rem;letter-spacing:.5px;color:inherit;white-space:inherit;word-break:inherit;word-wrap:inherit;border:none;outline:none;object-fit:cover;appearance:unset;-webkit-appearance:unset;-moz-appearance:unset;overflow:visible}.pd-md-viewer * h1,.pd-md-viewer * h2,.pd-md-viewer * h3,.pd-md-viewer * h4,.pd-md-viewer * h5,.pd-md-viewer * h6{padding:.5rem 0 .25rem !important;margin:.25rem 0 .5rem !important}.pd-md-viewer * b,.pd-md-viewer * strong,.pd-md-viewer * i,.pd-md-viewer * em,.pd-md-viewer * u,.pd-md-viewer * s,.pd-md-viewer * a,.pd-md-viewer * mark{font-size:inherit !important;line-height:inherit !important}.pd-md-viewer *:nth-last-child(1){margin-bottom:0}.pd-md-viewer>*:nth-child(1){margin-top:1rem !important}.pd-md-viewer h1,.pd-md-viewer h2,.pd-md-viewer h3,.pd-md-viewer h4,.pd-md-viewer h5,.pd-md-viewer h6{font-weight:700;color:#000}.pd-md-viewer h1 code,.pd-md-viewer h2 code,.pd-md-viewer h3 code,.pd-md-viewer h4 code,.pd-md-viewer h5 code,.pd-md-viewer h6 code{line-height:inherit !important}.pd-md-viewer h1,.pd-md-viewer h2{padding:1.5rem 0 .5rem}.pd-md-viewer h3,.pd-md-viewer h4{padding:1.25rem 0 .25rem}.pd-md-viewer h5,.pd-md-viewer h6{padding:1rem 0 0}.pd-md-viewer h1,.pd-md-viewer h2,.pd-md-viewer hr{border:none;border-bottom:1px solid #ddd}.pd-md-viewer h1{font-size:2rem}.pd-md-viewer h1 code,.pd-md-viewer h1 sup,.pd-md-viewer h1 sub{font-size:calc(2rem - 1px)}.pd-md-viewer h2{font-size:1.5rem}.pd-md-viewer h2 code,.pd-md-viewer h2 sup,.pd-md-viewer h2 sub{font-size:calc(1.5rem - 1px)}.pd-md-viewer h3{font-size:1.375rem}.pd-md-viewer h3 code,.pd-md-viewer h3 sup,.pd-md-viewer h3 sub{font-size:calc(1.375rem - 1px)}.pd-md-viewer h4{font-size:1.25rem}.pd-md-viewer h4 code,.pd-md-viewer h4 sup,.pd-md-viewer h4 sub{font-size:calc(1.25rem - 1px)}.pd-md-viewer h5{font-size:1.125rem}.pd-md-viewer h5 code,.pd-md-viewer h5 sup,.pd-md-viewer h5 sub{font-size:calc(1.125rem - 1px)}.pd-md-viewer h6{font-size:1rem}.pd-md-viewer h6 code,.pd-md-viewer h6 sup,.pd-md-viewer h6 sub{font-size:calc(1rem - 1px)}.pd-md-viewer hr{margin:.75rem 0 !important}.pd-md-viewer b,.pd-md-viewer strong{font-weight:700}.pd-md-viewer p{line-height:1.75rem;min-height:1.75rem}.pd-md-viewer i,.pd-md-viewer em{font-style:italic}.pd-md-viewer mark{background-color:#ff0}.pd-md-viewer sup,.pd-md-viewer sub{font-size:.75rem}.pd-md-viewer a{position:relative;letter-spacing:1px;font-weight:500;color:blue}.pd-md-viewer a.tag::before{content:"#"}@media(hover: hover){.pd-md-viewer a:hover::after{top:-1.5rem;padding:0 .5rem;max-width:unset;opacity:1}}.pd-md-viewer a::after{content:attr(href);position:absolute;z-index:1;top:0;left:0;padding:0;max-width:100%;line-height:1.5rem;white-space:nowrap;font-size:.75rem;border-radius:.25rem;background-color:#777;color:#fff;opacity:0;transition:.3s;pointer-events:none}.pd-md-viewer figure{position:relative;display:inline-block;vertical-align:top}@media(hover: hover){.pd-md-viewer figure:hover figcaption{padding:0 .5rem;max-width:unset;opacity:1}}.pd-md-viewer figure img{margin-bottom:0;overflow:hidden}.pd-md-viewer figure figcaption{position:absolute;z-index:1;top:.5rem;left:.5rem;padding:0;max-width:100%;line-height:1.5rem;white-space:nowrap;font-size:.75rem;border-radius:.25rem;background-color:#777;color:#fff;opacity:0;transition:.3s}.pd-md-viewer img[src]:not([src=""]){background-color:rgba(0,0,0,.0509803922)}.pd-md-viewer video{background-color:rgba(0,0,0,.0509803922)}.pd-md-viewer table{table-layout:fixed;border-collapse:collapse}.pd-md-viewer table thead{background-color:rgba(0,0,0,.1019607843)}.pd-md-viewer table tbody tr:nth-child(2n){background-color:rgba(0,0,0,.0509803922)}.pd-md-viewer table th,.pd-md-viewer table td{padding:.375rem .75rem;border:1px solid rgba(0,0,0,.2039215686);border-collapse:collapse;border-radius:.125rem}.pd-md-viewer ul,.pd-md-viewer ol{margin:.5rem 0 .5rem 1.5rem;padding-left:.5rem;background-color:rgba(0,0,0,.0117647059)}.pd-md-viewer ul *,.pd-md-viewer ol *{margin-bottom:0}.pd-md-viewer ul li,.pd-md-viewer ol li{line-height:1.75rem;min-height:1.75rem;list-style-position:outside;letter-spacing:1px}.pd-md-viewer ul li::marker,.pd-md-viewer ol li::marker{font-family:"Roboto Mono",monospace;font-size:.75rem}.pd-md-viewer ul ul,.pd-md-viewer ul ol,.pd-md-viewer ol ul,.pd-md-viewer ol ol{margin-top:0}.pd-md-viewer ul>li{list-style-type:disc}.pd-md-viewer ul>li>ul>li{list-style-type:circle}.pd-md-viewer ul>li>ul>li>ul>li{list-style-type:square}.pd-md-viewer ul>li>ul>li>ul>li>ul>li{list-style-type:"+ "}.pd-md-viewer ul>li>ul>li>ul>li>ul>li>ul>li{list-style-type:"- "}.pd-md-viewer ul>li>ul>li>ul>li>ul>li>ul>li>ul>li{list-style-type:"> "}.pd-md-viewer ol>li{list-style-type:decimal}.pd-md-viewer ol>li>ol>li{list-style-type:upper-alpha}.pd-md-viewer ol>li>ol>li>ol>li{list-style-type:lower-alpha}.pd-md-viewer ol>li>ol>li>ol>li>ol>li{list-style-type:upper-roman}.pd-md-viewer ol>li>ol>li>ol>li>ol>li>ol>li{list-style-type:lower-roman}.pd-md-viewer ol>li>ol>li>ol>li>ol>li>ol>li>ol>li{list-style-type:"> "}.pd-md-viewer code{padding:0 .5rem;line-height:1.5rem;min-height:1.5rem;letter-spacing:1px;font-family:"Roboto Mono",monospace;font-size:.75rem;font-weight:400;background-color:#f7f7fa;border-radius:.25rem;border:1px solid rgba(0,0,0,.1019607843)}.pd-md-viewer code:has(ol),.pd-md-viewer code:has(ul){padding:0}.pd-md-viewer code *{letter-spacing:1px;font-family:"Roboto Mono",monospace;font-size:.75rem;font-weight:400;margin-bottom:0 !important}.pd-md-viewer code ol,.pd-md-viewer code ul{margin:0 !important;padding:.5rem 1rem;overflow:scroll}.pd-md-viewer code ol li,.pd-md-viewer code ul li{list-style-type:none;line-height:1.5rem;min-height:1.5rem;white-space:nowrap}.pd-md-viewer pre{position:relative;border:none !important}.pd-md-viewer pre.success code{background-color:#e0ffe1}.pd-md-viewer pre.success code[name]:not([name=""])::before{background-color:#e0ffe1;border-bottom:1px solid #e0ffe1}.pd-md-viewer pre.success button::after{content:"已複製"}.pd-md-viewer pre.error code{background-color:#ffd4d4}.pd-md-viewer pre.error code[name]:not([name=""])::before{background-color:#ffd4d4;border-bottom:1px solid #ffd4d4}.pd-md-viewer pre.error button::after{content:"無法複製"}.pd-md-viewer pre.success button,.pd-md-viewer pre.error button{opacity:1}.pd-md-viewer pre[name]:not([name=""]) button{top:calc(1.75rem - 1px)}@media(hover: hover){.pd-md-viewer pre:not(.success):not(.error):hover code{background-color:#ddd}.pd-md-viewer pre:not(.success):not(.error):hover code[name]:not([name=""])::before{background-color:#ddd;border-bottom:1px solid #ddd;color:#444}.pd-md-viewer pre:not(.success):not(.error):hover button{opacity:1}}.pd-md-viewer pre code{position:relative;display:block;margin-bottom:0 !important;background-color:#f7f7fa;border:1px solid rgba(0,0,0,.1019607843);transition:.3s}.pd-md-viewer pre code[name]:not([name=""]){margin-top:1rem;border-radius:0 .25rem .25rem .25rem}.pd-md-viewer pre code[name]:not([name=""])::before{content:attr(name);position:absolute;left:-1px;top:-1.25rem;padding:0 .5rem;height:1.25rem;line-height:1.25rem;min-height:1.25rem;font-size:.75rem;background-color:#f7f7fa;color:#777;border-radius:.25rem .25rem 0 0;border-top:1px solid rgba(0,0,0,.1019607843);border-left:1px solid rgba(0,0,0,.1019607843);border-bottom:1px solid #f7f7fa;border-right:1px solid rgba(0,0,0,.1019607843);transition:.3s}.pd-md-viewer pre button{position:absolute;top:calc(.75rem - 1px);right:.5rem;padding:0 .5rem;line-height:1.5rem;font-size:.75rem;background-color:#777 !important;color:#fff !important;border-radius:.25rem;opacity:0;transition:.3s;cursor:pointer}.pd-md-viewer pre button::after{content:"複製代碼";color:#fff !important}.pd-md-viewer blockquote{padding-left:1rem;line-height:1.75rem;min-height:1.75rem;font-style:italic;border-left:.25rem solid #ddd;color:#777;background-color:rgba(0,0,0,.0117647059)}.pd-md-viewer blockquote *{margin-bottom:0;color:inherit}.pd-md-viewer blockquote>br:nth-last-child(1){display:none}\n                '.trim(),window.btoa(encodeURIComponent(i).replace(/%([0-9A-F]{2})/g,((e,t)=>String.fromCharCode("0x"+t)))))})],document.head.firstElementChild),this.body=`section#${t}.pd-md-viewer`._({"data-fillMode":null==e.fillMode?1:e.fillMode})}get editor(){return this.#g}set editor(e){this.#g&&(this.#g.body.onwheel=null),null!=e&&(this.#g=e,this.#g.viewer=this,this.#w&&this.#g&&(this.#g.body.onwheel=e=>{this.body.scrollTop+=e.deltaY}))}#_(){this.body.$selAll("div").forEach(((e,t)=>{e._attr({index:t+1})}))}#v(){if(!this.#g)return"";var e="";return this.#g.body.$childAll.forEach(((t,i)=>{var r=t.innerText.__(/[\u00A0\u0020]/g," ");r.trim().length<1?e+="\n":e+=`${r}\n`})),`\n${e.trim()}\n`}init(e){this.#_();let t=this.#p,i=this.body.scrollTop;oe&&clearTimeout(oe),oe=setTimeout((()=>{if(clearTimeout(oe),oe=null,t&&this.body.innerHTML&&t===this.body.innerHTML)return;let r=e?`\n${e}`:"";r||(r=this.#g&&this.#g.body.innerText?this.#v():t),r=`\n${r}\n`,r=r.md_to_html();let o="temp"._();null!=r&&`${r}\n`.$$(/(.+\n)+/g)&&`${r}\n`.$fit(/(.+\n)+/g).forEach((e=>{if(e.trim().$$(/^[\u00A0\u0020]*\<(.+\n?)\>$/)){let t="template"._(e);o._child(t.content)}else e.split(/\n/).forEach((e=>{if(!(e.trim().length<1))if(e.trim().$$(/^[\u00A0\u0020]*\<(.+\n?)\>$/)){let t="template"._(e);o._child(t.content)}else o._child(["p"._(e)])}))})),this.body.__child(o),this.body.$selAll("button.copy").forEach((e=>{e._click((async function(){clearTimeout(le);let e=this.$pre(0).$child(0).innerText;try{await navigator.clipboard.writeText(e),this.$parent(0)._class("success"),le=setTimeout((()=>{this.$parent(0).class_("success")}),1e3)}catch(e){console.error(e),this.$parent(0)._class("error")}}))})),setTimeout((()=>{this.body.scrollTop=i,PR.prettyPrint()}),1)}),this.#f)}}const e="PDMDEditor",fe="PDMDViewer",we="pd-md-editor",r="id",o="nodeName",ce="nodeValue",l="parentNode",he="tagName",ge="style",_e="section",s="selection",a="getSelection",d="empty",c="clipboardData",h="baseOffset",u="focusOffset",p="innerText",m="innerHTML",f="slice",g="toLowerCase",w="div",v="inputFocus",_="length",y="class_",b="_child",$="$child",x="body",ve="text/plain",S="childNodes",C="setStart",k="setEnd",A="removeAllRanges",E="children",T="firstElementChild",I="scrollTop",$e="**",be="b",ye="*",ke="i",xe="~~",Ae="s",Ee="__",Te="u",Ie="==",me="mark",Ce="^",Se="sup",De="~",Re="sub",ze="`",pe="code";((e,t)=>{const i="g",r=/[\"\']{0,1}([\u0020\u00A0\u0009]*)(mailto\:)?([\u0020\u00A0\u0009]*)(\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*)([\u0020\u00A0\u0009]*)[\"\']{0,1}/,o=/[\"\']{0,1}([\u0020\u00A0\u0009]*)(https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))([\u0020\u00A0\u0009]*)[\"\']{0,1}/,n=/(\n[\u0020\u00A0\u0009]*|\n[\u0020\u00A0\u0009]*>[\u0020\u00A0\u0009]*|\n[\u0020\u00A0\u0009]*([\-\*\+]|\d+\.)[\u0020\u00A0\u0009]+)\\?(\#{1,6})[\u0020\u00A0\u0009]+([^\n]+)/,d=/\\\#/,l=/^['"].*['"]$/,s=/(\s*\|\s*)\\?(\#{1,6})\s+([^\n\|\s][^\n\|]*[^\s\|])(\s*)/,h=/(\n)([^\n]+)\n\={3,}([\u0020\u00A0\u0009]*\n)/,a=/(\n)([^\n]+)\n\-{3,}([\u0020\u00A0\u0009]*\n)/,c=/\[([^\]\n]+)?\]\(([^\)\n\u0020\u00A0\u0009]+)([\u0020\u00A0\u0009]*[\"\']([^\)\n]+)[\"\'])?\)/,m=/\!\[([^\]\n]+)?\]\(([^\)\n\u0020\u00A0\u0009]+)([\u0020\u00A0\u0009]*[\"\']([^\)\n]+)[\"\'])?\)(\(([0-9]+\%?)?[\u0020\u00A0\u0009\*x]+([0-9]+\%?)?\))?/,u=/^\s|\s$/g,p=/\*{2}([^\n\*]*)\*{2}/,f=/\_{2}([^\n\_]*)\_{2}/,w=/\~{2}([^\n\~]*)\~{2}/,v=/\={2}([^\n\=]*)\={2}/,$=/\*([^\n\*]*)\*/,b=/\_([^\n\_]*)\_/,y=/\^([^\n\^]*)\^/,k=/\~([^\n\~]*)\~/,x=/\`([^\n\`]*)\`/,A=/^\n|\n$/g,T=/\`{3}(\w*)([\s\S]*?)\s*\`{3}/,E=/((\n([\u0020\u00A0]{4,}|[\u0009]))[^\n]+)+/,I=/(\n[\u0020\u00A0\u0009]*)(\*{3,}|\-{3,})([\u0020\u00A0\u0009]*\n)/,C=/(\-[\u0020\u00A0\u0009]*[^\n]+)?([\u0020\u00A0\u0009]*\n[\u0020\u00A0\u0009]*\|((?:.*?\|)*.*)\|)+/,S=/(\n)(\>[\u00A0\u0020\u0009\>]+[^\n]*(\n)?)+/,D=/(([\-\*\+]|\d+\.)\s+(.+)(\n.*\S.*)*)+/,R=/^(([\-\*\+]|\d+\.)\s*[^\n]+)/,z=/^(([\-\*\+]|\d+\.)\s*[^\n]+)?\n/,M=/^\n([\u00A0\u0020]{4,}|\u0009)/,O=/\n/,F=/(\<[\u00A0\u0020\u0009\>]*\/?[\u00A0\u0020\u0009\>]*br[\u00A0\u0020\u0009\>]*\/?[\u00A0\u0020\u0009\>]*\>|\n)/,H=/[A-Za-z\%]/,Y=/\.mov$/,L=/\.mp4$/,j=/\.svg$/,B="h",K="code",N="pre",U="strong",P="a",q="u",W="s",Z="mark",V="em",X="sup",G="sub",J="button",Q="video",ee="img",te="source",ie="table",oe="thead",de="tbody",le="blockquote",se="temp",ae="span",me="br",ue="ul",pe="ol",fe="li",we="auto",ge="link",_e="list",ve="tag",$e="prettyprint",be="copy",ye="\n",ke=["javascript","js","ts","html","css","xml","json","sql","java","python","ruby","php","cpp","csharp","swift","typescript","kotlin","go","rust","perl","bash"],xe="abcdefghijklmnopqrstuvwxyz0123456789".split("");let Ae=new Map;function Te(e){return new RegExp(e,i)}function Ee(e=""){let t="{{"+(e.trim()||we)+"-";for(let e=0;e<64;e++)t+=String(xe.sort((()=>Math.random()-.5))[0]);return t+="}}",Ae.has(t)?Ee(e):t}function Ie(e,t="",i="",r="",o="",n=""){const d=Ee(i),l=r instanceof HTMLElement?r:i._(r);return Ae.set(d,l.$html),t.__(e,o+d+n)}function Ce(e=""){return(e.$fit(Te(n))||[]).forEach((t=>{if(t.$fit(d))return;const i=t.$fit(n);if(i[_]<1)return;const r=i[1]||"",o=(i[3]||"").trim()[_],l=(i[4]||"").trim();0!=Math.min(o,l[_])&&(e=Ie(t,e,B+o,l,r))})),(e.$fit(Te(s))||[]).forEach((t=>{if(t.$fit(d))return;const i=t.$fit(s);if(i[_]<1)return;const r=i[1]||"",o=(i[2]||"").trim()[_],n=(i[3]||"").trim(),l=i[4]||"";0!=Math.min(o,n[_])&&(e=Ie(t,e,B+o,n,r,l))})),(e.$fit(Te(h))||[]).forEach((t=>{const i=t.$fit(h);if(i[_]<1)return;const r=i[1]||"",o=(i[2]||"").trim(),n=i[3]||"";o[_]<1||(e=Ie(t,e,B+1,o,r,n))})),(e.$fit(Te(a))||[]).forEach((t=>{const i=t.$fit(a);if(i[_]<1)return;const r=i[1]||"",o=(i[2]||"").trim(),n=i[3]||"";o[_]<1||(e=Ie(t,e,B+2,o,r,n))})),e}function Se(e=""){return[[K,x],[U,p],[q,f],[W,w],[Z,v],[V,$],[V,b],[X,y],[G,k]].forEach((t=>function(t){const i=t[0],r=t[1];(e.$fit(Te(r))||[]).forEach((t=>{const o=t.$fit(r);if((o[1]||"").$$(u))return;let n=(o[1]||"").trim();return n[_]<1?void 0:i==K?(n=n.$html,void(e=Ie(t,e,i,n))):void(e=e.__(t,i._(n).$html))}))}(t))),e}function De(e=""){return(e.$fit(Te(m))||[]).forEach((t=>{const i=t.$fit(m);if(i[_]<1)return;const r=(i[1]||"").trim(),o=(i[2]||"").trim(),n=(i[4]||"").trim();let d=(i[6]||"").trim(),l=(i[7]||"").trim();if(o[_]<1)return;d[_]&&!d.$$(H)&&(d+="px"),l[_]&&!l.$$(H)&&(l+="px");const s=o.$$(Y),h=o.$$(L),a=o.$$(j);let c;c=s?Q._({controls:"",title:n,style:{width:d,height:l}},[te._({type:"video/quicktime"},o)]):h?Q._({controls:"",title:n,style:{width:d,height:l}},[te._({type:"video/mp4"},o)]):a?ee._({alt:r,title:n,style:{width:d,height:l}},o):"figure"._([ee._({alt:r,title:n,style:{width:d,height:l}},o),"figcaption"._(n)]),null!=c&&(e=Ie(t,e,ee,c))})),e}function Re(e=""){return(e.$fit(Te(c))||[]).forEach((t=>{const i=t.$fit(c);if(i[_]<1)return;const r=(i[1]||"").trim(),o=(i[2]||"").trim(),n=(i[4]||"").trim();if(0==Math.min(r[_],o[_]))return;const d=[P,ge].$str(".")._({title:n},r)._open(o);e=Ie(t,e,P,d)})),(e.$fit(Te(o))||[]).forEach((t=>{if(t.$fit(l))return;const i=t.$fit(o);if(i[_]<1)return;const r=i[1]||"",n=(i[2]||"").trim(),d=i[5]||"";if(n[_]<1)return;const s=P._(n)._open(n);e=Ie(t,e,P,s,r,d)})),(e.$fit(Te(r))||[]).forEach((t=>{if(t.$fit(l))return;const i=t.$fit(r);if(i[_]<1)return;const o=(i[1]||"")+(i[2]||"")+(i[3]||""),n=(i[4]||"").trim(),d=i[8]||"";if(n[_]<1)return;const s=P._(n)._open("mailto:"+n);e=Ie(t,e,P,s,o,d)})),e}function ze(e=""){return(e.$fit(Te(D))||[]).forEach((t=>function(t){let r;if(t.trim().__(new RegExp(F,i),ye).split(F).forEach(((e,t)=>{const i=e.$fit(D)||[],o=i[_]<1?null:(i[2]||"").trim().$$(/\d+\./)?pe:ue,n=i[_]<1?e.__(/^\s*([\-\*\+]|\d+\.)?\s*/g,""):(i[3]||"").trim(),d=(e.$fit(/\s{4}/g)||[])[_];if(0==t&&null==o)return;0==t&&(r=o._());let l=r;if(e.$$(/^\s{0,3}([\-\*\+]|\d+\.)/))l._child([fe._(n)]);else if(e.$$(/^\s{4,}([\-\*\+]|\d+\.)/)){l=r.lastChild;for(let e=0;e<d&&(null!=l&&null!=l[he]);e++)e==d-1&&l[he][g]()==fe?l.lastChild instanceof HTMLElement&&(l.lastChild[he][g]()==pe||l.lastChild[he][g]()==ue)?l.lastChild._child([fe._(n)]):l._child([o._([fe._(n)])]):l=l.lastChild.lastChild}else{for(l=r.lastChild;null!=l.lastChild;)l=l.lastChild;l instanceof HTMLElement||l[ce].$$(/^\{\{(h\d|img|pre)/)||l.parentElement._child([me._()]),l.parentElement.innerHTML+=n}})),null==r)return;e=Ie(t,e,_e,r)}(t))),e}function Me(e=""){return(e.$fit(Te(T))||[]).forEach((t=>{const i=t.$fit(T);if(i[_]<1)return;const r=null==i[2].$fit(A),o=r?"":(i[1]||"").trim()[g](),n=r?i[1]||"":i[2]||"",d=-1!=ke.indexOf(o),l=n.__(A,"").split(O);let s;s=r?[K,$e].$str(".")._(n.$html):[N,$e].$str(".")._({name:o},[(K+(d?".language-"+o:""))._({name:o},[Fe(l)]),[J,be].$str(".")._()]),e=Ie(t,e,r?K:N,s)})),e}function Oe(e=""){return(e.$fit(Te(E))||[]).forEach((t=>{const i=t.$fit(E);if(i[_]<1)return;const r=i[2]||"",o=t.__(A,"").split(O),n=[N,$e].$str(".")._([K._([Fe(o)]),[J,be].$str(".")._()]);e=Ie(t,e,N,n,r)})),e}function Fe(e){let t=0,i=pe._();return e.forEach(((e,r)=>{0==r&&(t=Math.floor((e.$fit(/^\s*/)||[""])[0][_]/4));const o=new RegExp(`^\\s{0,${4*t}}`);i._child([fe._(e.__(o,"").$html)])})),i}function He(e=""){let t,i="";return(e.$fit(Te(C))||[]).forEach((r=>{if(r.$$(R))r=r.__(z,"");else if(r.$$(M))return;!function(e){const r=e.trim().split(O);t=ie._([oe._(),de._()]);let o=!0;r.forEach(((e,r)=>{const n=e.$fit(/((\s*)\|((?:.*?\|)*.*)\|)+/);if(n[_]<1)return;const d=(n[3]||"").trim(),l=e.$$(/^\s*\|(\s*\:?\s*\-*\s*\:?\s*\|)+/),s=d.split(/\s*\|\s*/);0==r&&(i=n[2]||""),l?o=!1:function(e,i){const r=e?t.firstChild:t.lastChild,o="tr"._();i.forEach((t=>{o._child([(e?"th":"td")._(t)])})),r._child([o])}(o,s)}))}(r),e=Ie(r,e,ie,t,i)})),e}function Ye(e=""){let t;return(e.$fit(Te(S))||[]).forEach((r=>{t=le._();const o=r.$fit(S),n=o[1]||"",d=o[3]||"";!function(e){function r(e){let t=se._();const i=/^[\u00A0\u0020\u0009]*\>/,o=e.__(i,"");if(i.test(e)){let e=le._();e._child([r(o)]),t._child([e])}else e.$$(/^[\u00A0\u0020\u0009]*\{\{/)?t._child(e):t._child([ae._(e),me._()]);return t}ze(e.trim().__(/^\>[\u00A0\u0020\u0009]?/g,"").__(/\n\>[\u00A0\u0020\u0009]?/g,"\n").__(new RegExp(F,i),"\n")).split(O).forEach((e=>{t._child([r(e)])}))}(r),e=Ie(r,e,le,t,n,d)})),e}function Le(e=""){return(e.$fit(Te(I))||[]).forEach((t=>{const i=t.$fit(I);if(i[_]<1)return;const r=i[1]||"",o=i[3]||"",n=Ee("HR");Ae.set(n,"<hr>"),e=e.__(t,r+n+o)})),e}function je(e=""){if(String(ne||"").trim()[_]<1)return e;const t=/(\s{1})\\?[\#＃]{1}([\u4e00-\u9fff\u3040-\u30ff\uac00-\ud7a3a-zA-Z0-9_]+)/,r=new RegExp(t,i);let o=e.$fit(r)||[];for(let i=0,r=o[i];i<o[_];i++,r=o[i]){if(r.$fit(/^\\/))continue;const i=r.$fit(t);if(i[_]<1)continue;const o=i[1],n=(i[2]||"").trim(),d=Ee(P);if(n[_]<1)continue;const l=se._(["_blank"===re?[P,ve].$str(".")._(n)._open(ne+n):[P,ve].$str(".")._(n)._go(ne+n)]);Ae.set(d,l.$html),e=e.__(r,o+d)}return e}function Be(e=""){e=e.__(/^\n*|\n*$/g,"");var t=/(&lt;br&gt;)/g;return t.test(this)?e.__(t,"\n"):e}e(t,"md_to_html",{value:function(){let e=this.toString().__(/[\u00A0\u0020]/g," "),t=[Me,De,Re,Se,Ce,Le,He,Ye,ze,Oe,je,Be];for(let i=0,r=t[i];i<t[_];i++,r=t[i])e=r(e);for(;e.$$(/\{{2}\w*\-*\w{64}\}{2}/);)e.$fit(/\{{2}\w*\-*\w{64}\}{2}/g).forEach((t=>{let i=new RegExp(t);e=e.__(i,Ae.get(t))}));return e}})})(Object.defineProperty,String.prototype);